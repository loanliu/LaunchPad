                                                                        // Prod - DynamicBriefs - rel 2 May 2017
                                                                        /*--------------------------CHANGE LOGS --------------------------------------
	6/28/2023 - added market availability
	8/26/2022 - Added OST to Unapproved promo
	06/22 - add DD 2.0 columns
	04//22 - hide Sales Operations ONLY for new brief
	02/2022 -- getAllColumns - REMOVE IN PRODUCTION, this is for testing only
	04/19/22 - remove references to Local State, Digital Support Launch and Special Call outs
	04/1/22 - add logic to support DD 2.0
	04/16/22 - change Digital Operations to Digital Resource Request, also populate Managing Channel accordingly
			  -  change visiblity for PMO only
	01/24/22 - remove Launch Type restriction for PMOs
	01/03/22 - add FWA PMO
	08/24/21 - check "Calendar Only" for priority 4
	06/28/21 - update Brief Submission Tips
	06/16/21 - do not show 5G city for PMO only
	03/08/21 - show gtm lead for UNAPPROVED  promo
	02/23/2021 - add indirect title and key points, change Indirect Nuances to indirect training
	01/04/2021 - replace Field Activation launch type with Local Marketing
	10/30/2020 - display OST as per Dana's request
	10/06/2020 - hide 5G for Sales ops
	09/22/2020 - accomodate CRM redirect
	08/19/2020 - make National Retails a required field for Indirect National Retail
	08/14/2020 - add NBx section
	07/31/2020 - remove East/South/West from Area
	07/22/2020 - open up Sales Ops for everyone
	06/22/2020 - Direct Marketing support team
	05/27/2020 - allow sales ops admins to edit priority
	05/20/2020 - fix issue with Sales Ops in admin mode
	05/16/2020 - add Sales Ops, fix cloning for empty Customer Eligibility, remove isCustomerCase
	04/28/20 - add toLowerCase(). when checking for current URL
	04/20/2020 - show Eligible Transactions for FIOS	
	04/20/2020 - remove project sponsor, It cam from clone brief
	04/14/2020 - rename IT Contacts and Approving Legal Contacts
	04/08/2020 - "Lead" auto recognition for Admin Fields
	04/07/2020 - display JARVIS ONLY managing channel for GTM or Sales Ops Only support teams
	3/24/2020 - fix fnCloneBrief since a lot of fields have been removed - added select fields to query
	3/18/2020 - hide Sales Ops for non Super admin
	3/11/2020 - Adding Sales Operations(ONLY) support team
	03/10/2020 - set priority level to unassigned in NewForm (it is left as blank in some cases)
	02/27/2020 - #717 allow ALL admin to edit priority level
	02/26/20  - hide Save As Draft after initial submit
	02/24/20   - unlock Project Submission date, Supporting Documents, Notes for all Briefs (notes is now Admin Notes)
	02/21/20 - rename Field Activation CID to Field Activation PMO Approval Code
	02/17/20  - remove some PMO fields
	02/11/20 - rename Field Activation Budget to Field Activation CID, remove prepopulation of field
	02/06/20 - increase width of keypoints from 560 to 600px - 12/06/21 - changed to 590px
	01/28/20 - add logics to handle Fios TV Channels
	01/21/20 - remove restrictions on Field activation
	01/17/20 - add IMC changes
	10/30/19 - remove PMO support team restriction
	10/11/19 - IM Changes  ANY XXX should be uncommened when copy to production
	9/16/19 - make Customer Primary Use Case required field
	7/10/19 - remove Retail (ALL) check box linkage
	4/11/19 - add PMO
	3/26/19 - prep for B2B departure
	1/7/19 - remove all market activity launch types
	1/7/19 - Allow Promo End Date to show for campaing or contest launch
	1/29/19 - change to ADOM user groups
	9/24/18 - prepopulate keypoints with 5 bullet points for market brief
	9/20 - remove media co
	9/07 - support market launch types
	8/6/18 - check off Appendix Only for P3 and P4
	8/5/18 - super brief changes
	8/28 - check isGTM in fnLaunchType so that inventory outlook is displayed for device
	8/22 - hide content type, which showed up after unexpected URL changes
	8/22 - add logic to handle interlock date
	8/03 - add logics for AGENDA brief
	7/15 - change meeting dates names and links
	7/14 - change width for keypoint/IM Hot Items
	7/11 - This is because all fields are redisplayed if required fiedls are not entered (for example, save as draft)
	7/11 - do not clone support teams and gtm launch teams
	7/11 - call hideadmin in Presaveaction for new form
	7/06 - unshade all IC Deliverabls. also add this logic:
	7/06 - e.target.className.indexOf('greycellleftheader') > -1 ||
	6/22 - unlock text area for IM Hot Items
	6/20 - add one row for pillar detail (digital ops)
	6/16 - add logic for Sub Launch Type
	6/09 - add logic for Internal Comm
	6/6 -SPUtility.GetSPField("IM Hot Items and Due Dates").MakeEditable();
	6/06 - remove this line, it does not get executed properly for non IM
	6/05 - add new field for IM
	5/19 - remove MSO, need to rework logic for checkboxes
	5/17 - rename GTM Launch Teams(choose one) to GTM Launch Team
	5/17 - remove autopuplation of meeting dates (#E195)
	12/19/18 - hide all market activity launch types
	12/14/18 - update child brief if parent's name is changed - Parent ID Sort is copied from Parent Project ID, which is a look up field
	12/03/18 - do not reset special call outs if the launch type is not changed
	11/28/18 - populate special callout and Digital Support Launch
	11/12/18 - remove references to GTM Deck Availability Date
	10/27 - hide FMO Resource
	10/16 - fix agenda brief, do not call fnPopulateAgenda for Edit
	10/09/18 - change pricing/promodetail to non required
	08/20/19 - remove updateChildBrief function
	07/31/18 - allow cgtm lead to update support team(s)
	06/22/18 - go back to home page if there's no referral URL
	06/20/18 - add logic to override custom ribbon icon
	06/09/18 - prepopulate AGENDA in edit mode
	04/25/18 - no longer block COO and other fields as per Mercy's request
	04/15/18 - fix invalid characters imported by PPT
	04/06/18 - add CXA fields
	02/28/18 - remove internal comm items
	01/22 - allow all Market admin to create parent child relationship
	01/09 - remove references to Launch Sheet Expected Date
	01/08 - allow NC Admin to create parent child relationship

----------------------------------------------------------------------------*/

                                                                        var preSave = false;
                                                                        var isAdministrator = false;
                                                                        var isSuperAdmin = false;
                                                                        var isDraft = false;
                                                                        var isGTMAssigned = false;
                                                                        var isPMOAssigned = false;
                                                                        var isDOAssigned = false;
                                                                        var isIMCAssigned = false;
                                                                        var isBrandAssigned = false;
                                                                        var isAssigned = false;
                                                                        var result = "";
                                                                        var userRoles = [];
                                                                        var isCloned = false;
                                                                        var currentURL = _spPageContextInfo.serverRequestPath;
                                                                        var origManagingChannel = "";
                                                                        var isNewForm = false;
                                                                        var isDisplayForm = false;
                                                                        var hiddenLaunchDate = null;
                                                                        var ID = null;
                                                                        var isEditForm = false;
                                                                        var generalRowIndex = 0;
                                                                        var pmoRowIndex = 0;
                                                                        var isIntegratedMarketing = false;
                                                                        var integratedMarketingRowIndex = 0;
                                                                        var launchTypeRowIndex = 0;
                                                                        var sellingFeatureRowIndex = 0;
                                                                        var customerExperienceRowIndex = 0;
                                                                        var additionalMarketingRowIndex = 0;
                                                                        var adminRowIndex = 0;
                                                                        var digitalOpsRowIndex = 0;
                                                                        var saveAsDraftRowIndex = 0;
                                                                        var gtmAdminRowIndex = 0;
                                                                        var origCreateProjectLibrary = "";
                                                                        var isHQSuperAdmin = false;
                                                                        var lastRowIndex = 0;
                                                                        var supportTeamsRowIndex = 0;
                                                                        var gtmRowIndex = 0;
                                                                        var salesOpsRowIndex = 0;
                                                                        var isConsumer = true;
                                                                        var isPNB = false;
                                                                        var isOps = false;
                                                                        var isCRM = false;
                                                                        var isGTM = false;
                                                                        var isPMO = false;
                                                                        var isFWAPMO = false;
                                                                        var isIMC = false;
                                                                        var isBrand = false;
                                                                        var isPMOOnly = false;
                                                                        var isDigitalOps = false;
                                                                        var isSalesOps = false;
                                                                        var isB2BAdmin = false;
                                                                        var isOpsAdmin = false;
                                                                        var isPNBAdmin = false;
                                                                        var isDOAdmin = false;
                                                                        var isIMCAdmin = false;
                                                                        var isIMCLead = false;
                                                                        var isBrandAdmin = false;
                                                                        var isBrandLead = false;
                                                                        var isGTMAdmin = false;
                                                                        var isCGTMLeads = false;
                                                                        var isPMOAdmin = false;
                                                                        var isFWAPMOAdmin = false;
                                                                        var isGTMLead = false;
                                                                        var isAdmin = false;
                                                                        // use this indicate user is an admin, regardless of permission group
                                                                        var assignedLevel = 0;
                                                                        var securityLevel = 0;
                                                                        var DOLead = "";
                                                                        var IMLead = "";
                                                                        var GTMLead = "";
                                                                        var PMOLead = "";
                                                                        var loginName = "";
                                                                        var createdBy = "";
                                                                        var briefID = 0;
                                                                        var internalCommRowIndex = 0;
                                                                        var isICAdmin = false;
                                                                        var isAgenda = false;
                                                                        var isNEAdmin = false;
                                                                        var isNCAdmin = false;
                                                                        var isSEAdmin = false;
                                                                        var isSCAdmin = false;
                                                                        var isPCAdmin = false;
                                                                        var isGLAdmin = false;
                                                                        var MarketRole = '';
                                                                        var isMarketAdmin = false;
                                                                        var isMarketLaunch = false;
                                                                        var isCustomerCase = false;
                                                                        var prevPriority = "", prevLaunchDate = "", prevLaunchType = "", prevProjectName;
                                                                        var siteGroupArray = [];
                                                                        var url = "https://onesite.verizon.com/sites/HQ_GTM";
                                                                        var clientContext;
                                                                        var calendarOnly = false;
                                                                        var isSalesOps = false;
                                                                        var isSalesOpsAdmin = false;
                                                                        var isSalesOpsLead = false;
                                                                        var isSalesOpsAssigned = false;
                                                                        var gtmleads, pmoleads, dolead, imcleads, brandingleads, salesopsleads, srmgrleads;
                                                                        var isPromo = false;
                                                                        var isPromoOnly = false;
                                                                        var isPromoTeam = false;
                                                                        var isNBx, isNBxAdmin;
                                                                        var isIndirect = false;
                                                                        $(document).ready(function() {

                                                                            // Note: 'SOD' is an abbreviation for "Script on Demand"
                                                                            SP.SOD.executeFunc('sp.js', 'SP.ClientContext', sharePointReady);
                                                                            SP.SOD.executeFunc('clientpeoplepicker.js', 'SP.ClientContext', sharePointReady);

                                                                            //07/20/2020 - don't do this, you can't delete attachment

                                                                            /*$("table#idAttachmentsTable a").attr('onclick', '').click(function (event) {
	    event.preventDefault();
	    var url=$(this).attr('href');
	    window.open(url, '_blank');
	}); */

                                                                            // the below function will verify the ribbon is loaded
                                                                            SP.SOD.executeOrDelayUntilScriptLoaded(function() {
                                                                                var pm = SP.Ribbon.PageManager.get_instance();
                                                                                pm.add_ribbonInited(function() {
                                                                                    ribbonIsLoaded();
                                                                                });
                                                                                var ribbon = null;
                                                                                try {
                                                                                    ribbon = pm.get_ribbon();
                                                                                } catch (e) {}
                                                                                if (!ribbon) {
                                                                                    if (typeof (_ribbonStartInit) == 'function')
                                                                                        _ribbonStartInit(_ribbon.initialTabId, false, null);
                                                                                } else {
                                                                                    ribbonIsLoaded();
                                                                                }
                                                                            }, 'sp.ribbon.js');

                                                                            setTimeout(function() {
                                                                                wrapChoiceField("Market_x0020_Regions", 3);
                                                                                wrapChoiceField("Customer_x0020_Eligibility", 3);
                                                                                wrapChoiceField("Customer_x0020_Segment", 3);
                                                                                wrapChoiceField("Channel_x0020_Availability", 3);
                                                                                wrapChoiceField("National_x0020_Retailers", 3);
                                                                                wrapChoiceField("Promotion_x0020__x0020_Launch_x0", 2);
                                                                                wrapChoiceField("Other_x0020_Promotion_x0020_Type", 3);
                                                                                wrapChoiceField("Advanced_x0020_Calling_x0020_Fea", 3);
                                                                                wrapChoiceField("Market_x0020_Reprenstation", 3);
                                                                                wrapChoiceField("Eligible_x0020_Agreement_x0020_T", 4);
                                                                                wrapChoiceField("Upgrade_x0020_Type", 4);
                                                                                wrapChoiceField("Indicate_x0020_which_x0020_contr", 3);
                                                                                wrapChoiceField("Reporting_x0020_Frequency", 4);
                                                                                wrapChoiceField("Target_x0020_Customer_x0020_Segm", 3);
                                                                                wrapChoiceField("Where_x0020_will_x0020_this_x002", 3);
                                                                                wrapChoiceField("Impacted_x0020_Digital_x0020_Ops", 2);
                                                                                wrapChoiceField("Call_x0020_to_x0020_Action_x0020", 3);
                                                                                wrapChoiceField("Other_x0020_support_x0020_teams_", 4);
                                                                                wrapChoiceField("PMO_x0020_Project_x0020_type_x00", 4);
                                                                                wrapChoiceField("Target_x0020_Customers", 4);
                                                                                wrapChoiceField("Partner", 5);
                                                                                wrapChoiceField("Customer_x0020_Personas", 3);
                                                                                wrapChoiceField("Customer_x0020_Segments", 3);
                                                                                wrapChoiceField("Target_x0020_Competition", 3);
                                                                                wrapChoiceField("Business_x0020_Area_x0020_Expert", 4);
                                                                                wrapChoiceField("Accessory_x0020_Type", 4);
                                                                            }, 50);

                                                                            //8/22/17 - hide content type
                                                                            $("select[id*='ContentTypeChoice']").closest('tr').hide();

                                                                            //hide margin
                                                                            $("#contentBox").css("margin-left", "0px");

                                                                            // hide some hidden fields
                                                                            var gtmLeadsHidden = SPUtility.GetSPField("GTM Lead (Hidden)");
                                                                            SPUtility.GetSPField("GTM Lead (Hidden)").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Lead (Hidden)").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("GTM Status (Hidden)").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Status (Hidden)").Label.attr("Hiding", true);

                                                                            //SPUtility.GetSPField("Sales Ops Status").ControlsRow.className = "noShow";

                                                                            //$('tr[fielddispname="GTM Lead (Hidden)"]').css("background-color", "yellow");
                                                                            //$('tr[fielddispname="Sales Ops Status"]').hide();

                                                                            //SPUtility.HideSPField("Sales Ops Status");
                                                                            //SPUtility.GetSPField("Sales Ops Status").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Fios Plan Eligibility").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Fios Plan Eligibility").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("5G/LTE Home Plan Eligibility").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("5G/LTE Home Plan Eligibility").Label.attr("Hiding", true);

                                                                            // hide fields July 2024 LP cleanup
                                                                            //SPUtility.GetSPField("PMO Lead(s)").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("PMO Lead(s)").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("FWA PMO Lead(s)").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("FWA PMO Lead(s)").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Calendar Only").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Calendar Only").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Plan/Payment Type").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("PMO Brief Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("PMO Brief Status").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("IMC Lead (Hidden)");

                                                                            //FOR FIELD REMOVAL PURPOSES
                                                                            //SPUtility.HideSPField("Accessory Retail Price");
                                                                            //SPUtility.HideSPField("Accessory Sale Price");
                                                                            //SPUtility.HideSPField("Product or Service Type");
                                                                            //SPUtility.HideSPField("Price Plan Type");
                                                                            //SPUtility.HideSPField("Telesales Nuances");
                                                                            //SPUtility.HideSPField("Entertainment");
                                                                            //SPUtility.HideSPField("5G");
                                                                            //SPUtility.HideSPField("5G City");

                                                                            /*if (SPUtility.GetSPField("Digital Support Launch").GetValue().length == 0)
		SPUtility.HideSPField("Special Call Outs");
	else
		SPUtility.ShowSPField("Special Call Outs");*/

                                                                            checkADOMComplete();

                                                                            // Loan Liu - format Managing Channel select box
                                                                            fnFormatManagingChannel();

                                                                            //fnSaveLeadValues();
                                                                            ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                setTimeout(function() {
                                                                                    fnSaveLeadValues();
                                                                                }, 200);
                                                                            }, 'sp.js');

                                                                            // Loan Liu - cloning logic
                                                                            sessionStorage.setItem("editURL", currentURL);
                                                                            // 12/17 need this for fileupload later
                                                                            if (currentURL.toLowerCase().indexOf("newform") > -1) {
                                                                                ID = $.urlParam('ID');
                                                                                isNewForm = true;

                                                                                if (typeof ID != 'undefined') {
                                                                                    isCloned = true;
                                                                                    fnCloneBrief(ID);
                                                                                }
                                                                            } else if (currentURL.toLowerCase().indexOf("editform") > -1) {
                                                                                ID = $.urlParam('ID');
                                                                                isEditForm = true;
                                                                                prevPriority = SPUtility.GetSPField("Priority Level").GetValue();
                                                                                prevLaunchDate = new Date(SPUtility.GetSPField("Launch Date").GetValue());
                                                                                prevLaunchType = SPUtility.GetSPField("Launch Type").GetValue();
                                                                                prevProjectName = SPUtility.GetSPField("Project Name").GetValue();
                                                                            } else if (currentURL.toLowerCase().indexOf("dispform") > -1) {
                                                                                isDisplayForm = true;
                                                                            }
                                                                            console.log(isNewForm);
                                                                            console.log(isEditForm);

                                                                            // Hightlight the attachments for GTM Deck and Launch Sheet
                                                                            $('a').each(function(index) {

                                                                                var href = $(this)[0].href;
                                                                                if (href.indexOf("GTMDeck-") > -1 || href.indexOf("LaunchSheet-") > -1 || href.indexOf("LaunchSheet") > -1) {
                                                                                    $(this).css({
                                                                                        "color": "red",
                                                                                        "font-weight": "bold"
                                                                                    });
                                                                                }
                                                                            });
                                                                            hiddenLaunchDate = new Date(SPUtility.GetSPField("Launch Date (Hidden)").GetValue());
                                                                            //SPUtility.HideSPField("Launch Date (Hidden)");
                                                                            SPUtility.GetSPField("Launch Date (Hidden)").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Launch Date (Hidden)").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Title");
                                                                            SPUtility.GetSPField("Title").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Title").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Deliverable Status");  //- NO DELIVERABLE STATUS IN DEV - why?
                                                                            SPUtility.GetSPField("GTM Last Column").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Last Column").Label.attr("Hiding", true);
                                                                            //SPUtility.HideSPField("GTM Last Column");

                                                                            if (SPUtility.GetSPField("Save as draft?").GetValue() != "No")
                                                                                isDraft = true;

                                                                            var spfGeneral = SPUtility.GetSPField("GENERAL INFORMATION");
                                                                            spfGeneral.MakeReadOnly();
                                                                            spfGeneral.Label[0].innerHTML = "<img class='general-img-swap' src='https://onesite.verizon.com/sites/HQ_GTM/SiteAssets/Images/toggle-on.png'></img><nobr class='headerSeparator generalinfo'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GENERAL INFORMATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr>";
                                                                            //var general = "<b>Need help deciding which support groups to choose above? See the <a href='https://docs.google.com/presentation/d/1wSQHG8BX0MnqAw3Yvm0q1H7RXk_3n394BWqARbhVp5k/view#slide=id.p3' target='_blank'>" +  "Brief Submision Tips" + "</a>" +  " document for this, and other directions</b>";
                                                                            //spfGeneral.SetValue(general);
                                                                            var spfPMO = SPUtility.GetSPField("PMO");
                                                                            spfPMO.Label[0].innerHTML = "<img class='pmo-img-swap' src='https://onesite.verizon.com/sites/HQ_GTM/SiteAssets/Images/toggle-on.png'></img><nobr class='headerSeparator pmo'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr>";
                                                                            spfPMO.MakeReadOnly();
                                                                            var spfGTM = SPUtility.GetSPField("GTM");
                                                                            spfGTM.MakeReadOnly();

                                                                            var spfSupportTeams = SPUtility.GetSPField("Support Team(s)");
                                                                            var innerHTML = "<nobr class='orange'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUPPORT TEAM(S)*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr><br>";
                                                                            innerHTML = innerHTML + "<nobr class='bluefont'>Need help choosing support teams and completing a brief?&nbsp;<br> Check here: <a href='https://docs.google.com/presentation/d/1wSQHG8BX0MnqAw3Yvm0q1H7RXk_3n394BWqARbhVp5k/view#slide=id.p3' target='_blank'>" + "<span class='bluefont' style='text-decoration:underline;'>Brief Submission Tips" + "</span></a>";
                                                                            innerHTML = innerHTML + "<br><nobr style='color:red;font-size:1em; font-weight:bold'>If you need marketing PMO team support, please access<br> their new intake tool&nbsp;<a href='https://app.smartsheet.com/b/home?lgt=pub&lrt=s&EQBCT=af6671c577c444929524ab77dae7644c' target='_blank'>" + "<span class='bluefont' style='text-decoration:underline;font-style:normal !important'>HERE" + "</span></a>";

                                                                            spfSupportTeams.Label[0].innerHTML = innerHTML;
                                                                            var spfGTM = SPUtility.GetSPField("GTM");
                                                                            spfGTM.MakeReadOnly();
                                                                            spfGTM.Label[0].innerHTML = "<img class='gtm-img-swap' src='https://onesite.verizon.com/sites/HQ_GTM/SiteAssets/Images/toggle-on.png'></img><nobr class='headerSeparator b2b'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO TO MARKET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr>";
                                                                            var spfAdmin = SPUtility.GetSPField("ADMIN");
                                                                            spfAdmin.MakeReadOnly();
                                                                            spfAdmin.Label[0].innerHTML = "<img class='admin-img-swap' src='https://onesite.verizon.com/sites/HQ_GTM/SiteAssets/Images/toggle-on.png'></img><nobr class='headerSeparator admin'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADMIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr>";

                                                                            var spfDigitalOps = SPUtility.GetSPField("DIGITAL OPERATIONS");
                                                                            spfDigitalOps.MakeReadOnly();
                                                                            spfDigitalOps.Label[0].innerHTML = "<img class='digitalops-img-swap' src='https://onesite.verizon.com/sites/HQ_GTM/SiteAssets/Images/toggle-on.png'></img><nobr class='headerSeparator digitalops'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIGITAL RESOURCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr>";

                                                                            var spfIM = SPUtility.GetSPField("INTEGRATED MARKETING");
                                                                            spfIM.MakeReadOnly();
                                                                            spfIM.Label[0].innerHTML = "<img class='im-img-swap' src='https://onesite.verizon.com/sites/HQ_GTM/SiteAssets/Images/toggle-on.png'></img><nobr class='headerSeparator im'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGRATED MARKETING COMMUNICATION/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BRAND DEVELOPMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr>";

                                                                            // Sales ops removal
                                                                            var spfSalesOps = SPUtility.GetSPField("SALES OPS");
                                                                            spfSalesOps.MakeReadOnly();
                                                                            spfSalesOps.Label[0].innerHTML = "<img class='salesops-img-swap' src='https://onesite.verizon.com/sites/HQ_GTM/SiteAssets/Images/toggle-on.png'></img><nobr class='headerSeparator salesops'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SALES OPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</nobr>";

                                                                            SPUtility.GetSPField("Parent Project ID").Label[0].innerHTML = "Parent Project";
                                                                            //SPUtility.GetSPField("Launch Date").Label[0].innerHTML="Launch Date (Required) *";
                                                                            var spfPricing = SPUtility.GetSPField("Pricing");
                                                                            spfPricing.Label[0].innerHTML = "<span style='font-weight: bold !important;'>Pricing/Promo Details</span> <span class='ms-accentText'></span>";
                                                                            SPUtility.GetSPField("Mtg: Pri Rvw").Label[0].innerHTML = "Mtg: Pri Rvw<br><a class='italic' href='https://onesite.verizon.com/sites/HQ_GTM/GTM_Decks/GTM Documents/Consumer Go To Market Team Toolbox/Tool Library/Meeting Date Guidelines.pptx' target=_'blank'>Details Link</a>";
                                                                            //SPUtility.GetSPField("Mtg: Consumer Staff").Label[0].innerHTML="Mtg: Consumer Staff<br><a class='italic' href='https://esites.vzbi.com/sites/HQ_GTM/GTM_Decks/GTM Documents/Consumer Go To Market Team Toolbox/Tool Library/Meeting Date Guidelines.pptx' target=_'blank'>Details Link</a>";
                                                                            //SPUtility.GetSPField("Mtg: Executive GTM").Label[0].innerHTML="Mtg: Executive GTM<br><a class='italic' href='https://esites.vzbi.com/sites/HQ_GTM/GTM_Decks/GTM Documents/Consumer Go To Market Team Toolbox/Tool Library/Meeting Date Guidelines.pptx' target=_'blank'>Details Link</a>";
                                                                            SPUtility.GetSPField("Promo End Date").Label[0].innerHTML = "End Date (if any)";
                                                                            SPUtility.GetSPField("Digital End Date").Label[0].innerHTML = "<span style='font-weight: bold !important'> Digital End Date (if any) </span>";
                                                                            //SPUtility.GetSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types").Label[0].innerHTML="Eligible and Ineligible Price Plans, Payment Options<br>and/or Required Agreement Types";
                                                                            SPUtility.GetSPField("What are the requested proactive/reactive customer communications?").Label[0].innerHTML = "<span style='font-weight: bold !important'>What are the requested proactive/reactive<br>customer communications?</span>";
                                                                            SPUtility.GetSPField("What would you like the customer to take action on or learn based on the communications?").Label[0].innerHTML = "<span style='font-weight: bold !important'> What would you like the customer to take action on <br>or learn based on the communications? </span>";

                                                                            var spfSaveAsDraft = SPUtility.GetSPField("Save as draft?");
                                                                            var spfPriRvw = SPUtility.GetSPField("Mtg: Pri Rvw");
                                                                            var spfLastColumn = SPUtility.GetSPField("GTM Last Column");

                                                                            //get row index in between headers to make hiding/showing easier
                                                                            // row index - 2
                                                                            generalRowIndex = $(spfGeneral).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            pmoRowIndex = $(spfPMO).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            gtmRowIndex = $(spfGTM).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            digitalOpsRowIndex = $(spfDigitalOps).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            adminRowIndex = $(spfAdmin).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            saveAsDraftRowIndex = $(spfSaveAsDraft).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            supportTeamsRowIndex = $(spfSupportTeams).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            lastRowIndex = $(spfLastColumn).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            imRowIndex = $(spfIM).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            gtmAdminRowIndex = $(spfPriRvw).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;

                                                                            // sales ops removal
                                                                            salesOpsRowIndex = $(spfSalesOps).closest('tr').prevObject[0].ControlsRow.sectionRowIndex;
                                                                            //================================Super Brief section=========================================
                                                                            //Set up blue outlines for "All" checkboxes
                                                                            $(".ms-RadioText[title='All Customers'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='Indirect (ALL)'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='Web (ALL)'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            //$(".ms-RadioText[title='All Mobile Areas'] :checkbox").css({outline:"1px blue solid"});
                                                                            $(".ms-RadioText[title='All Retailers'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='All Segments'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='All Channels'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            //$(".ms-RadioText[title='Retail (ALL)'] :checkbox").css({outline:"1px blue solid"});
                                                                            $(".ms-RadioText[title='All Target Customers'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='All Customer Personas'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='All Customer Segments'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='All Target Competition'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            $(".ms-RadioText[title='ALL Fios Strategic Sales'] :checkbox").css({
                                                                                outline: "1px blue solid"
                                                                            });
                                                                            //Set up red outline for required fields

                                                                            $('.ms-formtable input').each(function(index) {
                                                                                //title = $(this).context.title;   does not work with newer version of jquery
                                                                                title = $(this)[0].outerHTML;
                                                                                if (title.indexOf("Required Field") !== -1) {
                                                                                    if (title.indexOf("Project Lead(s)") == -1)
                                                                                        // do not highlight Project Lead input box
                                                                                        $(this).css({
                                                                                            outline: "1px red solid"
                                                                                        });
                                                                                }
                                                                            });

                                                                            $('.ms-formtable select').each(function(index) {
                                                                                //title = $(this).context.title;
                                                                                title = $(this)[0].outerHTML;

                                                                                if (title.indexOf("Required Field") !== -1 || title.indexOf("GTM support are you") !== -1) {
                                                                                    $(this).css({
                                                                                        outline: "1px red solid"
                                                                                    });
                                                                                }
                                                                            });

                                                                            // add red box for input fields (Launch date, promo end date...)
                                                                            $("input[id^='Launch_x0020_Date']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Is_x0020_this_x0020_the_x0020_fi']").css({
                                                                                outline: "1px red dotted"
                                                                            });
                                                                            $("input[id^='Should_x0020_this_x0020_be']").css({
                                                                                outline: "1px red dotted"
                                                                            });
                                                                            $("select[id^='Accessory_x0020_Launch_x0020_Typ']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Save_x0020_as_x0020_draft']").css({
                                                                                outline: "1px red dotted"
                                                                            });
                                                                            //$("table[id^='Customer_x0020_Segment']").css({outline:"1px red solid"});
                                                                            $("table[id^='Channel_x0020_Availability']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Market_x0020_Availability']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Customer_x0020_Eligibility']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Market_x0020_Regions']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Support_x0020_Team_x0028']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='GTM_x0020_Support']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Customer_x0020_Primary_x0020_Use']").css({
                                                                                outline: "1px red solid"
                                                                            });

                                                                            // set width for keypoints, project description, IMC Overview - 02/23/2021 - add indirect key point
                                                                            $("textarea[id^='What_x0020_are_x0020_the_x0020']").css({
                                                                                width: "590px"
                                                                            });
                                                                            $("textarea[id^='Project_x0020_Description']").css({
                                                                                width: "600px"
                                                                            });
                                                                            //$("textarea[id^='IM_x0020_Overview']").css({width:"600px"});
                                                                            $("textarea[id^='Justification_x0020_for_']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("textarea[id^='Indirect_x0020_Key_x0020_Points']").css({
                                                                                width: "600px"
                                                                            });

                                                                            // indent checkboxes
                                                                            $("span[title='East']").parent("td").css("padding-left", "11px");
                                                                            $("span[title='South']").parent("td").css("padding-left", "11px");
                                                                            $("span[title='West']").parent("td").css("padding-left", "11px");

                                                                            // Jarvis highlights
                                                                            SPUtility.GetSPField("Project Name").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Customer Primary Use Case").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Launch Type").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Operations Type").Label.addClass("redfont"); - removed 06/18/20
                                                                            SPUtility.GetSPField("Launch Date").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Promo End Date").Label.addClass("red-font");
                                                                            SPUtility.GetSPField("Area Availability").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Market Availability").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Local State").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Eligible Transactions").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Market Availability").Label.addClass("redfont");

                                                                            //SPUtility.GetSPField("Eligible Customers").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Channel Availability").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("National Retailers").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Promotion Type").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Device OEM").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Accessory Retail Price").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Accessory Type").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Accessory Sale Price").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Product or Service Type").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Device Type").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Price Plan Type").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("5G").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("5G City").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Plan/Payment Type").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Supporting Documents").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Key Points").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("OST/NCA").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Entertainment").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Soundbytes").Label.addClass("redfont"); //- removed 06/16/20 then added back 6/22
                                                                            SPUtility.GetSPField("Alternate Title").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Indirect Training").Label.addClass("redfont");
                                                                            //SPUtility.GetSPField("Telesales Nuances").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Is this a dark launch?").Label.addClass("redfont");
                                                                            $("table[id^='Should_x0020_this_x0020_be_x0020']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            SPUtility.GetSPField("Eligible Customers").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Campaign Module").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Plan Eligibility").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("5G Impact").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("For the Home").Label.addClass("redfont");
                                                                            SPUtility.GetSPField("Homescreen Takeover").Label.addClass("redfont");
                                                                            $("table[id^='Eligible_x0020_Customers']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='National_x0020_Retailers']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("textarea[id^='Indirect_x0020_Key_x0020_Points']").css({
                                                                                outline: "1px red solid"
                                                                            });

                                                                            $("input[id^='Promotional_x0020_Timeframe_x003']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $(".ms-inputBox[id^='Supporting_x0020_Documents']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("textarea[id^='What_x0020_are_x0020_the_x0020_T']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $(".ms-inputBox[id^='Training_x0020_Links']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Promotional_x0020_Timeframe_x003']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            //$("input[id^='Accessory_x0020_Retail_x0020_Pri']").css({outline:"1px red solid"});
                                                                            //$("input[id^='Accessory_x0020_Sale_x0020_Price']").css({outline:"1px red solid"});
                                                                            //$("input[id^='Product_x0020_or_x0020_Service_x']").css({outline:"1px red solid"});
                                                                            //$("table[id^='Product_x0020_or_x0020_Service_x']").css({outline:"1px red solid"});
                                                                            //$("input[id^='Price_x0020_Plan_x0020_Type']").css({outline:"1px red solid"});
                                                                            //$("table[id^='Price_x0020_Plan_x0020_Type']").css({outline:"1px red solid"});
                                                                            $("select[id^='Promotion_x0020_Type']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Promotion_x0020_OEM']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Promotion_x0020_OEM']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            //$(".ms-inputBox[id^='Training_x0020_Links']").css({outline:"1px red solid"}); - field had been removed
                                                                            $("input[id^='Device_x0020_Type']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Device_x0020_Type']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            //$("input[id^='_x0035_G']").css({outline:"1px red solid"});
                                                                            //$("table[id^='_x0035_G']").css({outline:"1px red solid"});
                                                                            //$("input[id^='_x0035_G_x0020_City']").css({outline:"1px red solid"});
                                                                            //$("table[id^='_x0035_G_x0020_City']").css({outline:"1px red solid"});
                                                                            //$("table[id^='Entertainment']").css({outline:"1px red solid"});
                                                                            //$("input[id^='Entertainment']").css({outline:"1px red solid"});
                                                                            //$("input[id^='Soundbytes']").css({outline:"1px red solid"}); //- removed 06/16/20 then added back 6/22
                                                                            $("input[id^='Alternate_x0020_Title_x0020__x00']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("textarea[id^='Indirect_x0020_Nuances']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            //$("textarea[id^='Telesales_x0020_Nuances']").css({outline:"1px red solid"});
                                                                            $("input[id^='Plan_x002F_Payment_x0020_Type']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Plan_x002F_Payment_x0020_Type']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Accessory_x0020_Type']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Accessory_x0020_Type']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Campaign_x0020_Module']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Campaign_x0020_Module']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Plan_x0020_eligibility']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Plan_x0020_eligibility']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='5G_x0020_Impact']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='5G_x0020_Impact']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='For_x0020_the_x0020_Home']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='For_x0020_the_x0020_Home']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("input[id^='Homescreen_x0020_Takeover']").css({
                                                                                outline: "1px red solid"
                                                                            });
                                                                            $("table[id^='Homescreen_x0020_Takeover']").css({
                                                                                outline: "1px red solid"
                                                                            });

                                                                            //========== SET UP ALL INDENTATIONS

                                                                            //SPUtility.GetSPField('Trial Locations').Label.css({"margin-left": "50px", "font-size": "100%", "color": "DimGrey"});
                                                                            //SPUtility.GetSPField('Retail Stores').Label.css({"margin-left": "50px", "font-size": "100%", "color": "DimGrey"});
                                                                            //SPUtility.GetSPField('National Retailers').Label.css({"margin-left": "50px", "font-size": "100%", "color": "DimGrey"});
                                                                            SPUtility.GetSPField('National Retailers').Label.css({
                                                                                "margin-left": "50px",
                                                                                "font-size": "100%",
                                                                                "color": "red"
                                                                            });
                                                                            //SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Label.css({"margin-left": "50px", "font-size": "100%", "color": "DimGrey"});
                                                                            $('#Product_x002F_Device_x0020_Name_').css({
                                                                                "margin-left": "50px",
                                                                                "font-size": "100%",
                                                                                "color": "DimGrey"
                                                                            });
                                                                            $('#Portfolio').css({
                                                                                "margin-left": "50px",
                                                                                "font-size": "100%",
                                                                                "color": "DimGrey"
                                                                            });
                                                                            $('#National_x0020_Retailers').css({
                                                                                "margin-left": "50px",
                                                                                "font-size": "100%",
                                                                                "color": "DimGrey"
                                                                            });
                                                                            SPUtility.GetSPField('Portfolio').Label.css({
                                                                                "margin-left": "50px",
                                                                                "font-size": "100%",
                                                                                "color": "DimGrey"
                                                                            });
                                                                            $('#Strategic_x0020_Sales').css({
                                                                                "margin-left": "50px",
                                                                                "font-size": "100%",
                                                                                "color": "DimGrey"
                                                                            });
                                                                            SPUtility.GetSPField('Indirect Key Points').Label.css({
                                                                                "font-size": "100%",
                                                                                "color": "red"
                                                                            });

                                                                            //========== START OF GENERAL INFORMATION ==============================================================

                                                                            //SPUtility.HideSPField("Project Submission Date");
                                                                            SPUtility.GetSPField("Project Submission Date").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Project Submission Date").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Launch Date Modified Date").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Launch Date Modified Date").Label.attr("Hiding", true);

                                                                            var spfLaunchType = SPUtility.GetSPField("Launch Type");
                                                                            var spfLaunchTypeValue = spfLaunchType.GetValue();
                                                                            $(spfLaunchType.Dropdown).on('change', fnLaunchType);
                                                                            var spfPromoType = SPUtility.GetSPField("Promotion Type");
                                                                            $(spfPromoType.Dropdown).on('change', fnPromoType);
                                                                            var spfForTheHome = SPUtility.GetSPField("For the Home");
                                                                            $(spfForTheHome.Dropdown).on('change', fnForTheHome);
                                                                            // Sales ops removal
                                                                            //var spfSalesOpsSupportType = SPUtility.GetSPField("Sales Ops Support Type");
                                                                            //$(spfSalesOpsSupportType.Dropdown).on('change',fnSalesOpsSupportType);

                                                                            //======================CAMPAIGN/CONTEST FUNCTIONS ============================================

                                                                            fnCampaignEnhancements();

                                                                            //the following logic handles all "ALL" checkboxes click
                                                                            // 07/27/20 - no longer need this
                                                                            /*$(".ms-RadioText[title='All Mobile Areas'] :checkbox").click(
		function(){
		         var otherids = (this.id).substring(0, (this.id).length-1 );
		         var idno =(this.id).substring( (this.id).length-1, (this.id).length );
		         idno = parseInt(idno);
		
		         for (i = 0; i < 3; i++)
		         {
		         	idno = idno + 1;
		         	newid = otherids + idno;
		         	$("input[id^='"+newid+"']").prop( "checked" , (this.checked)?"checked":"" );
		         }
		});*/

                                                                            $(".ms-RadioText[title='Local Only'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "" : "");
                                                                                $("input[id^='" + this.id + "']").prop("checked", "checked");
                                                                            });

                                                                            /*$(".ms-RadioText[title='Retail (ALL)'] :checkbox").click(
       function(){
                 var otherids = (this.id).substring(0, (this.id).length-1 );
                 var idno =(this.id).substring( (this.id).length-1, (this.id).length );
                 idno = parseInt(idno);

                 for (i = 0; i < 2; i++)
                 {
                 	idno = idno + 1;
                 	newid = otherids + idno;
                 	$("input[id^='"+newid+"']").prop( "checked" , (this.checked)?"checked":"" );
                 }
       });*/

                                                                            $(".ms-RadioText[title='All Retailers'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                            });

                                                                            $(".ms-RadioText[title='All Customers'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                            });

                                                                            $(".ms-RadioText[title='All Segments'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                            });

                                                                            $(".ms-RadioText[title='All Target Customers'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                            });

                                                                            $(".ms-RadioText[title='All Customer Personas'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                            });

                                                                            $(".ms-RadioText[title='All Customer Segments'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                            });

                                                                            $(".ms-RadioText[title='All Target Competition'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 2);
                                                                                $("input[id^='" + otherids + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                            });

                                                                            $(".ms-RadioText[title='VZ.com'] :checkbox").click(function() {
                                                                                if (this.checked) {
                                                                                    var otherid = $(".ms-RadioText[title='.com Chatbot'] :checkbox")[0].id;
                                                                                    $("input[id^='" + otherid + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                                }
                                                                            });

                                                                            $(".ms-RadioText[title='ALL Fios Strategic Sales'] :checkbox").click(function() {
                                                                                var otherids = (this.id).substring(0, (this.id).length - 1);
                                                                                var idno = (this.id).substring((this.id).length - 1, (this.id).length);
                                                                                idno = parseInt(idno);

                                                                                for (i = 0; i < 10; i++) {
                                                                                    idno = idno + 1;
                                                                                    newid = otherids + idno;
                                                                                    if (idno < 11)
                                                                                        // ignore 5G Residential
                                                                                        $("input[id='" + newid + "']").prop("checked", (this.checked) ? "checked" : "");
                                                                                }
                                                                            });

                                                                            // the following logic handles all "Checkboxes" changes
                                                                            $('input[type="checkbox"]').click(function(event) {
                                                                                if (this.id.indexOf("Discount") == 0)
                                                                                    fnEmployeeDiscount();
                                                                                if (this.id.indexOf("Channel_x0020_Availability") == 0) {
                                                                                    //fnChannelAvailability(event);  
                                                                                    fnChannelAvailabilityDetail()
                                                                                }
                                                                                if (this.id.indexOf("Retail_x0020_Channel") == 0)
                                                                                    fnRetailChannel();
                                                                                if (this.id.indexOf("Market_x0020_Availability") == 0)
                                                                                    fnMarketAvailability();
                                                                                if (this.id.indexOf("Campaign_x0020_or_x0020_Contest") == 0)
                                                                                    fnCampaignEnhancements();
                                                                                //if (this.id.indexOf("Customer_x0020_Segments") == 0)
                                                                                //	fnSegmentEligibility();					
                                                                                if (this.id.indexOf("Customer_x0020_Eligibility") == 0)
                                                                                    fnCustomerEligibility(event);
                                                                                if (this.id.indexOf("Market_x0020_Regions") == 0)
                                                                                    fnMarketAvailability_Checkboxes(event);
                                                                                if (this.id.indexOf("National_x0020_Retailers") == 0)
                                                                                    fnNationalRetailers();
                                                                                if (this.id.indexOf("Support_x0020_Team_x0028_s_x0029") == 0) {
                                                                                    fnSupportTeams();
                                                                                    fnSupportTeamsClick(event);
                                                                                }

                                                                                if (this.id.indexOf("_x0035_G_x002f_LTE_x0020_Home_x0") == 0) {
                                                                                    fn5GEligibility_Checkboxes(event);
                                                                                }
                                                                                if (this.id.indexOf("Fios_x0020_Plan_x0020_Eligibilit") == 0) {
                                                                                    fnFiosEligibility_Checkboxes(event);
                                                                                }

                                                                                /*if (this.id.indexOf("Digital_x0020_Launch") == 0)	// 11/28/18
		{
			if (SPUtility.GetSPField("Digital Support Launch").GetValue().length == 0)
				SPUtility.HideSPField("Special Call Outs");
			else
				SPUtility.ShowSPField("Special Call Outs");
		}*/
                                                                                if (this.id.indexOf("Target_x0020_Competition") == 0)
                                                                                    fnTargetCompetition();
                                                                                if (this.id.indexOf("Target_x0020_Customer") == 0)
                                                                                    fnTargetCustomers();
                                                                                if (this.id.indexOf("Customer_x0020_Personas") == 0)
                                                                                    fnCustomerPersonas();
                                                                                if (this.id.indexOf("Customer_x0020_Segments") == 0)
                                                                                    fnCustomerSegments();
                                                                                if (this.id.indexOf("Partner_cc41bb54") == 0)
                                                                                    fnPartner(event);
                                                                                if (this.id.indexOf("Brand_x0020_Development") == 0)
                                                                                    fnBrandDevelopment();
                                                                                if (this.id.indexOf("Strategic_x0020_Sales") == 0)
                                                                                    fnStrategicSales(event);

                                                                            });

                                                                            // enable Child Sequence No
                                                                            var spfParentItemID = SPUtility.GetSPField("Parent Project ID");
                                                                            $(spfParentItemID.Dropdown).on('change', fnParentChild);

                                                                            fnPrimaryGTMSupport();

                                                                            fnSetLaunchType();

                                                                            fnLaunchType();

                                                                            fnChannelAvailabilityDetail();

                                                                            //fnRetailChannel(); - this is called by fnChannelAvailabilityDetail above

                                                                            fnBrandDevelopment();

                                                                            fnSalesOpsSupportType();

                                                                            // check for ..... RADIO BUTTONS field
                                                                            var spfMarketAvailability = SPUtility.GetSPField("Area Availability");
                                                                            fnMarketAvailability();

                                                                            $(spfMarketAvailability.RadioButtons).each(function(index, obj) {
                                                                                var radioButton = obj.value;
                                                                                $(radioButton).change(fnMarketAvailability);
                                                                            });

                                                                            // check for "5G..... RADIO BUTTONS field
                                                                            //var spf5G=SPUtility.GetSPField("5G");	
                                                                            //fn5G();  

                                                                            //$(spf5G.RadioButtons).each(function(index, obj) {
                                                                            //    var radioButton = obj.value;
                                                                            //    $(radioButton).change(fn5G);
                                                                            //});    

                                                                            //=============HEADER SEPARATORS TOGGLE FUNCTIONS========================
                                                                            $(".generalinfo").click(function() {
                                                                                $(".general-img-swap").click();
                                                                            })

                                                                            $(".pmo").click(function() {
                                                                                $(".pmo-img-swap").click();
                                                                            })
                                                                            $(".im").click(function() {
                                                                                $(".im-img-swap").click();
                                                                            })

                                                                            $(".gtm").click(function() {
                                                                                $(".gtm-img-swap").click();
                                                                            })

                                                                            $(".digitalops").click(function() {
                                                                                $(".digitalops-img-swap").click();
                                                                            })

                                                                            $(".admin").click(function() {
                                                                                $(".admin-img-swap").click();
                                                                            })

                                                                            $(".salesops").click(function() {
                                                                                $(".salesops-img-swap").click();
                                                                            })

                                                                            $(".general-img-swap").click(function() {
                                                                                if (!preSave) {
                                                                                    if ($(this).attr("class") == "general-img-swap") {
                                                                                        this.src = this.src.replace("-on", "-off");
                                                                                        console.log("hiding general");
                                                                                        if (isEditForm) {
                                                                                            hideRows(generalRowIndex, pmoRowIndex);
                                                                                        } else {
                                                                                            hideRows(generalRowIndex, pmoRowIndex);
                                                                                        }
                                                                                        //SPUtility.HideSPField("Project Details");
                                                                                        SPUtility.HideSPField("Project Name");
                                                                                        SPUtility.GetSPField("Project Name").ControlsRow.className = "noShow";
                                                                                        SPUtility.GetSPField("Project Name").Label.attr("Hiding", true);

                                                                                    } else {
                                                                                        this.src = this.src.replace("-off", "-on");
                                                                                        if (isEditForm) {
                                                                                            console.log("general showing edit");
                                                                                            showRows(generalRowIndex, pmoRowIndex);
                                                                                        } else {
                                                                                            console.log("general showing");
                                                                                            showRows(generalRowIndex, pmoRowIndex);
                                                                                        }
                                                                                        //SPUtility.ShowSPField("Project Details");
                                                                                        SPUtility.GetSPField("Project Name").ControlsRow.className = SPUtility.GetSPField("Project Name").ControlsRow.className.replace("noShow", "");
                                                                                        SPUtility.GetSPField("Project Name").Label.attr("Hiding", false);
                                                                                        SPUtility.ShowSPField("Project Name");
                                                                                    }
                                                                                } else {
                                                                                    this.src = this.src.replace("-off", "-on");
                                                                                    console.log("general else");
                                                                                    if (isEditForm) {
                                                                                        showRows(generalRowIndex, pmoRowIndex);
                                                                                    } else {
                                                                                        showRows(generalRowIndex, pmoRowIndex);
                                                                                    }
                                                                                    showRows(generalRowIndex, pmoRowIndex);
                                                                                    //SPUtility.ShowSPField("Project Details");
                                                                                    SPUtility.GetSPField("Project Name").ControlsRow.className = SPUtility.GetSPField("Project Name").ControlsRow.className.replace("noShow", "");
                                                                                    SPUtility.GetSPField("Project Name").Label.attr("Hiding", false);
                                                                                    SPUtility.ShowSPField("Project Name");
                                                                                }
                                                                                $(this).toggleClass("on");
                                                                            });

                                                                            $(".pmo-img-swap").click(function() {
                                                                                if (!preSave) {
                                                                                    if ($(this).attr("class") == "pmo-img-swap") {
                                                                                        console.log("pmo hiding on off");
                                                                                        this.src = this.src.replace("-on", "-off");
                                                                                        hideRows($(spfPMO).closest('tr').prevObject[0].ControlsRow.sectionRowIndex, $(spfIM).closest('tr').prevObject[0].ControlsRow.sectionRowIndex);

                                                                                    } else {
                                                                                        console.log("pmo showing off on");
                                                                                        this.src = this.src.replace("-off", "-on");
                                                                                        if (isEditForm) {
                                                                                            showRows($(spfPMO).closest('tr').prevObject[0].ControlsRow.sectionRowIndex, $(spfIM).closest('tr').prevObject[0].ControlsRow.sectionRowIndex);
                                                                                        } else {
                                                                                            showRows(pmoRowIndex, imRowIndex);
                                                                                        }
                                                                                    }
                                                                                } else {
                                                                                    console.log("pmo show else");
                                                                                    this.src = this.src.replace("-off", "-on");
                                                                                    showRows(pmoRowIndex, imRowIndex - 2);
                                                                                }
                                                                                $(this).toggleClass("on");
                                                                            })

                                                                            $(".im-img-swap").click(function() {
                                                                                if (!preSave) {
                                                                                    if ($(this).attr("class") == "im-img-swap") {
                                                                                        console.log("im hiding presave");
                                                                                        this.src = this.src.replace("-on", "-off");
                                                                                        if (isEditForm) {
                                                                                            hideRows(imRowIndex, gtmRowIndex);
                                                                                        } else {
                                                                                            hideRows(imRowIndex, gtmRowIndex);
                                                                                        }
                                                                                    } else {
                                                                                        console.log("im showing rows presave");
                                                                                        this.src = this.src.replace("-off", "-on");
                                                                                        if (isEditForm) {
                                                                                            showRows(imRowIndex - 1, gtmRowIndex);
                                                                                        } else {
                                                                                            showRows(imRowIndex - 1, gtmRowIndex);
                                                                                        }
                                                                                    }
                                                                                } else {
                                                                                    console.log("im show else");
                                                                                    this.src = this.src.replace("-off", "-on");
                                                                                    showRows(imRowIndex, gtmRowIndex);
                                                                                }
                                                                                $(this).toggleClass("on");
                                                                            })

                                                                            $(".gtm-img-swap").click(function() {
                                                                                // do not open the section if it's not GTM support
                                                                                if (!isGTM)
                                                                                    return;
                                                                                if (!preSave) {
                                                                                    if ($(this).attr("class") == "gtm-img-swap") {
                                                                                        this.src = this.src.replace("-on", "-off");
                                                                                        console.log("gtm hide presave");
                                                                                        if (isEditForm) {
                                                                                            hideRows($(spfGTM).closest('tr').prevObject[0].ControlsRow.sectionRowIndex, $(spfSalesOps).closest('tr').prevObject[0].ControlsRow.sectionRowIndex);
                                                                                        } else {
                                                                                            hideRows($(spfGTM).closest('tr').prevObject[0].ControlsRow.sectionRowIndex, $(spfSalesOps).closest('tr').prevObject[0].ControlsRow.sectionRowIndex);
                                                                                        }
                                                                                    } else {
                                                                                        this.src = this.src.replace("-off", "-on");
                                                                                        console.log("gtm row show off on");
                                                                                        showRows(gtmRowIndex - 2, salesOpsRowIndex - 2);
                                                                                    }
                                                                                } else {
                                                                                    this.src = this.src.replace("-off", "-on");
                                                                                    console.log("gtm show rows");
                                                                                    if (isEditForm) {
                                                                                        showRows(gtmRowIndex, salesOpsRowIndex - 2);
                                                                                    } else {
                                                                                        showRows(gtmRowIndex, salesOpsRowIndex);
                                                                                    }
                                                                                }
                                                                                $(this).toggleClass("on");
                                                                            })

                                                                            $(".salesops-img-swap").click(function() {
                                                                                // do not open the section if it's not CRM support
                                                                                if (!isSalesOps)
                                                                                    return;
                                                                                if (!preSave) {
                                                                                    if ($(this).attr("class") == "salesops-img-swap") {
                                                                                        this.src = this.src.replace("-on", "-off");
                                                                                        hideRows(salesOpsRowIndex, digitalOpsRowIndex);
                                                                                    } else {
                                                                                        this.src = this.src.replace("-off", "-on");
                                                                                        console.log("salessawp to digiops show imgswap");
                                                                                        showRows(salesOpsRowIndex, digitalOpsRowIndex);
                                                                                    }
                                                                                } else {
                                                                                    this.src = this.src.replace("-off", "-on");
                                                                                    console.log("saleosp to digiops show imgswap");
                                                                                    showRows(salesOpsRowIndex, digitalOpsRowIndex);
                                                                                }
                                                                                $(this).toggleClass("on");
                                                                            })

                                                                            $(".digitalops-img-swap").click(function() {
                                                                                // do not open the section if it's not Digital Ops support
                                                                                if (!isDigitalOps)
                                                                                    return;
                                                                                if (!preSave) {
                                                                                    if ($(this).attr("class") == "digitalops-img-swap") {
                                                                                        this.src = this.src.replace("-on", "-off");
                                                                                        console.log("digi opps hide rowsarino");
                                                                                        if (isEditForm) {

                                                                                            hideRows($(spfDigitalOps).closest('tr').prevObject[0].ControlsRow.sectionRowIndex, $(spfAdmin).closest('tr').prevObject[0].ControlsRow.sectionRowIndex);
                                                                                        } else {
                                                                                            hideRows($(spfDigitalOps).closest('tr').prevObject[0].ControlsRow.sectionRowIndex, $(spfAdmin).closest('tr').prevObject[0].ControlsRow.sectionRowIndex);
                                                                                        }
                                                                                    } else {
                                                                                        this.src = this.src.replace("-off", "-on");
                                                                                        console.log("digiops show img test");
                                                                                        if (isEditForm) {
                                                                                            showRows(digitalOpsRowIndex, adminRowIndex);
                                                                                        } else {
                                                                                            showRows(digitalOpsRowIndex, adminRowIndex);
                                                                                        }
                                                                                    }
                                                                                } else {
                                                                                    console.log("digiops show test img off");
                                                                                    this.src = this.src.replace("-off", "-on");
                                                                                    showRows(digitalOpsRowIndex, adminRowIndex);
                                                                                }
                                                                                $(this).toggleClass("on");
                                                                            })

                                                                            $(".admin-img-swap").click(function() {

                                                                                if (isDraft)
                                                                                    return;
                                                                                if (isAdmin) {
                                                                                    if (!preSave) {
                                                                                        if ($(this).attr("class") == "admin-img-swap") {
                                                                                            console.log("hide admin row button");
                                                                                            this.src = this.src.replace("-on", "-off");
                                                                                            if (isEditForm) {
                                                                                                hideRows(adminRowIndex, saveAsDraftRowIndex);
                                                                                                console.log("hiding home plan fields 5G/LTE and Fios")
                                                                                                //hiding home plan fields 5G/LTE and Fios
                                                                                                hideRows(lastRowIndex + 6, lastRowIndex + 9);
                                                                                                hideRows(lastRowIndex + 7, lastRowIndex + 22);

                                                                                            } else {
                                                                                                hideRows(adminRowIndex, saveAsDraftRowIndex);
                                                                                                console.log("hiding home plan fields 5G/LTE and Fios")
                                                                                                //hiding home plan fields 5G/LTE and Fios
                                                                                                hideRows(lastRowIndex + 6, lastRowIndex + 9);
                                                                                                hideRows(lastRowIndex + 7, lastRowIndex + 22);

                                                                                            }
                                                                                            //showAdmin();					
                                                                                        } else {
                                                                                            console.log("inner inner show admin");
                                                                                            this.src = this.src.replace("-off", "-on");
                                                                                            if (isEditForm) {
                                                                                                showRows(adminRowIndex, saveAsDraftRowIndex - 1);
                                                                                                // fix for top home checkbox not appearing
                                                                                                //showRows(lastRowIndex+7, lastRowIndex+22);
                                                                                                showRows(lastRowIndex + 8, lastRowIndex + 22);

                                                                                            } else {
                                                                                                showRows(adminRowIndex, saveAsDraftRowIndex);
                                                                                            }
                                                                                            showAdmin();
                                                                                        }
                                                                                    } else {
                                                                                        console.log("inner else show admin");
                                                                                        this.src = this.src.replace("-off", "-on");
                                                                                        console.log("else admin row show");
                                                                                        showRows(adminRowIndex, saveAsDraftRowIndex);
                                                                                        showAdmin();
                                                                                    }
                                                                                } else {
                                                                                    this.src = this.src.replace("-on", "-off");
                                                                                    console.log("else hide adminrow");
                                                                                    hideRows((adminRowIndex - 1), saveAsDraftRowIndex);
                                                                                    //hideRows(adminRowIndex - 1, adminRowIndex);
                                                                                }
                                                                                $(this).toggleClass("on");

                                                                            })

                                                                            // always hide rows between save as draft and last column
                                                                            hideRows(saveAsDraftRowIndex, lastRowIndex + 1);

                                                                            saveAsDraft();

                                                                            $(spfSaveAsDraft.RadioButtons).each(function(index, obj) {
                                                                                var radioButton = obj.value;
                                                                                $(radioButton).change(saveAsDraft);
                                                                            });

                                                                            // Loan Liu - cloning logic - 09/2016 	
                                                                            // use this if you want to display everything in display mode:
                                                                            //if (!isDisplayForm && (!isAdministrator || isDraft || isCloned))

                                                                            if (!isAdmin || isDraft || isCloned) {
                                                                                console.log("running admin row draft hide");
                                                                                hideRows((adminRowIndex - 1), saveAsDraftRowIndex);
                                                                            }

                                                                            if (!isCloned && isEditForm) {

                                                                                ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                    setTimeout(function() {
                                                                                        fnIsBriefEditable();
                                                                                    }, 5);
                                                                                }, 'clientpeoplepicker.js');
                                                                            }

                                                                            //Release 3.3
                                                                            //Hide fields in Loan's brief
                                                                            //SPUtility.HideSPField("Launch Date (Hidden)");
                                                                            SPUtility.GetSPField("Launch Date (Hidden)").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Launch Date (Hidden)").Label.attr("Hiding", true);

                                                                            hideLaunchDate = SPUtility.GetSPField("Launch Date (Hidden)");
                                                                            var spfPriorityLevel = SPUtility.GetSPField("Priority Level");
                                                                            $(spfPriorityLevel.Dropdown).on('change', fnPriorityLevel);
                                                                            // Remove Sales Operation Checkbox
                                                                            if (isNewForm) {
                                                                                $("#deliverable").css({
                                                                                    "display": "none"
                                                                                });
                                                                                SPUtility.GetSPField("Partner Participation Details").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Partner Participation Details").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Partner Participation Details");
                                                                                // sales ops removal
                                                                                //SPUtility.HideSPField("Sales Ops Support Type");
                                                                                //SPUtility.HideSPField("Communications Publish Date Requested");
                                                                                SPUtility.GetSPField("Indirect Training").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Indirect Training").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Indirect Training");
                                                                                //SPUtility.HideSPField("Telesales Nuances");
                                                                                //SPUtility.HideSPField("NBx Proposition Name / VBM Program Name");
                                                                                $(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").parent("span").parent("td").remove();

                                                                                //fnPopulatePromotionApplied();
                                                                                fnPopulateEligiblePricePlan();
                                                                                fnPopulatePositioning();
                                                                                fnPopulateLaunchType();
                                                                                fnPopulateIMFields();
                                                                                //09/22/2020 - accomodate CRM redirect - hide all other CRM fields
                                                                                hideRows(digitalOpsRowIndex + 1, digitalOpsRowIndex);

                                                                            }

                                                                            if (isEditForm) {
                                                                                fnParentChild();
                                                                                fnPopulateLaunchType();
                                                                                fnPopulateManagingChannel();
                                                                                createdBy = $("#onetidinfoblock1")[0].innerText.split('by')[1].trim();
                                                                                userId = _spPageContextInfo.userId;
                                                                                GetLoginUser(userId);
                                                                                // this will populate loginName
                                                                                if (isAdmin && !isDraft) {
                                                                                    if (isGTM)
                                                                                        $(".gtm-img-swap").click();
                                                                                    if (isPMO || isFWAPMO)
                                                                                        $(".pmo-img-swap").click();
                                                                                    /*if (isSalesOps)
				$(".salesops-img-swap").click();*/
                                                                                    // DO NOT TURN THIS ON YET, as per KURT
                                                                                    if (isDigitalOps)
                                                                                        $(".digitalops-img-swap").click();
                                                                                    if (isIMC || isBrand)
                                                                                        $(".im-img-swap").click();

                                                                                    if (isMarketLaunch)
                                                                                        populateBulletPoint();
                                                                                    // hide nuances fields
                                                                                    if (isEditForm && isAdmin)
                                                                                        showNuances();
                                                                                }
                                                                                if (!isDraft)
                                                                                    SPUtility.HideSPField("Save as draft?");
                                                                                // #707 - hide Save as draft after initial submission
                                                                                //09/22/2020 - accomodate CRM redirect - hide all other CRM fields
                                                                                if (!isAdmin)
                                                                                    hideRows(digitalOpsRowIndex + 1, digitalOpsRowIndex);

                                                                                if (isDraft)
                                                                                    $(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").parent("span").parent("td").remove();

                                                                            }
                                                                            if (isDisplayForm) {
                                                                                $("#deliverable").css({
                                                                                    "display": "none"
                                                                                });
                                                                                $("#SubmissionTip").css({
                                                                                    "display": "none"
                                                                                });
                                                                                //10/30/20 - display OST as per Dana's request
                                                                                //hideDisplayFormAdmin();
                                                                                SPUtility.ShowSPField("OST/NCA");
                                                                                SPUtility.GetSPField("OST/NCA)").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("OST/NCA").ControlsRow.className = SPUtility.GetSPField("OST/NCA").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.GetSPField("Save as draft?").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Save as draft?").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Parent Project ID:ID").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID:ID").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Parent Project ID:Week Of").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID:Week Of").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Parent Project ID:Launch Date").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID:Launch Date").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField("Save as draft?");
                                                                                //SPUtility.HideSPField("Parent Project ID:ID");
                                                                                //SPUtility.HideSPField("Parent Project ID:Week Of");
                                                                                //SPUtility.HideSPField("Parent Project ID:Launch Date");		
                                                                                if (!isHQSuperAdmin) {
                                                                                    if (document.getElementById('Ribbon.ListForm.Display.Manage.DeleteItem-Medium') != null)
                                                                                        document.getElementById('Ribbon.ListForm.Display.Manage.DeleteItem-Medium').style.display = 'none';
                                                                                }
                                                                            }
                                                                            //03/2020 - hide Sales Ops for non Super admin - removed on 7/22
                                                                            /*if ((isNewForm || isEditForm) && !isHQSuperAdmin && !isSalesOpsAdmin)
	{
		//$(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").prop("disabled" ,"true");

		//$(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").parent("span").parent("td").remove();
		hideRows(salesOpsRowIndex-1, digitalOpsRowIndex);
		SPUtility.HideSPField("Sales Ops Support Type");
	}*/

                                                                            if ((isNewForm || isEditForm) && (!isHQSuperAdmin && !isPromoTeam)) {
                                                                                $(".ms-RadioText[title='Unapproved Promo Calendar'] :checkbox").prop("disabled", "true");

                                                                                //$(".ms-RadioText[title='Unapproved Promo Calendar'] :checkbox").parent("span").parent("td").remove();
                                                                                SPUtility.GetSPField("Finance Status").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Finance Status").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Finance Status");
                                                                            }

                                                                            if ((isNewForm || isEditForm) && (!isHQSuperAdmin && !isPMOAdmin)) {
                                                                                $(".ms-RadioText[title='Marketing PMO Request'] :checkbox").prop("disabled", "true");
                                                                                $(".ms-RadioText[title='Marketing FWA PMO Request'] :checkbox").prop("disabled", "true");
                                                                            }
                                                                            // 02/2022 -- REMOVE IN PRODUCTION, this is for testing only

                                                                            //getAllColumns();

                                                                            // try to protect all generated headers in rich fields
                                                                            document.addEventListener('mousedown', function(e) {
                                                                                if (e.target.className.indexOf('greycellheader') > -1 || e.target.className.indexOf('greycellleftheaderbold') > -1 || e.target.className.indexOf('greycellleftheader') > -1 || e.target.className.indexOf('whitecellheaderbold') > -1 || e.target.className.indexOf('whitecellheaderboldcenter') > -1 || e.target.className.indexOf('whitecellheader') > -1 || e.target.className.indexOf('whitecellleftheader') > -1) {
                                                                                    e.preventDefault();
                                                                                }
                                                                            }, false);
                                                                        })
                                                                        //======================================== end of document.ready===========================================================
                                                                        function getAllColumns() {
                                                                            // 02/2022 -- REMOVE IN PRODUCTION, this is for testing only
                                                                            var allfields = SPUtility.GetSPFields();
                                                                            var message = "";
                                                                            for (fieldName in allfields) {
                                                                                field = SPUtility.GetSPField(fieldName);
                                                                                message = message + fieldName + ',' + field.InternalName + "\n";
                                                                            }
                                                                            console.log(message);

                                                                        }
                                                                        function sharePointReady() {
                                                                            clientContext = new SP.ClientContext(url);
                                                                            website = clientContext.get_web();
                                                                            clientContext.load(website);
                                                                            clientContext.executeQueryAsync(onRequestSucceeded, onRequestFailed);
                                                                            userRoles = JSON.parse(localStorage.getItem("userRoles"));
                                                                            if (userRoles == null || userRoles.length == 0) {
                                                                                userRoles = [];
                                                                                fnGetSiteGroups();
                                                                                // this is stored in checkADOMGroup script file
                                                                            }

                                                                        }
                                                                        function onRequestSucceeded() {//alert('URL of the website: ' + website.get_url());

                                                                        }
                                                                        function onRequestFailed(sender, args) {
                                                                            //alert('User Permission Error: ' + args.get_message());
                                                                            console.log('User Permission_new Error: ' + args.get_message());
                                                                        }

                                                                        // this is just to hold all processes until userRoles are popuplated from async method
                                                                        function checkADOMComplete() {
                                                                            if (userRoles.length == 0) {
                                                                                window.setTimeout(checkADOMComplete, 100);
                                                                                //this checks the flag every 100 miliseconds
                                                                            } else
                                                                                fnSetPermissions();
                                                                        }

                                                                        function fnSetPermissions() {
                                                                            sessionStorage.setItem("userRoles", JSON.stringify(userRoles));
                                                                            // 5/18 changes
                                                                            for (i = 0; i < userRoles.length; i++) {
                                                                                if (userRoles[i] == "GTM HQ Super Admin") {
                                                                                    isHQSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    isAdmin = true;
                                                                                    /*
			if (securityLevel < 8)  // don't overide higher security level
				securityLevel = 8;
			*/
                                                                                }
                                                                                if (userRoles[i] == "PMO Admins") {
                                                                                    isPMOAdmin = true;
                                                                                    isHQSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                } else if (userRoles[i] == "FWA PMO Admins") {
                                                                                    isFWAPMOAdmin = true;
                                                                                    isHQSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                }
                                                                                else if (userRoles[i] == "CGTM Leads") {
                                                                                    isGTMAdmin = true;
                                                                                    isCGTMLeads = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                }
                                                                                else if (userRoles[i] == "Digital Ops Admins") {
                                                                                    //isGTMAdmin = true;
                                                                                    isDOAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 3)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 3;
                                                                                } else if (userRoles[i] == "IMC Admins" || userRoles[i] == "IMC Leads") {
                                                                                    //isGTMAdmin = true;
                                                                                    isIMCAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                    if (userRoles[i] == "IMC Leads")
                                                                                        isIMCLead = true;
                                                                                } else if (userRoles[i] == "Branding ADMINS" || userRoles[i] == "Branding Leads") {
                                                                                    isBrandAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                    if (userRoles[i] == "Branding Leads")
                                                                                        isBrandLead = true;
                                                                                } else if (userRoles[i] == "Channel Ops Admins") {
                                                                                    //isGTMAdmin = true;
                                                                                    isOpsAdmin = true;
                                                                                    isAdmin = true;
                                                                                    isSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                } else if (userRoles[i] == "Sales Ops Admins") {
                                                                                    isSalesOpsAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                } else if (userRoles[i] == "DM Promo Team") {
                                                                                    isPromoTeam = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                }
                                                                            }
                                                                            // end for loop
                                                                        }

                                                                        // 06.20.18 - override default behavior of ribbon

                                                                        function ribbonIsLoaded() {

                                                                            // find the button you want to change
                                                                            var a = document.getElementById('{38FEFA0F-77B2-4B02-95F9-615129B81479}-Large');
                                                                            if (a == null)
                                                                                return false;

                                                                            // remove the default action for this button
                                                                            Sys.UI.DomEvent.clearHandlers(a)
                                                                            // define your own action
                                                                            a.setAttribute("onclick", "");
                                                                            var href = "https://onesite.verizon.com/sites/HQ_GTM/SitePages/GTM%20Deliverables.aspx?Parm1=" + ID;

                                                                            a.setAttribute("href", href);
                                                                            a.setAttribute("target", "_blank");
                                                                            a.onclick = function(event) {
                                                                                //event.preventDefault();
                                                                                return true;
                                                                            }
                                                                        }

                                                                        // Loan Liu - cloning logic - 09/16
                                                                        $.urlParam = function(name, url) {
                                                                            if (!url) {
                                                                                url = window.location.href;
                                                                            }
                                                                            var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(url);
                                                                            if (!results) {
                                                                                return undefined;
                                                                            }
                                                                            return results[1] || undefined;
                                                                        }

                                                                        // override Cancel button to go back one page

                                                                        $(function() {
                                                                            //$('input[value=Cancel]').click(function() {history.go(-1);});
                                                                            $('input[value=Cancel]').click(function() {
                                                                                if (sessionStorage.getItem("referralURL") != null) {
                                                                                    window.location = sessionStorage.getItem("referralURL");
                                                                                } else
                                                                                    window.location = "https://onesite.verizon.com/sites/HQ_GTM/SitePages/GTM%20Home%20Page.aspx";
                                                                            });
                                                                            $('input[value=Close]').click(function() {
                                                                                if (sessionStorage.getItem("referralURL") != null) {
                                                                                    window.location = sessionStorage.getItem("referralURL");
                                                                                } else
                                                                                    window.location = "https://onesite.verizon.com/sites/HQ_GTM/SitePages/GTM%20Home%20Page.aspx";
                                                                            });

                                                                        });

                                                                        function addDays(date, days) {
                                                                            var result = new Date(date);
                                                                            result.setDate(result.getDate() + days);
                                                                            return result;
                                                                        }

                                                                        function fnApplicationLaunchType() {

                                                                            var spfLaunchType = SPUtility.GetSPField("Launch Type");
                                                                            var spfLaunchTypeValue = spfLaunchType.GetValue();

                                                                            spfApplicationLaunchType = SPUtility.GetSPField("Application, Product or Service Launch Type");
                                                                            spfApplicationLaunchTypeValue = spfApplicationLaunchType.GetValue();
                                                                            // It is necessary to check for launchtype since application launch type has a default value.
                                                                            if (spfLaunchTypeValue !== 'Application, Product or Service')
                                                                                return;
                                                                            //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types"); 
                                                                            if (spfApplicationLaunchTypeValue == 'Change to existing Application, Product or Service') {
                                                                                SPUtility.ShowSPField("SKU");
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = SPUtility.GetSPField("SKU").ControlsRow.className.replace("noShow", "");
                                                                                $(".ms-RadioText[title='Preorder'] :checkbox").removeAttr("disabled");
                                                                            } else {
                                                                                //SPUtility.HideSPField("SKU");
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                $(".ms-RadioText[title='Preorder'] :checkbox").attr("disabled", "true");
                                                                                $(".ms-RadioText[title='Preorder'] :checkbox").prop('checked', false);
                                                                            }
                                                                            fnPromoDetail();

                                                                        }
                                                                        function populateBulletPoint() {
                                                                            spfKeyPoints = SPUtility.GetSPField("Key Points").GetValue();
                                                                            var bullets = " \n \n \n \n \n";
                                                                            if (spfKeyPoints.length == 0) {
                                                                                SPUtility.GetSPField("Key Points").SetValue(bullets);
                                                                            }
                                                                        }

                                                                        function fnConvertBulletPoint() {
                                                                            spfKeyPoints = SPUtility.GetSPField("Key Points");
                                                                            var a = spfKeyPoints.GetValue();
                                                                            b = a.replace(/\/g, '.');
                                                                            // replace subsequent . (only when it appears as first item on row)
                                                                            //var b = a.replace(/\./g,'&bull;');
                                                                            spfKeyPoints.SetValue(b);
                                                                        }

                                                                        function fnBulletPoint() {
                                                                            spfKeyPoints = SPUtility.GetSPField("Key Points");
                                                                            var a = spfKeyPoints.GetValue();
                                                                            var b = a;
                                                                            // check if first period is not surrounded by anything character
                                                                            var index = a.indexOf(".");
                                                                            if (index > 0)
                                                                                index = index - 1;

                                                                            if (index == 0 || a.charAt(index) == ">" || a.charAt(index - 1) == ">")
                                                                                b = a.replace(/\./, '&bull;');
                                                                            // replace first . with bullet

                                                                            b = b.replace(/\<br>./g, '<br>&bull;');
                                                                            // replace subsequent . (only when it appears as first item on row)
                                                                            b = b.replace(/\">./g, '<br>&bull;');
                                                                            //var b = a.replace(/\./g,'&bull;');
                                                                            spfKeyPoints.SetValue(b);
                                                                        }

                                                                        fnCampaignEnhancements = function() {
                                                                            var spfLaunchType = SPUtility.GetSPField("Launch Type");
                                                                            var spfLaunchTypeValue = spfLaunchType.GetValue();

                                                                            if (spfLaunchTypeValue == 'Campaign or Contest') {
                                                                                //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                var isCampaign = false;
                                                                                fnPromoDetail();
                                                                            }
                                                                        }
                                                                        ;

                                                                        fnChannelAvailability = function(event) {
                                                                            // =======no longer have N/A in Channel Availability so we don't need this any more
                                                                            // handle N/A value
                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            var otherids = "";
                                                                            if (idno < 10)
                                                                                otherids = (id).substring(0, (id).length - 1);
                                                                            else
                                                                                otherids = (id).substring(0, (id).length - 2);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;

                                                                            if (idno == totalcount) // this is N/A
                                                                            {
                                                                                //$("input[id^='"+otherids+"']").prop( "checked" , ($("input[id='"+id+"']").prop("checked"))?"":"" );
                                                                                for (i = 0; i < totalcount; i++) {
                                                                                    newid = otherids + i;
                                                                                    $("input[id='" + newid + "']").prop("checked", "");
                                                                                }
                                                                                //SPUtility.HideSPField('Retail Stores');
                                                                                SPUtility.HideSPField('National Retailers');
                                                                                SPUtility.GetSPField("National Retailers").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("National Retailers").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField('Trial Locations');
                                                                                return;
                                                                            }
                                                                            id = otherids + totalcount;
                                                                            for (i = 0; i < totalcount; i++) {
                                                                                newid = otherids + i;
                                                                                if ($("input[id='" + newid + "']").prop("checked")) {
                                                                                    $("input[id='" + id + "']").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                        }
                                                                        ;

                                                                        fnChannelAvailabilityDetail = function() {
                                                                            console.log("channelavailabilitydetail running");
                                                                            var spfChannelAvailability = SPUtility.GetSPField("Channel Availability");
                                                                            var spfChannelAvailabilityValue = spfChannelAvailability.GetValue();
                                                                            //SPUtility.HideSPField('Trial Locations');	
                                                                            //SPUtility.HideSPField('Retail Stores');
                                                                            SPUtility.HideSPField('National Retailers');
                                                                            //SPUtility.HideSPField('Strategic Sales');
                                                                            SPUtility.GetSPField("National Retailers").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("National Retailers").ControlsRow.className = "noShow";

                                                                            SPUtility.GetSPField("Strategic Sales").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Strategic Sales").ControlsRow.className = "noShow";
                                                                            var isB2BChannel = false;
                                                                            isIndirect = false;
                                                                            for (i = 0; i < spfChannelAvailabilityValue.length; i++) {
                                                                                if (spfChannelAvailability.GetValue()[i] == 'Retail') {//SPUtility.ShowSPField('Retail Stores');
                                                                                }
                                                                                if (spfChannelAvailability.GetValue()[i] == 'Indirect National Retail') {
                                                                                    SPUtility.ShowSPField('National Retailers');
                                                                                    SPUtility.GetSPField("National Retailers").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("National Retailers").ControlsRow.className = SPUtility.GetSPField("National Retailers").ControlsRow.className.replace("noShow", "");

                                                                                }
                                                                                if (spfChannelAvailability.GetValue()[i] == 'Strategic Sales') {
                                                                                    SPUtility.ShowSPField('Strategic Sales');
                                                                                    SPUtility.GetSPField("Strategic Sales").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Strategic Sales").ControlsRow.className = SPUtility.GetSPField("Strategic Sales").ControlsRow.className.replace("noShow", "");
                                                                                }

                                                                                if (spfChannelAvailability.GetValue()[i] == 'Indirect Agents' || spfChannelAvailability.GetValue()[i] == 'Prepaid Only Agents' || spfChannelAvailability.GetValue()[i] == 'Indirect National Retail')
                                                                                    isIndirect = true;

                                                                            }

                                                                            fnRetailChannel();
                                                                            if (isEditForm && isAdmin)
                                                                                showNuances();
                                                                        }
                                                                        ;

                                                                        fnCloneBrief = function(ID) {
                                                                            //console.log ("id param is " + ID);
                                                                            //DIFF between Loan Brief and GTM Dynamic Brief
                                                                            //var listname = "DEV Super Brief";
                                                                            //var listname = "Loan Dynamic Brief";
                                                                            // remove Legal_x0020_ContactId,
                                                                            var listname = "GTM Dynamic Brief";

                                                                            //var url = "https://esites.vzbi.com/sites/HQ_GTM";
                                                                            //var url = "https://esites.vzbi.com/sites/HQ_GTM/Test Launchpad";
                                                                            //var query = "?$filter=ID eq " + ID +  "&$select=ID,Project_x0020_Name,Project_x0020_Description,Launch_x0020_Date,Launch_x0020_Type,Should_x0020_this_x0020_be_x0020,Executive_x0020_SponsorId,Finance_x0020_ContactId,Clarity_x0020_ID,Provide_x0020_the_x0020_business,If_x0020_Project_x0020_requires_,Verizon_x0020_exclusive_x003F_,SKU_x0020_Information,Channel_x0020_Availability,Customer_x0020_Eligibility,Market_x0020_Availability,Customer_x0020_Primary_x0020_Use";
                                                                            var query = "?$filter=ID eq " + ID + "&$select=ID,Project_x0020_Name,Project_x0020_Description,Launch_x0020_Date,Launch_x0020_Type,Should_x0020_this_x0020_be_x0020,Executive_x0020_SponsorId,Finance_x0020_ContactId,Clarity_x0020_ID,Provide_x0020_the_x0020_business,If_x0020_Project_x0020_requires_,SKU_x0020_Information,Channel_x0020_Availability,Customer_x0020_Eligibility,Market_x0020_Availability,Customer_x0020_Primary_x0020_Use";

                                                                            var month, day, year, date;

                                                                            $.ajax({
                                                                                async: false,
                                                                                url: url + "/_api/web/lists/getbytitle('" + listname + "')/items" + query,
                                                                                method: "GET",
                                                                                headers: {
                                                                                    "Accept": "application/json; odata=verbose"
                                                                                },
                                                                                success: function(data) {
                                                                                    var stringData = JSON.stringify(data);
                                                                                    var jsonObject = JSON.parse(stringData);
                                                                                    var results = jsonObject.d.results;
                                                                                    for (i = 0; i < results.length; i++) {
                                                                                        SPUtility.GetSPField("Project Name").SetValue(results[i]["Project_x0020_Name"]);
                                                                                        SPUtility.GetSPField("Project Description/Top 5 Selling Features").SetValue(results[i]["Project_x0020_Description"]);
                                                                                        SPUtility.GetSPField("Launch Type").SetValue(results[i]["Launch_x0020_Type"]);
                                                                                        if (results[i]["Should_x0020_this_x0020_be_x0020"])
                                                                                            SPUtility.GetSPField("Is this a dark launch?").SetValue(results[i]["Should_x0020_this_x0020_be_x0020"]);
                                                                                        if (results[i]["Project_x0020_SponsorId"] > 0) {
                                                                                            peoplecolumn = "Project Lead Required Field";
                                                                                            GetCurrentUser(results[i]["Project_x0020_SponsorId"]);
                                                                                        }
                                                                                        if (results[i]["Executive_x0020_SponsorId"] > 0) {
                                                                                            peoplecolumn = "Approving Executive Sponsor";
                                                                                            GetCurrentUser(results[i]["Executive_x0020_SponsorId"]);
                                                                                        }
                                                                                        if (results[i]["Legal_x0020_ContactId"] > 0) {
                                                                                            peoplecolumn = "Approving Legal Contacts";
                                                                                            GetCurrentUser(results[i]["Legal_x0020_ContactId"]);
                                                                                        }
                                                                                        if (results[i]["Finance_x0020_ContactId"] > 0) {
                                                                                            peoplecolumn = "Approving Finance Contact";
                                                                                            GetCurrentUser(results[i]["Finance_x0020_ContactId"]);
                                                                                        }
                                                                                        if (results[i]["Price_x0020_Plan_x0020_Launch_x0"] != null)
                                                                                            SPUtility.GetSPField("Price Plan Launch Type").SetValue(results[i]["Price_x0020_Plan_x0020_Launch_x0"]);
                                                                                        /*if (results[i]["CAM_x0020_ContactId"] > 0)
				{
					peoplecolumn = "IT or CAM Contact";
					GetCurrentUser(results[i]["CAM_x0020_ContactId"]);
				}*/
                                                                                        SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").SetValue(results[i]["Clarity_x0020_ID"]);
                                                                                        if (results[i]["Target_x0020_Customer_x0020_Segm"] != null) {
                                                                                            for (j = 0; j < results[i]["Target_x0020_Customer_x0020_Segm"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Target_x0020_Customer_x0020_Segm"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }

                                                                                        //SPUtility.GetSPField("Trial Locations").SetValue(results[i]["Locations"]);
                                                                                        SPUtility.GetSPField("Business Objectives / KPIs").SetValue(results[i]["Provide_x0020_the_x0020_business"]);
                                                                                        if (results[i]["If_x0020_Project_x0020_requires_"] != null) {
                                                                                            date = results[i]["If_x0020_Project_x0020_requires_"].split('-');
                                                                                            month = date[1];
                                                                                            day = date[2];
                                                                                            year = date[0];
                                                                                            SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").SetValue(year, month, day);
                                                                                        }
                                                                                        if (results[i]["Application_x002C__x0020_Product"] != null)
                                                                                            SPUtility.GetSPField("Application, Product or Service Launch Type").SetValue(results[i]["Application_x002C__x0020_Product"]);
                                                                                        SPUtility.GetSPField("Pricing").SetValue(results[i]["Accessory_x0020_Price"]);
                                                                                        //if (results[i]["Verizon_x0020_exclusive_x003F_"] != null)
                                                                                        //	SPUtility.GetSPField("Verizon Exclusive?").SetValue(results[i]["Verizon_x0020_exclusive_x003F_"]);
                                                                                        SPUtility.GetSPField("SKU").SetValue(results[i]["SKU_x0020_Information"]);

                                                                                        if (results[i]["Campaign_x0020_or_x0020_Contest_"] != null) {
                                                                                            for (j = 0; j < results[i]["Campaign_x0020_or_x0020_Contest_"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Campaign_x0020_or_x0020_Contest_"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }
                                                                                        /*for (j = 0; j < results[i]["Customer_x0020_Segment"].results.length; j++)
				{
					$("span[title='" + results[i]["Customer_x0020_Segment"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
				}*/
                                                                                        if (results[i]["Customer_x0020_Primary_x0020_Use"])
                                                                                            SPUtility.GetSPField("Customer Primary Use Case").SetValue(results[i]["Customer_x0020_Primary_x0020_Use"]);

                                                                                        for (j = 0; j < results[i]["Channel_x0020_Availability"].results.length; j++) {
                                                                                            $("span[title='" + results[i]["Channel_x0020_Availability"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                        }

                                                                                        //Release 3.3 - add missing national Retailers
                                                                                        if (results[i]["National_x0020_Retailers"] != null) {
                                                                                            for (j = 0; j < results[i]["National_x0020_Retailers"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["National_x0020_Retailers"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }
                                                                                        if (results[i]["Customer_x0020_Eligibility"] != null) {
                                                                                            for (j = 0; j < results[i]["Customer_x0020_Eligibility"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Customer_x0020_Eligibility"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }
                                                                                        if (results[i]["Market_x0020_Availability"] != null) {
                                                                                            for (j = 0; j < results[i]["Market_x0020_Availability"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Market_x0020_Availability"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }
                                                                                        if (results[i]["Retail_x0020_Channel"] != null) {
                                                                                            for (j = 0; j < results[i]["Retail_x0020_Channel"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Retail_x0020_Channel"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }

                                                                                        if (results[i]["Call_x0020_to_x0020_Action_x0020"] != null) {
                                                                                            for (j = 0; j < results[i]["Call_x0020_to_x0020_Action_x0020"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Call_x0020_to_x0020_Action_x0020"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }
                                                                                        if (results[i]["Impacted_x0020_Digital_x0020_Ops"] != null) {
                                                                                            for (j = 0; j < results[i]["Impacted_x0020_Digital_x0020_Ops"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Impacted_x0020_Digital_x0020_Ops"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }

                                                                                        SPUtility.GetSPField("Project Submission Date").SetValue(null);
                                                                                        if (results[i]["Eligible_x0020_Agreement_x0020_T"] != null) {
                                                                                            for (j = 0; j < results[i]["Eligible_x0020_Agreement_x0020_T"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Eligible_x0020_Agreement_x0020_T"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }
                                                                                        if (results[i]["Inventory_x0020_Outlook"] != null)
                                                                                            SPUtility.GetSPField("Inventory Outlook").SetValue(results[i]["Inventory_x0020_Outlook"]);

                                                                                        //SPUtility.GetSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types").SetValue(results[i]["Price_x0020_Plan_x0020_Details"]);
                                                                                        if (results[i]["Indicate_x0020_which_x0020_contr"] != null) {
                                                                                            for (j = 0; j < results[i]["Indicate_x0020_which_x0020_contr"].results.length; j++) {
                                                                                                $("span[title='" + results[i]["Indicate_x0020_which_x0020_contr"].results[j] + "']  input[type=checkbox]").prop('checked', 'check');
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                },
                                                                                error: function(data) {
                                                                                    //failure(data);
                                                                                    alert("error cloning brief " + data);
                                                                                }
                                                                            });

                                                                        }
                                                                        ;

                                                                        function GetCurrentUser(userid) {
                                                                            var requestUri = _spPageContextInfo.webAbsoluteUrl + "/_api/web/getuserbyid(" + userid + ")";

                                                                            var requestHeaders = {
                                                                                "accept": "application/json;odata=verbose"
                                                                            };

                                                                            $.ajax({
                                                                                async: false,
                                                                                url: requestUri,
                                                                                contentType: "application/json;odata=verbose",
                                                                                headers: requestHeaders,
                                                                                success: onSuccess,
                                                                                error: onError
                                                                            });
                                                                        }

                                                                        function onSuccess(data, request) {
                                                                            var loginName = data.d.LoginName.split('|')[1];
                                                                            //alert(loginName);
                                                                            SetAndResolvePeoplePicker(peoplecolumn, loginName);
                                                                            // return loginName;
                                                                        }

                                                                        function onError(error) {
                                                                            alert(error);
                                                                        }

                                                                        function SetAndResolvePeoplePicker(fieldName, userAccountName) {

                                                                            var peoplePickerId = $("div[title='" + fieldName + "']").attr('id');
                                                                            var peoplePicker = $("input[title^='" + fieldName + "']").val(userAccountName);
                                                                            var peoplePickerObject = SPClientPeoplePicker.SPClientPeoplePickerDict[peoplePickerId];
                                                                            peoplePickerObject.AddUnresolvedUserFromEditor(true);

                                                                        }

                                                                        fnCustomerEligibility = function(event) {

                                                                            // first logic is to turn on/off all checkboxes
                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            if (idno == 0) // this is the first ALL checkbox
                                                                            {
                                                                                $("input[id^='" + otherids + "']").prop("checked", ($("input[id='" + id + "']").prop("checked")) ? "checked" : "");
                                                                                return;
                                                                            }
                                                                            newid = otherids + idno;

                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = 0;

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Customers'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Customers'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        fnMarketAvailability_Checkboxes = function(event) {

                                                                            // first logic is to turn on/off all checkboxes
                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            if (idno == 0) // this is the first ALL checkbox
                                                                            {
                                                                                $("input[id^='" + otherids + "']").prop("checked", ($("input[id='" + id + "']").prop("checked")) ? "checked" : "");
                                                                                return;
                                                                            }
                                                                            newid = otherids + idno;

                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = 0;

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Markets'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Markets'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        // check for "Other" in Sponsor's department
                                                                        //*** THIS FUNCTION IS NOT BEING USED 
                                                                        function fnGetGroupCollectionFromUser() {
                                                                            $().SPServices({
                                                                                operation: "GetGroupCollectionFromUser",
                                                                                userLoginName: $().SPServices.SPGetCurrentUser(),
                                                                                async: false,
                                                                                completefunc: function(xData, Status) {
                                                                                    //if($(xData.responseXML).find("Group[Name='GroupName']").length == 1) {
                                                                                    //$("#zz9_ID_PersonalizePage").remove();
                                                                                    //}
                                                                                    $("#WSOutput1").html("").append("<b>This is the output from the GetUserInfo operation:</b>");
                                                                                    $(xData.responseXML).find("Group").each(function() {
                                                                                        $("#WSOutput1").append("<li>ID: " + $(this).attr("ID") + "</li>");
                                                                                        $("#WSOutput1").append("<li>Name: " + $(this).attr("Name") + "</li>");
                                                                                        $("#WSOutput1").append("<li>Description: " + $(this).attr("Description") + "</li>");
                                                                                        $("#WSOutput1").append("<li>Owner is user: " + $(this).attr("OwnerIsUser") + "</li>");
                                                                                        $("#WSOutput1").append("<hr/>");
                                                                                        userRoles.push($(this).attr("Name"));
                                                                                    });
                                                                                }
                                                                            });
                                                                            for (i = 0; i < userRoles.length; i++) {
                                                                                //if (userRoles[i] == "MicroSite Developers" || userRoles[i] == "MicroSite Owners" || userRoles[i] == "MicroSite TOPS Members")
                                                                                if (userRoles[i] == "CGTM Leads") {
                                                                                    isAdministrator = true;
                                                                                    //if (userRoles[i] == "MicroSite Developers" || userRoles[i] == "MicroSite TOPS Members") - no longer needed
                                                                                    {
                                                                                        isSuperAdmin = true;
                                                                                        isAdministrator = true;
                                                                                        isGTMAdmin = true;
                                                                                        isAdmin = true;
                                                                                        /*
					if (securityLevel < 8)  // don't overide higher security level
						securityLevel = 8;
					*/
                                                                                    }
                                                                                } else if (userRoles[i] == "GTM HQ Super Admin") {
                                                                                    isHQSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    isAdmin = true;
                                                                                    /*
				if (securityLevel < 8)  // don't overide higher security level
					securityLevel = 8;
				*/
                                                                                } else if (userRoles[i] == "Digital Ops Admins") {
                                                                                    isDOAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 3)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 3;
                                                                                } else if (userRoles[i] == "IMC Admins") {
                                                                                    // Leads and Admins have the same functionally here, the only difference is that Leads will not have an admin icon on their dashboard, and won't receive 
                                                                                    // workflow notification
                                                                                    isIMCAdmin = true;
                                                                                    isAdmin = true;
                                                                                    if (securityLevel < 7)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 7;
                                                                                } else if (userRoles[i] == "B2B Admins") {
                                                                                    isB2BAdmin = true;
                                                                                    isAdmin = true;
                                                                                    isSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;

                                                                                } else if (userRoles[i] == "Channel Ops Admins") {
                                                                                    isOpsAdmin = true;
                                                                                    isAdmin = true;
                                                                                    isSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;

                                                                                } else if (userRoles[i] == "PNB Admins" || userRoles[i] == "Media Co Admins") {
                                                                                    isPNBAdmin = true;
                                                                                    isAdmin = true;
                                                                                    isSuperAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;

                                                                                } else if (userRoles[i] == "Internal Comm Admins") {
                                                                                    isICAdmin = true;
                                                                                    isAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                    if (securityLevel < 8)
                                                                                        // don't overide higher security level
                                                                                        securityLevel = 8;
                                                                                }
                                                                            }
                                                                        }

                                                                        function getEditorPeoplePickerValues(fieldName) {
                                                                            // Field Title
                                                                            var editorNames = "";
                                                                            var _PeoplePicker = $("div[title='" + fieldName + "']");
                                                                            var _PeoplePickerTopId = _PeoplePicker.attr('id');

                                                                            var ppobject = SPClientPeoplePicker.SPClientPeoplePickerDict[_PeoplePickerTopId];
                                                                            editorsInfo = ppobject.GetAllUserInfo();
                                                                            var i;
                                                                            for (i = 0; i < editorsInfo.length; ++i) {
                                                                                editorNames += editorsInfo[i].DisplayText;
                                                                            }
                                                                            console.log(fieldName + "," + editorNames);
                                                                            if (editorNames.indexOf(loginName) != -1)
                                                                                isAdmin = true;

                                                                            return editorNames;
                                                                        }

                                                                        //function fnIsBriefEditable(startRow, endRow)
                                                                        function fnIsBriefEditable() {
                                                                            setTimeout(function() {
                                                                                gtmleads = getEditorPeoplePickerValues("GTM Lead");
                                                                                //pmoleads = getEditorPeoplePickerValues("PMO Lead(s)");
                                                                                dolead = getEditorPeoplePickerValues("DO Lead");
                                                                                imcleads = getEditorPeoplePickerValues("IMC Leads");
                                                                                brandingleads = getEditorPeoplePickerValues("Branding Leads");
                                                                                //salesopsleads = getEditorPeoplePickerValues("Sales Ops Lead(s)");
                                                                                srmgrleads = getEditorPeoplePickerValues("Lead Sr. Mgr");
                                                                                if (gtmleads != null && gtmleads.indexOf(loginName) != -1) {
                                                                                    isAdmin = true;
                                                                                    isGTMAdmin = true;
                                                                                }
                                                                                if (pmoleads != null && pmoleads.indexOf(loginName) != -1) {
                                                                                    isAdmin = true;
                                                                                    isPMOAdmin = true;
                                                                                }
                                                                                if (dolead != null && dolead.indexOf(loginName) != -1) {
                                                                                    isAdmin = true;
                                                                                    isDOAdmin = true;
                                                                                }

                                                                                if (imcleads != null && imcleads.indexOf(loginName) != -1) {
                                                                                    isAdmin = true;
                                                                                    isIMCAdmin = true;
                                                                                }
                                                                                if (brandingleads != null && brandingleads.indexOf(loginName) != -1) {
                                                                                    isAdmin = true;
                                                                                    isBrandAdmin = true;
                                                                                }
                                                                                //if(salesopsleads != null && salesopsleads.indexOf(loginName) != -1)
                                                                                //{
                                                                                //	isAdmin = true;
                                                                                //	isSalesOpsAdmin = true;
                                                                                //}
                                                                                if (srmgrleads != null && srmgrleads.indexOf(loginName) != -1)
                                                                                    isAdmin = true;

                                                                                SPUtility.ShowSPField("Project Submission Date");
                                                                                SPUtility.GetSPField("Project Submission Date").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Project Submission Date").ControlsRow.className = SPUtility.GetSPField("Project Submission Date").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("Project Submission Date").MakeReadOnly();
                                                                                //if (assignedLevel > 0 && securityLevel < 8)  // brief has been assigned to some support group, lock out everything for non admin person
                                                                                if (SPUtility.GetSPField("Managing Channel").GetValue() == 'GTM' && !isAdmin && SPUtility.GetSPField("GTM Status").GetValue() == "Assigned") {
                                                                                    $(".ms-formtable input").prop("disabled", true);
                                                                                    $(".ms-formtable select").prop("disabled", true);
                                                                                    $(".ms-formtable textarea").prop("disabled", true);
                                                                                    $('input[value=Submit]').prop("disabled", true);
                                                                                    //document.getElementById('Ribbon.ListForm.Edit.Commit.Publish-Large').style.display='none';
                                                                                    //document.getElementById('Ribbon.ListForm.Edit.Actions.AttachFile-Large').style.display='none';
                                                                                    $(".ms-formtable div[role='textbox']").attr("contenteditable", "false");
                                                                                } else if (SPUtility.GetSPField("Managing Channel").GetValue() != 'GTM' && isAdmin) {
                                                                                    SPUtility.ShowSPField("ADMIN");
                                                                                    SPUtility.GetSPField("ADMIN").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("ADMIN").ControlsRow.className = SPUtility.GetSPField("ADMIN").ControlsRow.className.replace("noShow", "");
                                                                                    $('input[value=Submit]').prop("disabled", false);
                                                                                    // 
                                                                                    //if (typeof document.getElementById('Ribbon.ListForm.Edit.Commit.Publish-Large') != 'undefined')	
                                                                                    //	document.getElementById('Ribbon.ListForm.Edit.Commit.Publish-Large').style.display='inline-block';
                                                                                    //if (typeof document.getElementById('Ribbon.ListForm.Edit.Actions.AttachFile-Large') != 'undefined')
                                                                                    //	document.getElementById('Ribbon.ListForm.Edit.Actions.AttachFile-Large').style.display='inline-block';

                                                                                }
                                                                                showAdmin();
                                                                                //===============COMMENTED OUT on 03/05/2020 - this has been processed in fnPrimaryGTMSupport function

                                                                            }, 100);
                                                                            /*setTimeout(function(){
		     pmoleads = getEditorPeoplePickerValues("PMO Lead(s)");
	    }, 500);
	    setTimeout(function(){
		     dolead = getEditorPeoplePickerValues("DO Lead");
	    }, 500);
	    setTimeout(function(){
		     crmleads = getEditorPeoplePickerValues("CRM Lead");
	    }, 500);
	    setTimeout(function(){
		     imcleads = getEditorPeoplePickerValues("IMC Leads");
	    }, 500);
	    setTimeout(function(){
		     brandingleads = getEditorPeoplePickerValues("Branding Leads");
	    }, 500);
	    setTimeout(function(){
		     salesopsleads = getEditorPeoplePickerValues("Sales Ops Lead(s)");
	    }, 500);
	    setTimeout(function(){
		     srmgrleads = getEditorPeoplePickerValues("Lead Sr. Mgr");
	    }, 500);	
	    */
                                                                            /*pmoleads = getEditorPeoplePickerValues("PMO Lead(s)");
		imcleads = getEditorPeoplePickerValues("IMC Leads");
		dolead = getEditorPeoplePickerValues("DO Lead");
		brandingleads = getEditorPeoplePickerValues("Branding Leads");
		salesopsleads = getEditorPeoplePickerValues("Sales Ops Lead(s)");
		srmgrleads = getEditorPeoplePickerValues("Lead Sr. Mgr");  */
                                                                        }

                                                                        //added 2.13.2024 to account for new Home Plan field additions
                                                                        fnForTheHome = function() {
                                                                            var spfForTheHome = SPUtility.GetSPField("For the Home").GetValue();

                                                                            if (spfForTheHome == "") {
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").Label.attr("Hiding", true);
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").Label.attr("Hiding", true);

                                                                                $(".ms-RadioText[title='No Home Plan Required'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='5G Home'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='5G Home Plus'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='LTE Home'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='LTE Home Plus'] :checkbox").prop('checked', false);

                                                                                $(".ms-RadioText[title='No Fios Plan Required'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='Fios 300M'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='Fios 500M'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='Fios 1 Gig'] :checkbox").prop('checked', false);
                                                                                $(".ms-RadioText[title='Fios 2 Gig'] :checkbox").prop('checked', false);

                                                                            }

                                                                            if (spfForTheHome == "5G home") {
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").Label.attr("Hiding", true);
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").ControlsRow.className = SPUtility.GetSPField("5G/LTE Home Plan Eligibility").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").Label.attr("Hiding", false);

                                                                                //show all options in field change 5/10/24
                                                                                //$(".ms-RadioText[title='5G Home']").removeClass("noShow");
                                                                                //$(".ms-RadioText[title='5G Home Plus']").removeClass("noShow");
                                                                                //$(".ms-RadioText[title='LTE Home']").addClass("noShow");
                                                                                //$(".ms-RadioText[title='LTE Home Plus']").addClass("noShow");

                                                                                var spf5G = SPUtility.GetSPField("5G/LTE Home Plan Eligibility").GetValue();
                                                                                if (spf5G.length == 0) {
                                                                                    $(".ms-RadioText[title='No Home Plan Required'] :checkbox").prop('checked', true);
                                                                                    $(".ms-RadioText[title='No Fios Plan Required'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 300M'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 500M'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 1 Gig'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 2 Gig'] :checkbox").prop('checked', false);

                                                                                }
                                                                            }

                                                                            if (spfForTheHome == "4G LTE") {
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").Label.attr("Hiding", true);
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").ControlsRow.className = SPUtility.GetSPField("5G/LTE Home Plan Eligibility").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").Label.attr("Hiding", false);

                                                                                //show all options in field change 5/10/24
                                                                                //$(".ms-RadioText[title='5G Home']").addClass("noShow");
                                                                                //$(".ms-RadioText[title='5G Home Plus']").addClass("noShow");
                                                                                //$(".ms-RadioText[title='LTE Home']").removeClass("noShow");
                                                                                //$(".ms-RadioText[title='LTE Home Plus']").removeClass("noShow");

                                                                                var spfLTE = SPUtility.GetSPField("5G/LTE Home Plan Eligibility").GetValue();
                                                                                if (spfLTE.length == 0) {
                                                                                    $(".ms-RadioText[title='No Home Plan Required'] :checkbox").prop('checked', true);
                                                                                    $(".ms-RadioText[title='No Fios Plan Required'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 300M'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 500M'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 1 Gig'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Fios 2 Gig'] :checkbox").prop('checked', false);
                                                                                }
                                                                            }

                                                                            if (spfForTheHome == "Fios") {
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("5G/LTE Home Plan Eligibility").Label.attr("Hiding", true);
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").ControlsRow.className = SPUtility.GetSPField("Fios Plan Eligibility").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("Fios Plan Eligibility").Label.attr("Hiding", false);

                                                                                var spfFios = SPUtility.GetSPField("Fios Plan Eligibility").GetValue();
                                                                                if (spfFios.length == 0) {
                                                                                    $(".ms-RadioText[title='No Fios Plan Required'] :checkbox").prop('checked', true);
                                                                                    $(".ms-RadioText[title='No Home Plan Required'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='5G Home'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='5G Home Plus'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='LTE Home'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='LTE Home Plus'] :checkbox").prop('checked', false);
                                                                                }
                                                                            }
                                                                        }

                                                                        fn5GEligibility_Checkboxes = function(event) {
                                                                            // first logic is to turn on/off all checkboxes
                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;

                                                                            if (idno == 0) // this is the first "No plan required" checkbox
                                                                            {
                                                                                $("input[id^='" + otherids + "']").prop("checked", true);
                                                                                for (i = 0; i < totalcount + 1; i++) {
                                                                                    idno = idno + 1;
                                                                                    newid = otherids + idno;
                                                                                    if ($("input[id^='" + newid + "']").prop("checked")) {
                                                                                        $("input[id^='" + newid + "']").prop("checked", "");
                                                                                    }
                                                                                }
                                                                                return;
                                                                            }
                                                                            newid = otherids + idno;

                                                                            // the following logic is to clear out the "No plan required" checkbox if any of its related checkbox is unchecked
                                                                            // var totalcount = $("input[id^='"+otherids+"']").length - 1;
                                                                            idno = 0;

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if ($("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='No Home Plan Required'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                        }
                                                                        ;

                                                                        fnFiosEligibility_Checkboxes = function(event) {
                                                                            // first logic is to turn on/off all checkboxes
                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;

                                                                            if (idno == 0) // this is the first "No plan required" checkbox
                                                                            {
                                                                                $("input[id^='" + otherids + "']").prop("checked", true);

                                                                                for (i = 0; i < totalcount + 1; i++) {
                                                                                    idno = idno + 1;
                                                                                    newid = otherids + idno;
                                                                                    if ($("input[id^='" + newid + "']").prop("checked")) {
                                                                                        $("input[id^='" + newid + "']").prop("checked", "");
                                                                                    }
                                                                                }
                                                                                return;
                                                                            }
                                                                            newid = otherids + idno;

                                                                            // the following logic is to clear out the "No plan required" checkbox if any of its related checkbox is unchecked
                                                                            // var totalcount = $("input[id^='"+otherids+"']").length - 1;
                                                                            idno = 0;

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if ($("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='No Fios Plan Required'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                        }
                                                                        ;

                                                                        // 04.22 add logic for PMO and FWA PMO
                                                                        fnLaunchType = function() {
                                                                            //8/28/17 - check isGTM here to ensure all fields are popuplated correctly (especially inventory outlook)]
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().indexOf('Marketing PMO Request') > -1)
                                                                                isPMO = true;
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().indexOf('Marketing FWA PMO Request') > -1)
                                                                                isFWAPMO = true;
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().indexOf('Go To Market') > -1)
                                                                                isGTM = true;
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().indexOf('Integrated Marketing Communications') > -1)
                                                                                isIMC = true;
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().indexOf('Brand Development') > -1)
                                                                                isBrand = true;
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().indexOf('Sales Operations (ONLY)') > -1)
                                                                                isSalesOps = true;
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().indexOf('Unapproved Promo Calendar') > -1)
                                                                                isPromo = true;

                                                                            fnChannelAvailabilityDetail();
                                                                            spfLaunchType = SPUtility.GetSPField("Launch Type");
                                                                            spfLaunchTypeValue = spfLaunchType.GetValue();
                                                                            //SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Verizon Exclusive?").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Verizon Exclusive?");
                                                                            //SPUtility.HideSPField('Operations Type');  - removed 06/18/e20
                                                                            SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Plan/Payment Type").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField('Plan/Payment Type');
                                                                            //SPUtility.HideSPField('Field Activation Pillar');

                                                                            //SPUtility.HideSPField('Application, Product or Service Launch Type');
                                                                            //SPUtility.HideSPField('Price Plan Launch Type');

                                                                            //hideCampaignLaunchType();
                                                                            //hideApplicationLaunchType();
                                                                            //hidePricePlanLaunchType();
                                                                            hidePromotionLaunchType();
                                                                            hideDeviceLaunchType();
                                                                            isAgenda = false;
                                                                            isMarketLaunch = '';
                                                                            fnUnHideNonMarketActivity();
                                                                            if (isNewForm) {
                                                                                console.log("running admin new form hide");
                                                                                hideRows(adminRowIndex - 1, saveAsDraftRowIndex - 2);
                                                                                //fios field change
                                                                                hideRows(lastRowIndex + 6, lastRowIndex + 9);
                                                                                // widget field change
                                                                                hideRows(lastRowIndex + 7, lastRowIndex + 22);

                                                                                // 11/28/18
                                                                                //SPUtility.HideSPField('Special Call Outs');	
                                                                                //SPUtility.HideSPField("Digital Support Launch");
                                                                                //SPUtility.HideSPField("Partner Participation Details");	
                                                                                SPUtility.GetSPField("Partner Participation Details").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Partner Participation Details").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField('Sales Ops Support Type Requested');
                                                                                //SPUtility.HideSPField('Business Area Expertise Needed');
                                                                                //SPUtility.HideSPField('Currently Prioritized with Portfolio Team?');
                                                                            }

                                                                            if (isEditForm) {
                                                                                // fix for top home checkbox not appearing
                                                                                // hideRows(lastRowIndex+8, lastRowIndex+22);
                                                                                // changed here
                                                                                hideRows(lastRowIndex + 7, lastRowIndex + 22);
                                                                            }
                                                                            /*if (spfLaunchTypeValue == 'Field Activation' || spfLaunchTypeValue == 'Campaign or Contest' || spfLaunchTypeValue == 'System or Process Enhancement' || spfLaunchTypeValue == 'Fios TV Channel Changes' || spfLaunchTypeValue == 'Operations')
		{
			SPUtility.HideSPField('Preorder Date');
		}
		else
		{
			SPUtility.ShowSPField('Preorder Date');
		}*/
                                                                            /*if (spfLaunchTypeValue == 'Operations')
			SPUtility.ShowSPField('Operations Type');*/
                                                                            SPUtility.ShowSPField('Eligible Transactions');
                                                                            SPUtility.GetSPField("Eligible Transactions").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Eligible Transactions").ControlsRow.className = SPUtility.GetSPField("Eligible Transactions").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField('Eligible Customers');
                                                                            SPUtility.GetSPField("Eligible Customers").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Eligible Customers").ControlsRow.className = SPUtility.GetSPField("Eligible Customers").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField('Clarity/Jira/Ref ID or URL link to project');
                                                                            SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").ControlsRow.className = SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField('IT or CAM Contacts');
                                                                            SPUtility.GetSPField("IT or CAM Contacts").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("IT or CAM Contacts").ControlsRow.className = SPUtility.GetSPField("IT or CAM Contacts").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.GetSPField("Local Marketing PMO Approval Code").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Local Marketing PMO Approval Code").Label.attr("Hiding", true);
                                                                            //SPUtility.HideSPField('Local Marketing PMO Approval Code');
                                                                            SPUtility.ShowSPField('If Project requires IT release (ER or CR) enter date');
                                                                            SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").ControlsRow.className = SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.HideSPField('Field Activation Pillar');
                                                                            SPUtility.GetSPField("Brand Development Support Type").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Brand Development Support Type").ControlsRow.className = "noShow";
                                                                            //SPUtility.HideSPField("Brand Development Support Type");
                                                                            SPUtility.GetSPField("Brand Identify Offer Category").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Brand Identify Offer Category").ControlsRow.className = "noShow";
                                                                            //SPUtility.HideSPField("Brand Identify Offer Category");
                                                                            SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Hide();
                                                                            SPUtility.GetSPField("Portfolio").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Portfolio").Label.attr("Hiding", true);
                                                                            //SPUtility.HideSPField("Portfolio");
                                                                            SPUtility.GetSPField("User Experience").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("User Experience").ControlsRow.className = "noShow";
                                                                            //SPUtility.HideSPField("User Experience");
                                                                            //SPUtility.HideSPField("Accessory Retail Price");
                                                                            SPUtility.GetSPField("Accessory Type").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Accessory Type").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Accessory Type");
                                                                            //SPUtility.HideSPField("Accessory Sale Price");
                                                                            //SPUtility.HideSPField("Product or Service Type");
                                                                            //SPUtility.HideSPField("Price Plan Type");
                                                                            //SPUtility.GetSPField("Will this project require Digital PMO support?").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Will this project require Digital PMO support?").Label.attr("Hiding", true);

                                                                            //SPUtility.GetSPField("Project Workstream").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Project Workstream").Label.attr("Hiding", true);

                                                                            //SPUtility.GetSPField("Capital Cost").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Capital Cost").Label.attr("Hiding", true);

                                                                            //SPUtility.GetSPField("Annual Expense").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Annual Expense").Label.attr("Hiding", true);

                                                                            //SPUtility.GetSPField("Technical Product Development Sizing").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Technical Product Development Sizing").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Device OEM").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Device OEM").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Will this project require Digital PMO support?");
                                                                            //SPUtility.HideSPField("Project Workstream");
                                                                            //SPUtility.HideSPField("Capital Cost");
                                                                            //SPUtility.HideSPField("Annual Expense");
                                                                            //SPUtility.HideSPField("Technical Product Development Sizing");
                                                                            //SPUtility.HideSPField("Device OEM");

                                                                            if (spfLaunchTypeValue == 'Local Marketing') {
                                                                                SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Is this a dark launch?").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField('Is this a dark launch?');
                                                                                //SPUtility.HideSPField('If Project requires IT release (ER or CR) enter date');
                                                                                //SPUtility.ShowSPField('Field Activation Pillar');
                                                                                //SPUtility.ShowSPField('Local Marketing PMO Approval Code');
                                                                                //SPUtility.GetSPField("Local Marketing PMO Approval Code").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Local Marketing PMO Approval Code").ControlsRow.className = SPUtility.GetSPField("Local Marketing PMO Approval Code").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("IT or CAM Contacts").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("IT or CAM Contacts").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Eligible Transactions").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Eligible Transactions").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Eligible Customers").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Eligible Customers").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField('Clarity/Jira/Ref ID or URL link to project');
                                                                                //SPUtility.HideSPField('IT or CAM Contacts');
                                                                                //SPUtility.HideSPField('Eligible Transactions')
                                                                                //SPUtility.HideSPField('Eligible Customers');
                                                                                //SPUtility.HideSPField('Product or Service Offerings');
                                                                                //SPUtility.HideSPField('Marketplace Insights');
                                                                                //SPUtility.HideSPField('Target Consumer');
                                                                                //SPUtility.HideSPField('Opportunity');
                                                                                //SPUtility.HideSPField('Barrier');
                                                                                //SPUtility.HideSPField('IMC Deliverables');
                                                                                //SPUtility.HideSPField('Value Proposition');
                                                                                //SPUtility.HideSPField('Eligible Transactions');
                                                                                // no longer neet to set default channel - 01/04/2021
                                                                                //$("input[id^='Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_']").prop( "checked" , "" );
                                                                                //$("input[id='Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_13']").prop( "checked" , "checked" );
                                                                                //SPUtility.HideSPField('Retail Stores');
                                                                                SPUtility.GetSPField("National Retailers").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("National Retailers").Label.attr("Hiding", true);
                                                                                SPUtility.HideSPField('National Retailers');

                                                                                SPUtility.ShowSPField("Product or Service Offerings");
                                                                                SPUtility.GetSPField("Product or Service Offerings").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Product or Service Offerings").ControlsRow.className = SPUtility.GetSPField("Product or Service Offerings").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Marketplace Insights");
                                                                                SPUtility.GetSPField("Marketplace Insights").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Marketplace Insights").ControlsRow.className = SPUtility.GetSPField("Marketplace Insights").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Target Consumer");
                                                                                SPUtility.GetSPField("Target Consumer").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Target Consumer").ControlsRow.className = SPUtility.GetSPField("Target Consumer").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Opportunity");
                                                                                SPUtility.GetSPField("Opportunity").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Opportunity").ControlsRow.className = SPUtility.GetSPField("Opportunity").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Barrier");
                                                                                SPUtility.GetSPField("Barrier").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Barrier").ControlsRow.className = SPUtility.GetSPField("Barrier").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("IMC Deliverables");
                                                                                SPUtility.GetSPField("IMC Deliverables").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("IMC Deliverables").ControlsRow.className = SPUtility.GetSPField("IMC Deliverables").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField('Value Proposition');
                                                                                SPUtility.GetSPField("Value Proposition").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Value Proposition").ControlsRow.className = SPUtility.GetSPField("Value Proposition").ControlsRow.className.replace("noShow", "");

                                                                            } else if (isIMC || isBrand) {
                                                                                SPUtility.ShowSPField("Product or Service Offerings");
                                                                                SPUtility.GetSPField("Product or Service Offerings").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Product or Service Offerings").ControlsRow.className = SPUtility.GetSPField("Product or Service Offerings").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Marketplace Insights");
                                                                                SPUtility.GetSPField("Marketplace Insights").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Marketplace Insights").ControlsRow.className = SPUtility.GetSPField("Marketplace Insights").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Target Consumer");
                                                                                SPUtility.GetSPField("Target Consumer").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Target Consumer").ControlsRow.className = SPUtility.GetSPField("Target Consumer").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Opportunity");
                                                                                SPUtility.GetSPField("Opportunity").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Opportunity").ControlsRow.className = SPUtility.GetSPField("Opportunity").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Barrier");
                                                                                SPUtility.GetSPField("Barrier").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Barrier").ControlsRow.className = SPUtility.GetSPField("Barrier").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("IMC Deliverables");
                                                                                SPUtility.GetSPField("IMC Deliverables").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("IMC Deliverables").ControlsRow.className = SPUtility.GetSPField("IMC Deliverables").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField('Value Proposition');
                                                                                SPUtility.GetSPField("Value Proposition").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Value Proposition").ControlsRow.className = SPUtility.GetSPField("Value Proposition").ControlsRow.className.replace("noShow", "");

                                                                            }
                                                                            if (isBrand) {
                                                                                SPUtility.ShowSPField("Brand Development Support Type");
                                                                                SPUtility.GetSPField("Brand Development Support Type").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Brand Development Support Type").ControlsRow.className = SPUtility.GetSPField("Brand Development Support Type").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("User Experience");
                                                                                SPUtility.GetSPField("User Experience").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("User Experience").ControlsRow.className = SPUtility.GetSPField("User Experience").ControlsRow.className.replace("noShow", "");

                                                                                if (SPUtility.GetSPField("Brand Development Support Type").GetValue().indexOf("Packaging") > -1) {
                                                                                    SPUtility.ShowSPField("Portfolio");
                                                                                    SPUtility.GetSPField("Portfolio").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Portfolio").ControlsRow.className = SPUtility.GetSPField("Portfolio").ControlsRow.className.replace("noShow", "");

                                                                                    SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Show();
                                                                                    SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').ControlsRow.className = SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').ControlsRow.className.replace("noShow", "");

                                                                                }
                                                                                SPUtility.ShowSPField("Brand Identify Offer Category");
                                                                                SPUtility.GetSPField("Brand Identify Offer Category").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Brand Identify Offer Category").ControlsRow.className = SPUtility.GetSPField("Brand Identify Offer Category").ControlsRow.className.replace("noShow", "");

                                                                                if (!isIMC) {
                                                                                    SPUtility.HideSPField("IMC Deliverables");
                                                                                    SPUtility.GetSPField("IMC Deliverables").Label.attr("Hiding", true);
                                                                                    SPUtility.GetSPField("IMC Deliverables").ControlsRow.className = "noShow";

                                                                                }

                                                                            }

                                                                            if (spfLaunchTypeValue == 'Fios TV Channel Changes') {
                                                                                SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Is this a dark launch?").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField('Is this a dark launch?');
                                                                                //SPUtility.HideSPField('If Project requires IT release (ER or CR) enter date');
                                                                                //SPUtility.HideSPField('Eligible Transactions');
                                                                                //SPUtility.HideSPField('Business Objectives / KPIs'); -- #780; removed on 7/21/20
                                                                                SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("IT or CAM Contacts").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("IT or CAM Contacts").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Pricing").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Pricing").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField('Clarity/Jira/Ref ID or URL link to project');
                                                                                //SPUtility.HideSPField('IT or CAM Contacts');
                                                                                //SPUtility.HideSPField("Pricing");
                                                                                //SPUtility.HideSPField("SKU");
                                                                                //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");	
                                                                                $("input[id^='Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_']").prop("checked", "");
                                                                                $("input[id='Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_9']").prop("checked", "checked");
                                                                                $("input[id='Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_10']").prop("checked", "checked");
                                                                                $("input[id='Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_11']").prop("checked", "checked");
                                                                                $("input[id^='Market_x0020_Availability_b871875c-c1bc-4367-9850-80f496496d90_MultiChoiceOption_']").prop("checked", "");
                                                                                $("input[id='Market_x0020_Availability_b871875c-c1bc-4367-9850-80f496496d90_MultiChoiceOption_4']").prop("checked", "checked");
                                                                                $(".ms-RadioText[title='Home'] :radio").prop("checked", "true");
                                                                            }

                                                                            if (isPMO) {//SPUtility.ShowSPField("Will this project require Digital PMO support?");
                                                                            //SPUtility.GetSPField("Will this project require Digital PMO support?").Label.attr("Hiding", false);
                                                                            //SPUtility.GetSPField("Will this project require Digital PMO support?").ControlsRow.className = SPUtility.GetSPField("Will this project require Digital PMO support?").ControlsRow.className.replace("noShow", "");

                                                                            }
                                                                            if (isFWAPMO) {//SPUtility.ShowSPField("Project Workstream");
                                                                            //SPUtility.GetSPField("Project Workstream").Label.attr("Hiding", false);
                                                                            //SPUtility.GetSPField("Project Workstream").ControlsRow.className = SPUtility.GetSPField("Project Workstream").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("Capital Cost");
                                                                            //SPUtility.GetSPField("Capital Cost").Label.attr("Hiding", false);
                                                                            //SPUtility.GetSPField("Capital Cost").ControlsRow.className = SPUtility.GetSPField("Capital Cost").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("Annual Expense");
                                                                            //SPUtility.GetSPField("Annual Expense").Label.attr("Hiding", false);
                                                                            //SPUtility.GetSPField("Annual Expense").ControlsRow.className = SPUtility.GetSPField("Annual Expense").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("Technical Product Development Sizing");
                                                                            //SPUtility.GetSPField("Technical Product Development Sizing").Label.attr("Hiding", false);
                                                                            //SPUtility.GetSPField("Technical Product Development Sizing").ControlsRow.className = SPUtility.GetSPField("Technical Product Development Sizing").ControlsRow.className.replace("noShow", "");

                                                                            }
                                                                            /*if (isPMO || isIMC)
		{
			SPUtility.ShowSPField('Requires Branding Engagement');
			//SPUtility.ShowSPField('Target Customers');
			//SPUtility.ShowSPField('Customer Personas');
			//SPUtility.ShowSPField('Customer Segments');
			//SPUtility.ShowSPField('Target Competition');
		}
		else
		{
			SPUtility.HideSPField('Requires Branding Engagement');
			//SPUtility.HideSPField('Target Customers');
			//SPUtility.HideSPField('Customer Personas');
			//SPUtility.HideSPField('Customer Segments');
			//SPUtility.HideSPField('Target Competition');
		}*/
                                                                            if (spfLaunchTypeValue == 'Accessory') {
                                                                                SPUtility.ShowSPField("SKU");
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = SPUtility.GetSPField("SKU").ControlsRow.className.replace("noShow", "");

                                                                                //SPUtility.ShowSPField("Verizon Exclusive?");
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className = SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className.replace("noShow", "");

                                                                                //SPUtility.ShowSPField("Accessory Retail Price");
                                                                                SPUtility.ShowSPField("Accessory Type");
                                                                                SPUtility.GetSPField("Accessory Type").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Accessory Type").ControlsRow.className = SPUtility.GetSPField("Accessory Type").ControlsRow.className.replace("noShow", "");

                                                                                console.log("device oem accessory");
                                                                                SPUtility.ShowSPField("Device OEM");
                                                                                SPUtility.GetSPField("Device OEM").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Device OEM").ControlsRow.className = SPUtility.GetSPField("Device OEM").ControlsRow.className.replace("noShow", "");

                                                                            } else if (spfLaunchTypeValue == 'Campaign or Contest') {
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField("SKU");
                                                                            } else if (spfLaunchTypeValue == 'Device') {
                                                                                showDeviceLaunchType();
                                                                                //SPUtility.ShowSPField("Verizon Exclusive?");
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className = SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className.replace("noShow", "");

                                                                                if (isGTM) {//SPUtility.ShowSPField('Plan/Payment Type');
                                                                                //SPUtility.GetSPField("Plan/Payment Type").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className = SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className.replace("noShow", "");
                                                                                }

                                                                                console.log("device oem device");
                                                                                SPUtility.ShowSPField("Device OEM");
                                                                                SPUtility.GetSPField("Device OEM").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Device OEM").ControlsRow.className = SPUtility.GetSPField("Device OEM").ControlsRow.className.replace("noShow", "");
                                                                            } else if (spfLaunchTypeValue == 'Application, Product or Service') {
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField("SKU");
                                                                                //SPUtility.ShowSPField("Verizon Exclusive?");
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className = SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className.replace("noShow", "");
                                                                                //SPUtility.ShowSPField("Product or Service Type");

                                                                                if (isGTM) {//SPUtility.ShowSPField('Plan/Payment Type');
                                                                                //SPUtility.GetSPField("Plan/Payment Type").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className = SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className.replace("noShow", "");
                                                                                }
                                                                            } else if (spfLaunchTypeValue == 'Price Plan') {
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField("SKU");
                                                                                //SPUtility.ShowSPField("Price Plan Type");
                                                                            } else if (spfLaunchTypeValue == 'Promotion') {
                                                                                showPromotionLaunchType();
                                                                                //SPUtility.ShowSPField("Verizon Exclusive?");
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className = SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className.replace("noShow", "");

                                                                                if (isGTM) {//SPUtility.ShowSPField('Plan/Payment Type');
                                                                                //SPUtility.GetSPField("Plan/Payment Type").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className = SPUtility.GetSPField("Plan/Payment Type").ControlsRow.className.replace("noShow", "");
                                                                                }
                                                                            } else if (spfLaunchTypeValue == 'Local Marketing') {
                                                                                if (isGTM) {
                                                                                    SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                }
                                                                            }

                                                                            // 11/28/18; 12/03/18
                                                                            if (spfLaunchTypeValue != prevLaunchType) {
                                                                                if (spfLaunchTypeValue == 'Promotion' || spfLaunchTypeValue == 'Device' || spfLaunchTypeValue == 'Accessory')
                                                                                    fnPopulateSpecialCallOuts(spfLaunchTypeValue);
                                                                                else
                                                                                    fnPopulateSpecialCallOuts("");
                                                                                //prevLaunchType = spfLaunchTypeValue;  -- DO THIS ONLY FOR PRODUCTION ISSUE, we don't want to clear out existing value						
                                                                            }
                                                                            if (!isGTM) {
                                                                                console.log("gtm hiding");
                                                                                hideRows(gtmRowIndex - 2, salesOpsRowIndex - 1);
                                                                            } else {
                                                                                console.log("gtm row show");
                                                                                console.log("gtm row index" + gtmRowIndex);
                                                                                console.log("sales ops row index" + salesOpsRowIndex);
                                                                                if (isEditForm) {
                                                                                    showRows(gtmRowIndex - 1, salesOpsRowIndex - 4);
                                                                                }
                                                                            }

                                                                            if (!isIMC && !isBrand) {
                                                                                console.log("imc hiding");
                                                                                hideRows(imRowIndex - 1, gtmRowIndex - 2);
                                                                                SPUtility.GetSPField("PMO").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("PMO").Label.attr("Hiding", true);
                                                                            } else {
                                                                                console.log("imc showing");
                                                                                showRows(imRowIndex - 3, gtmRowIndex);
                                                                                SPUtility.GetSPField("PMO").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("PMO").Label.attr("Hiding", true);
                                                                            }

                                                                            if (!isSalesOps) {
                                                                                console.log("hiding sales ops rows");
                                                                                if (isEditForm) {
                                                                                    var SalesOpsRowGrab = SPUtility.GetSPField("SALES OPS");
                                                                                    var DigitalOpsRowGrab = SPUtility.GetSPField("DIGITAL OPERATIONS");

                                                                                    hideRows($(SalesOpsRowGrab).closest('tr').prevObject[0].ControlsRow.sectionRowIndex, $(DigitalOpsRowGrab).closest('tr').prevObject[0].ControlsRow.sectionRowIndex);
                                                                                } else {
                                                                                    hideRows(salesOpsRowIndex, digitalOpsRowIndex);
                                                                                }
                                                                            } else {
                                                                                console.log("showing sales ops rows");
                                                                                showRows(salesOpsRowIndex - 1, digitalOpsRowIndex);
                                                                            }

                                                                            // Aug 2017 - prepopulate fields if launch type is AGENDA - NO LONGER NEEDED 3/11/2020
                                                                            /*if (spfLaunchTypeValue == 'AGENDA')
		{
			if (isNewForm)
				fnPopulateAgenda();		
			isAgenda = true;
			if (isEditForm)
			{
				fnHideNonMarketActivity();
				showRows(adminRowIndex-1, saveAsDraftRowIndex);
			}
		}*/
                                                                        }
                                                                        ;

                                                                        fnFormatManagingChannel = function() {
                                                                            /* NO LONGER NEED Color coded 08/14/2020
		$("select[id^='isB2B_6c5d4d6a'] > option").each(function()
		{
		  if ( this.text == "B2B ONLY" )
		  {
			$(this).addClass("blue");
		  }
		  if ( this.text == "Ops ONLY" || this.text == "BT OPS ONLY")
		  {
			$(this).addClass("purple");
		  }
		  if ( this.text == "PNB ONLY" || this.text == "Media Co. / Telematics Only")
		  {
			$(this).addClass("green");
		  }
		  if ( this.text == "CRM ONLY" )
		  {
			$(this).addClass("pink");
		  }
		  
		});*/
                                                                            origManagingChannel = SPUtility.GetSPField("Managing Channel").GetValue();

                                                                        }
                                                                        ;

                                                                        fnMarketAvailability = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            var spfMarketAvailability = SPUtility.GetSPField("Area Availability");
                                                                            var spfMarketAvailabilityValue = spfMarketAvailability.GetValue();
                                                                            SPUtility.GetSPField("Local Market").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Local Market").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField('Local Market');
                                                                            //SPUtility.HideSPField('Local State');
                                                                            // clear out East/South/West if Local Only is selected
                                                                            if (spfMarketAvailabilityValue.length == 1 && spfMarketAvailabilityValue[0] == "Local Only") {
                                                                                SPUtility.ShowSPField('Local Market');
                                                                                SPUtility.GetSPField("Local Market").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Local Market").ControlsRow.className = SPUtility.GetSPField("Local Market").ControlsRow.className.replace("noShow", "");

                                                                                //if (isGTM || isSalesOps || isPromo)
                                                                                //SPUtility.ShowSPField('Local State');
                                                                                return;
                                                                            }

                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            // 07/27/20 - no longer need this
                                                                            /*var id = $(".ms-RadioText[title='All Mobile Areas'] :checkbox")[0].id;
		var otherids = (id).substring(0, (id).length-1 );
		var idno =(id).substring( (id).length-1, (id).length );
		idno = parseInt(idno);
		
		for (i = 0; i < 3; i++)
		{
			idno = idno + 1;
			newid = otherids + idno;
			if (!$("input[id^='"+newid+"']").prop("checked"))
			{
				$(".ms-RadioText[title='All Mobile Areas'] :checkbox").prop("checked" ,"");
				break;
			}
		}
		if (i == 3)  // all chidlren checkboxes were checked, add the ALL back
		{
			$(".ms-RadioText[title='All Mobile Areas'] :checkbox").prop("checked" ,"checked");
			$(".ms-RadioText[title='Local Only'] :checkbox").prop("checked" ,"");
		}
		*/
                                                                            for (i = 0; i < spfMarketAvailabilityValue.length; i++) {
                                                                                if (spfMarketAvailabilityValue[i] == 'All Mobile Areas') // || spfMarketAvailabilityValue[i] == 'East' || spfMarketAvailabilityValue[i] == 'South' || spfMarketAvailabilityValue[i] == 'West')
                                                                                {
                                                                                    SPUtility.GetSPField("Local Market").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("Local Market").Label.attr("Hiding", true);
                                                                                    //SPUtility.HideSPField('Local Market');
                                                                                    //SPUtility.HideSPField('Local State');
                                                                                    $(".ms-RadioText[title='Local Only'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                                if (spfMarketAvailabilityValue[i] == 'Local Only') {
                                                                                    SPUtility.ShowSPField('Local Market');
                                                                                    SPUtility.GetSPField("Local Market").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Local Market").ControlsRow.className = SPUtility.GetSPField("Local Market").ControlsRow.className.replace("noShow", "");

                                                                                    //if (isGTM || isSalesOps || isPromo)
                                                                                    //SPUtility.ShowSPField('Local State');
                                                                                }
                                                                            }

                                                                            if (spfMarketAvailabilityValue.length == 0) {
                                                                                SPUtility.GetSPField("Local Market").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Local Market").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField('Local Market');
                                                                                //SPUtility.HideSPField('Local State');
                                                                            }
                                                                        }
                                                                        ;

                                                                        /*	fn5G = function(){
		if (isPMOOnly)
			return;
		var is5G = SPUtility.GetSPField("5G").GetValue();
		if (is5G == "Yes")
			SPUtility.ShowSPField('5G City');
		else
			SPUtility.HideSPField('5G City');
	
	};
*/

                                                                        fnNationalRetailers = function() {
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var id = $(".ms-RadioText[title='All Retailers'] :checkbox")[0].id;
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var idno = (id).substring((id).length - 1, (id).length);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = parseInt(idno);

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Retailers'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Retailers'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        fnStrategicSales = function(event) {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked

                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            var otherids = "";
                                                                            if (idno < 10)
                                                                                otherids = (id).substring(0, (id).length - 1);
                                                                            else
                                                                                otherids = (id).substring(0, (id).length - 2);

                                                                            if (idno == 11)
                                                                                // this is 5G Residential, do not do anything
                                                                                return;

                                                                            for (i = 0; i < 10; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='ALL Fios Strategic Sales'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == 10) // all chidlren checkboxes were checked, add the ALL back
                                                                            {
                                                                                $(".ms-RadioText[title='ALL Fios Strategic Sales'] :checkbox").prop("checked", "checked");
                                                                            }
                                                                        }
                                                                        ;

                                                                        /*fnStrategicEpic = function(){
		if (isDisplayForm) return;
		var spfStrategicEpicValue = SPUtility.GetSPField("Is this a Strategic Epic?").GetValue();	
		SPUtility.HideSPField('Strategic Concept: New Features');
		SPUtility.HideSPField('Strategic Concept: Value Statement');
		SPUtility.HideSPField('Strategic Epic: Security Questionnaire');

		if (spfStrategicEpicValue == "Yes")
		{
			SPUtility.ShowSPField('Strategic Concept: New Features');
			SPUtility.ShowSPField('Strategic Concept: Value Statement');
			SPUtility.ShowSPField('Strategic Epic: Security Questionnaire');					
		}
	}*/
                                                                        //1/4/2017 - Mtg: Mkt Rls is now Mtg: Mkt Rls

                                                                        fnPopulateMeetingDates = function() {
                                                                            if (origManagingChannel == "") // LL - comment this out for now so that I can do the testing
                                                                            {

                                                                                var monday = new Date();
                                                                                var today = new Date();
                                                                                var day = monday.getDay() || 7;
                                                                                // Get current day number, converting Sun. to 7
                                                                                var year, month;

                                                                                var submissionDate = new Date(SPUtility.GetSPField("Project Submission Date").GetValue());
                                                                                /*var assignedDate = new Date(SPUtility.GetSPField("Priority Assigned Date").GetValue());
			if (assignedDate == null)
				assignedDate = today; */
                                                                                var launchDate = new Date(SPUtility.GetSPField("Launch Date").GetValue());
                                                                                var priorityLevel = SPUtility.GetSPField("Priority Level").GetValue();
                                                                                var submissionDay = submissionDate.getDay();
                                                                                var priorityReviewDate = new Date();
                                                                                //var priorityReviewDate = new Date(submissionDate.next().tuesday());
                                                                                if (submissionDate.is().tuesday())
                                                                                    priorityReviewDate = submissionDate;
                                                                                else
                                                                                    priorityReviewDate = new Date(submissionDate.tuesday());
                                                                                var COODate = new Date(priorityReviewDate);
                                                                                COODate.next().monday();
                                                                                var thursdayDate = new Date(priorityReviewDate);
                                                                                if (!thursdayDate.is().thursday())
                                                                                    thursdayDate = addDays(thursdayDate.next().thursday(), -7);
                                                                                if (thursdayDate < priorityReviewDate)
                                                                                    thursdayDate = addDays(thursdayDate, 7);
                                                                                var tyskDate = new Date(priorityReviewDate);
                                                                                if (!tyskDate.is().wednesday())
                                                                                    tyskDate = addDays(tyskDate.next().wednesday(), -7);
                                                                                if (tyskDate < priorityReviewDate)
                                                                                    tyskDate = addDays(tyskDate, 7);

                                                                                var wednesdayDate = new Date(launchDate);
                                                                                if (!wednesdayDate.is().wednesday())
                                                                                    wednesdayDate = addDays(wednesdayDate.wednesday(), -7);

                                                                                var firstWednesday = new Date(wednesdayDate);
                                                                                var secondWednesday = addDays(firstWednesday, -7);
                                                                                var thirdWednesday = addDays(firstWednesday, -14);

                                                                                var marketLeaderDate = new Date(launchDate);
                                                                                var firstMonday;
                                                                                if (marketLeaderDate.is().monday())
                                                                                    firstMonday = marketLeaderDate;
                                                                                else
                                                                                    firstMonday = addDays(marketLeaderDate.monday(), -7);
                                                                                var secondMonday = addDays(firstMonday, -7);
                                                                                var thirdMonday = addDays(firstMonday, -14);
                                                                                var fourthMonday = addDays(firstMonday, -21);

                                                                                if (day !== 1) {
                                                                                    // Only manipulate the date if it isn't Mon.
                                                                                    monday.setHours(-24 * (day - 1));
                                                                                    // Set the hours to day number minus 1
                                                                                }
                                                                                monday.setHours(0, 0, 0, 0);

                                                                                var tempDate = new Date(SPUtility.GetSPField("Launch Date").GetValue());
                                                                                var firstThursday = tempDate;
                                                                                if (!tempDate.is().thursday())
                                                                                    firstThursday = new Date(tempDate.next().thursday());
                                                                                var secondThursday = addDays(firstThursday, -7);
                                                                                var thirdThursday = addDays(firstThursday, -14);
                                                                                var fourthThursday = addDays(firstThursday, -21);
                                                                                var fifthThursday = addDays(firstThursday, -28);

                                                                                // new logic for Mkt rls date
                                                                                var fridayDate = new Date(launchDate);
                                                                                if (!fridayDate.is().friday())
                                                                                    fridayDate = addDays(fridayDate.friday(), -7);

                                                                                var firstFriday = new Date(fridayDate);
                                                                                var secondFriday = addDays(firstFriday, -7);
                                                                                var thirdFriday = addDays(firstFriday, -14);

                                                                                var managingChannel = SPUtility.GetSPField("Managing Channel").GetValue();
                                                                                var populatedDate = new Date();
                                                                                SPUtility.GetSPField("Mtg: Pri Rvw").SetValue(null);
                                                                                //SPUtility.GetSPField("TYSK/SII5 Due (W)").SetValue(null);	
                                                                                //SPUtility.GetSPField("Mtg: Mkt Rls").SetValue(null);
                                                                                //SPUtility.GetSPField("Mtg: Consumer Staff").SetValue(null);
                                                                                //SPUtility.GetSPField("Mtg: Executive GTM").SetValue(null);
                                                                                //SPUtility.GetSPField("GTM Deck Availability Date").SetValue(null);
                                                                                //SPUtility.GetSPField("Mtg: GTM VP").SetValue(null);

                                                                                if (managingChannel == "GTM") // Used to be Consumer
                                                                                {
                                                                                    if (priorityReviewDate <= launchDate)
                                                                                        populatedDate = priorityReviewDate;
                                                                                    else
                                                                                        populatedDate = today;
                                                                                    month = populatedDate.getMonth() + 1;
                                                                                    //months from 1-12
                                                                                    day = populatedDate.getDate();
                                                                                    year = populatedDate.getFullYear();
                                                                                    SPUtility.GetSPField("Mtg: Pri Rvw").SetValue(year, month, day);

                                                                                    if (COODate <= launchDate && priorityLevel != "4") //skip  && COODate >= today
                                                                                    {
                                                                                        populatedDate = COODate;
                                                                                        month = populatedDate.getMonth() + 1;
                                                                                        //months from 1-12
                                                                                        day = populatedDate.getDate();
                                                                                        year = populatedDate.getFullYear();
                                                                                        //SPUtility.GetSPField("Mtg: Consumer Staff").SetValue(year, month, day);
                                                                                    }
                                                                                    //else
                                                                                    //SPUtility.GetSPField("Mtg: Consumer Staff").SetValue(null);
                                                                                    // TYSK is now due on Wednesday, not Thursday
                                                                                    //if (thursdayDate <= launchDate)  // skip  && thursdayDate >= today
                                                                                    if (tyskDate <= launchDate && priorityLevel != "4") // skip  && thursdayDate >= today
                                                                                    {
                                                                                        populatedDate = tyskDate;
                                                                                        month = populatedDate.getMonth() + 1;
                                                                                        //months from 1-12
                                                                                        day = populatedDate.getDate();
                                                                                        year = populatedDate.getFullYear();
                                                                                        //SPUtility.GetSPField("TYSK/SII5 Due (W)").SetValue(year, month, day);
                                                                                    }
                                                                                    if (thirdMonday > today)
                                                                                        populatedDate = thirdMonday;
                                                                                    else if (secondMonday > today)
                                                                                        populatedDate = secondMonday;
                                                                                    else if (firstMonday > today)
                                                                                        populatedDate = firstMonday;
                                                                                    else
                                                                                        populatedDate = null;

                                                                                    if (populatedDate != null) {
                                                                                        month = populatedDate.getMonth() + 1;
                                                                                        //months from 1-12
                                                                                        day = populatedDate.getDate();
                                                                                        year = populatedDate.getFullYear();
                                                                                    }

                                                                                    if (fourthMonday > today)
                                                                                        populatedDate = fourthMonday;
                                                                                    else if (thirdMonday > today)
                                                                                        populatedDate = thirdMonday;
                                                                                    else if (secondMonday > today)
                                                                                        populatedDate = secondMonday;
                                                                                    else if (firstMonday > today)
                                                                                        populatedDate = firstMonday;
                                                                                    else
                                                                                        populatedDate = null;
                                                                                    if (populatedDate != null) {
                                                                                        month = populatedDate.getMonth() + 1;
                                                                                        //months from 1-12
                                                                                        day = populatedDate.getDate();
                                                                                        year = populatedDate.getFullYear();
                                                                                        var hour = 8;
                                                                                        var minute = 0;
                                                                                    }

                                                                                    if (fifthThursday > today)
                                                                                        populatedDate = fifthThursday;
                                                                                    else if (fourthThursday > today)
                                                                                        populatedDate = fourthThursday;
                                                                                    else if (thirdThursday > today)
                                                                                        populatedDate = thirdThursday;
                                                                                    else if (secondThursday > today)
                                                                                        populatedDate = secondThursday;
                                                                                    else if (firstThursday > today)
                                                                                        populatedDate = firstThursday;
                                                                                    else
                                                                                        populatedDate = null;
                                                                                    if (populatedDate != null) {
                                                                                        month = populatedDate.getMonth() + 1;
                                                                                        //months from 1-12
                                                                                        day = populatedDate.getDate();
                                                                                        year = populatedDate.getFullYear();
                                                                                    }
                                                                                } else if (managingChannel == "PNBI" || managingChannel == "B2B" || managingChannel == "Ops" || managingChannel == "Bus. Trans" || managingChannel == "Ops Bus. Trans" || managingChannel == "Media Co. / Telematics") {
                                                                                    if (priorityReviewDate <= launchDate)
                                                                                        populatedDate = priorityReviewDate;
                                                                                    else
                                                                                        populatedDate = today;
                                                                                    month = populatedDate.getMonth() + 1;
                                                                                    //months from 1-12
                                                                                    day = populatedDate.getDate();
                                                                                    year = populatedDate.getFullYear();
                                                                                    SPUtility.GetSPField("Mtg: Pri Rvw").SetValue(year, month, day);
                                                                                }
                                                                            }
                                                                        }
                                                                        ;

                                                                        fnPricePlan = function() {

                                                                            var spfLaunchType = SPUtility.GetSPField("Launch Type");
                                                                            var spfLaunchTypeValue = spfLaunchType.GetValue();

                                                                            if (spfLaunchTypeValue !== 'Price Plan')
                                                                                return;

                                                                            var spfPricePlanLaunchType = SPUtility.GetSPField("Price Plan Launch Type");
                                                                            //SPUtility.HideSPField('Add Stackable Promotion Details');
                                                                            //SPUtility.HideSPField('Promotion Implementation');
                                                                            //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                            if (spfPricePlanLaunchType.GetValue() == 'Change to Existing Price Plan') {//SPUtility.HideSPField("Promo End Date");
                                                                            //SPUtility.HideSPField("Should external material created for this promotion reflect Promotion Promo End Date or Limited Time Only?");
                                                                            } else if (spfPricePlanLaunchType.GetValue() == 'Price Plan Promo') {
                                                                                //SPUtility.ShowSPField("Promo End Date");
                                                                                //SPUtility.ShowSPField("Should external material created for this promotion reflect Promotion Promo End Date or Limited Time Only?");
                                                                                fnPromoDetail();
                                                                            }
                                                                        }
                                                                        ;

                                                                        fnPriorityLevel = function() {
                                                                            //08/24/21 - set Calendar to Checcked for  P4
                                                                            //08/05/18 - set Appendex to checked for P3 and P4
                                                                            $(".ms-RadioText[title='Calendar Only'] :checkbox").prop("checked", "");
                                                                            if (SPUtility.GetSPField("Priority Level").GetValue() == "3" || SPUtility.GetSPField("Priority Level").GetValue() == "4") {
                                                                                $(".ms-RadioText[title='Appendix Only'] :checkbox").prop("checked", "checked");
                                                                                if (SPUtility.GetSPField("Priority Level").GetValue() == "4")
                                                                                    $(".ms-RadioText[title='Calendar Only'] :checkbox").prop("checked", "checked");
                                                                            } else {
                                                                                $(".ms-RadioText[title='Appendix Only'] :checkbox").prop("checked", "");
                                                                            }
                                                                        }
                                                                        ;

                                                                        fnPromoType = function() {
                                                                            fnPromoDetail();
                                                                        }
                                                                        ;

                                                                        fnPromoDetail = function() {
                                                                            var spfLaunchTypeValue = SPUtility.GetSPField("Launch Type").GetValue();
                                                                            if (spfLaunchTypeValue == 'Other') {
                                                                                //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField("SKU");
                                                                            }
                                                                            else {
                                                                                if (spfLaunchTypeValue == 'Accessory') {
                                                                                    //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                    console.log("device oem accessory 2");
                                                                                    SPUtility.ShowSPField("Device OEM");
                                                                                    SPUtility.GetSPField("Device OEM").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Device OEM").ControlsRow.className = SPUtility.GetSPField("Device OEM").ControlsRow.className.replace("noShow", "");
                                                                                } else if (spfLaunchTypeValue == 'Campaign or Contest') {
                                                                                    SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                    //SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className = "noShow";
                                                                                    //SPUtility.GetSPField("Verizon Exclusive?").Label.attr("Hiding", true);

                                                                                    //SPUtility.HideSPField("Verizon Exclusive?");
                                                                                    //SPUtility.HideSPField("SKU");
                                                                                    //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                } else if (spfLaunchTypeValue == 'Device') {
                                                                                    //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                    console.log("device oem device 2");
                                                                                    SPUtility.ShowSPField("Device OEM");
                                                                                    SPUtility.GetSPField("Device OEM").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Device OEM").ControlsRow.className = SPUtility.GetSPField("Device OEM").ControlsRow.className.replace("noShow", "");

                                                                                } else if (spfLaunchTypeValue == 'Application, Product or Service') {
                                                                                    //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                    SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                    //SPUtility.HideSPField("SKU");
                                                                                } else if (spfLaunchTypeValue == 'Other') {
                                                                                    //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                    SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("SKU").Label.attr("Hiding", true);

                                                                                    //SPUtility.HideSPField("SKU");
                                                                                }
                                                                            }
                                                                            var spfPromoTypeValue = SPUtility.GetSPField("Promotion Type").GetValue();
                                                                            if (spfPromoTypeValue == "Accessory Promo") {
                                                                                //SPUtility.ShowSPField("Accessory Sale Price");
                                                                                //SPUtility.ShowSPField("Accessory Retail Price");
                                                                                SPUtility.ShowSPField("Accessory Type");
                                                                                SPUtility.GetSPField("Accessory Type").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Accessory Type").ControlsRow.className = SPUtility.GetSPField("Accessory Type").ControlsRow.className.replace("noShow", "");

                                                                            } else {
                                                                                //SPUtility.HideSPField("Accessory Sale Price");
                                                                                //SPUtility.HideSPField("Accessory Retail Price");
                                                                                SPUtility.GetSPField("Accessory Type").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Accessory Type").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField("Accessory Type");
                                                                            }

                                                                            if (spfLaunchTypeValue == "Promotion") {
                                                                                if (spfPromoTypeValue == "Accessory Promo" || spfPromoTypeValue == "Tablets/Connected Device Promo" || spfPromoTypeValue == "Phone Promo") {
                                                                                    console.log("device oem multi");
                                                                                    SPUtility.ShowSPField("Device OEM");
                                                                                    SPUtility.GetSPField("Device OEM").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Device OEM").ControlsRow.className = SPUtility.GetSPField("Device OEM").ControlsRow.className.replace("noShow", "");

                                                                                } else {
                                                                                    SPUtility.GetSPField("Accessory Type").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("Accessory Type").Label.attr("Hiding", true);
                                                                                    SPUtility.ShowSPField("Device OEM");
                                                                                    SPUtility.GetSPField("Device OEM").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("Device OEM").Label.attr("Hiding", true);
                                                                                }
                                                                            }
                                                                        }
                                                                        ;

                                                                        // 11/28/18
                                                                        fnPopulateSpecialCallOuts = function(launchType) {

                                                                            var systemTargetDetailTextArea = $("div[id^='Special_x0020_Call_x0020_Outs']");
                                                                            var htmlTemplate = "";
                                                                            if (launchType == 'Device')
                                                                                htmlTemplate = '<table class="ms-rteTable-default" style="width: 100%; border-collapse: collapse; table-layout: fixed;" border="1" width="830px" cellspacing="0" cellpadding="0"><colgroup><col style="width: 60pt;" width="60" /><col style="width: 60pt;" span="10" /></colgroup><tbody><tr><td class="greycellleftheaderbold" colspan="11">Pricing/SKU</td></tr><tr><td class="whitecellheaderboldcenter">Verizon<br />Exclusive</td><td class="whitecellheaderboldcenter">SKU</td><td class="whitecellheaderboldcenter">Name</td><td class="whitecellheaderboldcenter">Color</td><td class="whitecellheaderboldcenter">Inventory<br />Outlook</td><td class="whitecellheaderboldcenter">Retail Price</td><td class="whitecellheaderboldcenter">DPP</td><td class="whitecellheaderboldcenter">2 Year</td><td class="whitecellheaderboldcenter">1 Year</td><td class="whitecellheaderboldcenter">COGS</td><td class="whitecellheaderboldcenter">Connected<br />Device?</td></tr><tr><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td class="whitecell">(Other)</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr></tbody></table>';
                                                                            else if (launchType == 'Promotion')
                                                                                htmlTemplate = '<table class="ms-rteTable-default" style="width: 100%; border-collapse: collapse; table-layout: fixed;" border="1" width="800px" cellspacing="0" cellpadding="0"><colgroup><col style="width: 60pt;" width="60" /><col style="width: 60pt;" span="9" /></colgroup><tbody><tr><td class="greycellleftheaderbold" colspan="10">Pricing/SKU</td></tr><tr><td class="whitecellheaderboldcenter">SKU</td><td class="whitecellheaderboldcenter">Name</td><td class="whitecellheaderboldcenter">Color</td><td class="whitecellheaderboldcenter">Inventory<br />Outlook</td><td class="whitecellheaderboldcenter">Retail Price</td><td class="whitecellheaderboldcenter">Discount</td><td class="whitecellheaderboldcenter">Discount<br/>Applied<br/>(Retail)</td><td class="whitecellheaderboldcenter">Discount<br/>Applied<br/>(indirect)</td><td class="whitecellheaderboldcenter">Consumer<br/>Final<br/>Cost</td><td class="whitecellheaderboldcenter">Employee<br />Discount</td></tr><tr><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td class="whitecell">(Other)</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr></tbody></table>';
                                                                            else if (launchType == 'Accessory')
                                                                                htmlTemplate = '<table class="ms-rteTable-default" style="width: 100%; border-collapse: collapse; table-layout: fixed;" border="1" width="800px" cellspacing="0" cellpadding="0"><colgroup><col style="width: 60pt;" width="60" /><col style="width: 60pt;" span="5" /></colgroup><tbody><tr><td class="greycellleftheaderbold" colspan="6">Pricing/SKU</td></tr><tr><td class="whitecellheaderboldcenter">Verizon<br />Exclusive</td><td class="whitecellheaderboldcenter">SKU</td><td class="whitecellheaderboldcenter">Name</td><td class="whitecellheaderboldcenter">Color</td><td class="whitecellheaderboldcenter">Inventory<br />Outlook</td><td class="whitecellheaderboldcenter">Retail Price</td></tr><tr><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td class="whitecell">(Other)</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr></tbody></table>';
                                                                            if ($(systemTargetDetailTextArea).length == 3)
                                                                                $(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
                                                                        }
                                                                        ;

                                                                        fnPopulateTargetDetail = function() {
                                                                            // change title to appropriate name once it's added to the dynamic brief
                                                                            var systemTargetDetailTextArea = $("div[id^='Quarterly_x0020_Target']");
                                                                            var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><colgroup><col width="60" style="width: 60pt;"></col><col span="4" style="width: 60pt;"></col></colgroup><tbody><tr><td colspan="5" class="greycellleftheaderbold">Overall Revenue Targets</td></tr><tr><td class="whitecellheaderboldcenter"></td><td class="whitecellheaderboldcenter">Q1</td><td class="whitecellheaderboldcenter">Q2</td><td class="whitecellheaderboldcenter">Q3</td><td class="whitecellheaderboldcenter">Q4</td></tr> <tr><td class="whitecellheaderbold">Year 1</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td class="whitecellheaderbold">Year 2</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td class="whitecellheaderbold">Year 3</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td colspan="5" class="greycellleftheaderbold">Year 1 Segment Targets</td></tr><tr ><td></td><td class="whitecellheaderboldcenter">Q1</td><td class="whitecellheaderboldcenter">Q2</td><td class="whitecellheaderboldcenter">Q3</td><td class="whitecellheaderboldcenter">Q4</td></tr><tr><td class="whitecellheaderbold">Enterprise</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td class="whitecellheaderbold">Fed/Gov</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td class="whitecellheaderbold">SMB</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td colspan="5" class="greycellleftheaderbold">Additional targets</td></tr><tr><td class="whitecellheaderbold">Open rates</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td class="whitecellheaderbold">Attendance</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr><tr><td class="whitecellbold">(Other)</td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td><td class="whitecell"></td></tr></tbody></table>';
                                                                            if ($(systemTargetDetailTextArea).length == 3)
                                                                                $(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;

                                                                        }
                                                                        ;

                                                                        function fnPopulateVerizonBenefit() {
                                                                            var systemTargetDetailTextArea = $("div[id^='Why_x0020_is_x0020_this_x0020_la']");
                                                                            var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><tbody><tr><td class="greycellheader" width="400px">Customer Benefits</td><td class="greycellheader" width="400px">Verizon Benefits</td></tr><tr><td class="whitecellleft">&nbsp;</td><td class="whitecellleft">&nbsp;</td></tr></tbody></table>';
                                                                            if ($(systemTargetDetailTextArea).length == 3)
                                                                                $(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
                                                                        }

                                                                        /*function fnPopulateVZWJustification()
	{
		var systemTargetDetailTextArea = $("div[id^='VZW_x002e_com_x002F_Business_x00']");	
		var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><tbody><tr><td class="greycellheader" colspan="2">VZW.com/Business or VES.com Justification:</td></tr><tr><td width="150px" class="whitecellleftheader">If B2B specific web channels were selected, what is the one primary action we want visitors to take when they visit this page?</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellleftheader">How does the web deliverable contribute to the overall objective above?</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellleftheader">What media, if any, will help drive traffic to the page(s)?</td><td class="whitecellleft">&nbsp;</td></tr></tbody></table>';
		if ($(systemTargetDetailTextArea).length == 3)
			$(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
	}*/

                                                                        /*function fnPopulateCustomerExperience()
	{
		var systemTargetDetailTextArea = $("div[id^='Customer_x0020_Experience']");	
		var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><col width=150><col width=200><col width=450><tbody><tr><td class="greycellheader" colspan="3">Customer Experience Journey</td></tr><tr><td class="whitecellheaderbold">Learn&nbsp;</td><td width="200px" class="whitecellheader">Describe how a customer or employee would find easy to understand information about your project.</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheaderbold">Buy</td><td class="whitecellheader">Explain how the purchase experience is easy and transparent for the customer and employee across all channels.</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheaderbold">Get and set up&nbsp;</td><td class="whitecellheader">Discuss how the customer receives their order and whether setup is intuitive enough where assistance is not required.&nbsp;</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheaderbold">Use&nbsp;</td><td class="whitecellheader">State how the product/service is easy to use and whether instructions are easily accessible across all digital and physical channels.&nbsp;</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheaderbold">Bill and pay&nbsp;</td><td class="whitecellheader">Describe how the customer&rsquo;s bill is impacted as a result of their purchase/transaction and whether it is explained simply.&nbsp;&nbsp;</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheaderbold">Get help</td><td class="whitecellheader">In the event that a customer experiences difficulty, list out their support options and how the employee can provide first touch resolution.&nbsp;</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheaderbold">Stay or leave</td><td class="whitecellheader">For a customer wanting to leave Verizon, discuss whether tools are available to drive retention or if the service disconnect process is easy to complete.&nbsp;</td><td class="whitecellleft">&nbsp;</td></tr></tbody></table>';
		if ($(systemTargetDetailTextArea).length == 3)
			$(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
	}*/

                                                                        function fnPopulatePromotionApplied() {
                                                                            var systemTargetDetailTextArea = $("div[id^='How_x0020_is_x0020_the_x0020_Pro']");
                                                                            var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><tbody><tr><td class="greycellheader" colspan="3">Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types</td></tr><tr><td width="100ox" class="whitecellleftheader">How is Promo redeemed?</td><td class="whitecellleft" colspan="2">&nbsp;</td></tr><tr><td class="whitecellleftheader">Stackability?</td><td class="whitecellleft" colspan="2">&nbsp;</td></tr></tbody></table>';
                                                                            if ($(systemTargetDetailTextArea).length == 3)
                                                                                $(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
                                                                        }

                                                                        function fnPopulateEligiblePricePlan() {
                                                                            var systemTargetDetailTextArea = $("div[id^='Price_x0020_Plan_x0020_Details']");
                                                                            var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><tbody><tr><td class="greycellheader" width="400">Eligible</td><td class="greycellheader" width="400">Ineligible</td></tr><tr><td class="whitecellleft">&nbsp;</td><td class="whitecellleft">&nbsp;</td></tr></tbody></table>';
                                                                            if ($(systemTargetDetailTextArea).length == 3)
                                                                                $(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
                                                                        }

                                                                        /*function fnPopulateStackablePromotion()
	{
		var systemTargetDetailTextArea = $("div[id^='Add_x0020_Stackable_x0020_Promot']");	
		var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><col width=150><col width=330><col width=320><tbody><tr><td colspan="3" class="greycellheader">Add Stackable Promotion Details</td></tr><tr><td width="140px">&nbsp;</td><td width="330px" class="whitecellheaderbold" style="text-align:center">Stackable</td><td width="330px" class="whitecellheaderbold" style="text-align:center">NON Stackable</td></tr><tr><td class="whitecellheader">List or Name other promos</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td class="whitecellheader">or directly add links</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr></tbody></table>';	
		if ($(systemTargetDetailTextArea).length == 3)
			$(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
	}*/

                                                                        /*
	function fnPopulateDifferentiators()
	{
		var systemTargetDetailTextArea = $("div[id^='Differentiators']");	
		var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" lass="ms-rteTable-default"><tbody><tr><td colspan="2" class="greycellheader">What makes your project unique?</td></tr><tr><td class="whitecellheader">What makes this "New" News?</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheader">What about this product is differentiated and ownable?</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheader">List any complementary products, services or accessories that will be available at launch</td><td class="whitecellleft">&nbsp;</td></tr><tr><td width="188" class="whitecellheader">Why can\'t our competitors say the same thing?</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheader">Why is our product better?</td><td class="whitecellleft">&nbsp;</td></tr><tr><td width="188"  class="whitecellheader">What is the appeal (take rate, etc.)</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheader">Describe any unique features or benefits?</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellheader">How do those features/benefits compare?</td><td class="whitecellleft">&nbsp;</td></tr></tbody></table>';
		if ($(systemTargetDetailTextArea).length == 3)
			$(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
	} */

                                                                        /*function fnPopulatePillarDetail()
	{
		var systemTargetDetailTextArea = $("div[id^='Pillar_x0020_Detail']");	
		var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><col width=150><col width=650><tbody><tr><td colspan="2" class="greycellheader">Pillar Detail</td></tr><tr><td class="whitecellleftheader">Pillar Name</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellleftheader">Pillar Priority No.</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellleftheader">Epic Name</td><td class="whitecellleft">&nbsp;</td></tr><tr><td class="whitecellleftheader">Jira User Story ID</td><td class="whitecellleft">&nbsp;</td></tr></tbody></table>';
		if ($(systemTargetDetailTextArea).length == 3)
			$(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
	}*/

                                                                        function fnPopulateInternalCommDeliverable() {
                                                                            var systemTargetDetailTextArea = $("div[id^='IC_x0020_Deliverable_x0020_Type']");
                                                                            var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%; border-collapse: collapse; table-layout: fixed;" class="ms-rteTable-default"><tbody><tr><td colspan=2>&nbsp;</td><td colspan="5" class="whitecellheaderboldcenter">Deliverable Sub-channel (if applicable)</td></tr><tr><td class="whitecellheadercenter">Deliverable Date</td><td class="whitecellheadercenter">Deliverable Type</td><td class="whitecellheadercenter">Retail</td><td class="whitecellheadercenter">Retail (Union)</td><td class="whitecellheadercenter">B2B</td><td class="whitecellheadercenter">Customer Service</td><td class="whitecellheadercenter">Telesales</td></tr><tr><td>&nbsp;</td><td class="greycellleftheader">mySmartboard</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td>&nbsp;</td><td class="greycellleftheader">Target Vision</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td>&nbsp;</td><td class="greycellleftheader">Ecard</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td>&nbsp;</td><td class="greycellleftheader">Smartboard</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td>&nbsp;</td><td class="greycellleftheader">Smartboard Ticker</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td>&nbsp;</td><td class="greycellleftheader">Info2Go</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td>&nbsp;</td><td>Other 1 (rename)</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr><tr><td>&nbsp;</td><td>Other 2 (rename)</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td><td class="whitecell">&nbsp;</td></tr></tbody></table>';
                                                                            if ($(systemTargetDetailTextArea).length == 3)
                                                                                $(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
                                                                        }

                                                                        function fnPopulatePositioning() {
                                                                            var systemTargetDetailTextArea = $("div[id^='Additional_x0020_Comments']");
                                                                            var htmlTemplate = '<table width="800px" border="1" cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;table-layout:fixed;" class="ms-rteTable-default"><col width=150><col width=650><tbody><tr><td colspan="2"class="greycellheader">GTM Team Provided Positioning Statements</td></tr><tr><td class="whitecellheaderbold">Customer Speaking</td><td>&nbsp;</td></tr><tr><td class="whitecellheaderbold">Rep Speaking</td><td>&nbsp;</td></tr><tr><td class="whitecellheaderbold">Last Edited by:</td><td>&nbsp;</td></tr></tbody></table>';
                                                                            if ($(systemTargetDetailTextArea).length == 3)
                                                                                $(systemTargetDetailTextArea)[2].innerHTML = htmlTemplate;
                                                                        }

                                                                        fnRetailChannel = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            var spfLaunchType = SPUtility.GetSPField("Launch Type");
                                                                            var spfLaunchTypeValue = spfLaunchType.GetValue();
                                                                            //var spfRetailChannel=SPUtility.GetSPField("Retail Stores");    
                                                                            //var spfRetailChannelValue = spfRetailChannel.GetValue();
                                                                            //SPUtility.HideSPField('Trial Locations');	

                                                                            /*if (spfRetailChannelValue.length == 0 || SPUtility.GetSPField("Channel Availability").GetValue() == "N/A")
	  	{
			SPUtility.HideSPField('Trial Locations');
			return;
		}*/

                                                                            // clear out Other Retails if Local Only is selected
                                                                            /*if (spfRetailChannelValue.length == 1 && spfRetailChannelValue[0] == "Retail (Select Trial Locations)")
		{
			SPUtility.ShowSPField('Trial Locations');
			return;
		}*/
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            //var id = $(".ms-RadioText[title='Retail (ALL)'] :checkbox")[0].id;
                                                                            //var otherids = (id).substring(0, (id).length-1 );
                                                                            //var idno =(id).substring( (id).length-1, (id).length );
                                                                            //idno = parseInt(idno);

                                                                            /*for (i = 0; i < 2; i++)
		{
			idno = idno + 1;
			newid = otherids + idno;
			if (!$("input[id^='"+newid+"']").prop("checked"))
			{
				$(".ms-RadioText[title='Retail (ALL)'] :checkbox").prop("checked" ,"");
				break;
			}
		}
		if (i == 2)  // all chidlren checkboxes were checked, add the ALL back
		{
			$(".ms-RadioText[title='Retail (ALL)'] :checkbox").prop("checked" ,"checked");
			//$(".ms-RadioText[title='Retail (Select Trial Locations)'] :checkbox").prop("checked" ,"");
		}*/
                                                                            /*for (i = 0; i < spfRetailChannelValue.length; i++)
		{
			if ( spfRetailChannelValue[i] == 'Retail (Select Trial Locations)' )
			{
				//SPUtility.ShowSPField('Trial Locations');
			} 
		}*/
                                                                            //if (spfRetailChannelValue.length == 0 || SPUtility.GetSPField("Channel Availability").GetValue() == "N/A")
                                                                            //	SPUtility.HideSPField('Trial Locations');
                                                                        }
                                                                        ;

                                                                        fnSegmentEligibility = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var id = $(".ms-RadioText[title='All Customer Segments'] :checkbox")[0].id;
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var idno = (id).substring((id).length - 1, (id).length);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = parseInt(idno);

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Customer Segments'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Customer Segments'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        fnTargetCustomers = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var id = $(".ms-RadioText[title='All Target Customers'] :checkbox")[0].id;
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var idno = (id).substring((id).length - 1, (id).length);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = parseInt(idno);

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Target Customers'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Target Customers'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        fnCustomerPersonas = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var id = $(".ms-RadioText[title='All Customer Personas'] :checkbox")[0].id;
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var idno = (id).substring((id).length - 1, (id).length);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = parseInt(idno);

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Customer Personas'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Customer Personas'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        fnCustomerSegments = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var id = $(".ms-RadioText[title='All Customer Segments'] :checkbox")[0].id;
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var idno = (id).substring((id).length - 1, (id).length);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = parseInt(idno);

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Customer Segments'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Customer Segments'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        fnTargetCompetition = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var id = $(".ms-RadioText[title='All Target Competition'] :checkbox")[0].id;
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var idno = (id).substring((id).length - 1, (id).length);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = parseInt(idno);

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='All Target Competition'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='All Target Competition'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        fnPartner = function(event) {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            var otherids = "";
                                                                            if (idno < 10)
                                                                                otherids = (id).substring(0, (id).length - 1);
                                                                            else
                                                                                otherids = (id).substring(0, (id).length - 2);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            var lastid = otherids + totalcount;
                                                                            id = otherids + totalcount;
                                                                            if (idno == totalcount) // this is N/A
                                                                            {
                                                                                for (i = 0; i < totalcount; i++) {
                                                                                    newid = otherids + i;
                                                                                    $("input[id='" + newid + "']").prop("checked", "");
                                                                                }
                                                                                SPUtility.GetSPField("Partner Participation Details").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Partner Participation Details").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField('Partner Participation Details');
                                                                                return;
                                                                            }

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                newid = otherids + i;
                                                                                if ($("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $("input[id^='" + lastid + "']").prop("checked", "");
                                                                                    SPUtility.ShowSPField("Partner Participation Details");
                                                                                    SPUtility.GetSPField("Partner Participation Details").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Partner Participation Details").ControlsRow.className = SPUtility.GetSPField("Partner Participation Details").ControlsRow.className.replace("noShow", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                        }
                                                                        ;

                                                                        function fnBrandDevelopment() {
                                                                            if (!isBrand)
                                                                                return;
                                                                            if (SPUtility.GetSPField("Brand Development Support Type").GetValue().indexOf('Packaging') > -1) {
                                                                                SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Show();
                                                                                SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Label.attr("Hiding", false);
                                                                                SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').ControlsRow.className = SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField('Portfolio');
                                                                                SPUtility.GetSPField("Portfolio").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Portfolio").ControlsRow.className = SPUtility.GetSPField("Portfolio").ControlsRow.className.replace("noShow", "");

                                                                            } else {
                                                                                SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Hide();
                                                                                SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').Label.attr("Hiding", true);
                                                                                SPUtility.GetSPField("Portfolio").ControlsRow.className = "noShow";
                                                                                //SPUtility.HideSPField('Portfolio');
                                                                            }

                                                                        }

                                                                        function fnSalesOpsSupportType() {//SPUtility.HideSPField('Sales Ops Support Type Requested');
                                                                        //SPUtility.HideSPField('Business Area Expertise Needed');
                                                                        //SPUtility.HideSPField('Communications Publish Date Requested');
                                                                        //SPUtility.HideSPField('Currently Prioritized with Portfolio Team?');		
                                                                        // Sales ops removal
                                                                        //if (SPUtility.GetSPField("Sales Ops Support Type").GetValue() == "Communication Request Only")
                                                                        //{
                                                                        //SPUtility.ShowSPField('Communications Publish Date Requested');
                                                                        //}
                                                                        //else if (SPUtility.GetSPField("Sales Ops Support Type").GetValue() == "Full National Sales Ops Support")
                                                                        //{
                                                                        //SPUtility.ShowSPField('Sales Ops Support Type Requested');
                                                                        //SPUtility.ShowSPField('Business Area Expertise Needed');
                                                                        //SPUtility.ShowSPField('Currently Prioritized with Portfolio Team?');
                                                                        //}
                                                                        }
                                                                        /*
	function fnSupportModel(){
		var spfSupportModel=SPUtility.GetSPField("Is there a specialized support model for your solution that needs integration into GTM launch?");
		if ( spfSupportModel.GetValue() == 'Yes')
		  {
		  	SPUtility.ShowSPField("Support Model Details");
		  }
		else 
		{
			SPUtility.HideSPField("Support Model Details");
		}
	}	*/
                                                                        // ==============function to hide other launch types============

                                                                        function hideApplicationLaunchType() {
                                                                            //SPUtility.HideSPField("Application, Product or Service Launch Type");
                                                                            SPUtility.ShowSPField("SKU");
                                                                            SPUtility.GetSPField("SKU").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("SKU").ControlsRow.className = SPUtility.GetSPField("SKU").ControlsRow.className.replace("noShow", "");
                                                                        }

                                                                        function hideCampaignLaunchType() {//SPUtility.HideSPField("Campaign or Contest Launch Type");
                                                                        //SPUtility.ShowSPField("Competitive Landscape");
                                                                        }

                                                                        function hideDeviceLaunchType() {
                                                                            //SPUtility.HideSPField("Payment Options");
                                                                            //SPUtility.HideSPField("Device Type");
                                                                            SPUtility.GetSPField("Device Type").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Device Type").Label.attr("Hiding", true);

                                                                        }
                                                                        function hidePricePlanLaunchType() {
                                                                            SPUtility.HideSPField("Price Plan Launch Type");
                                                                            SPUtility.GetSPField("Price Plan Launch Type").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Price Plan Launch Type").ControlsRow.className = "noShow";
                                                                        }

                                                                        function hidePromotionLaunchType() {
                                                                            //SPUtility.HideSPField("Promotion Launch Type");
                                                                            //SPUtility.HideSPField("Eligible Agreement Type");
                                                                            //SPUtility.HideSPField("Inventory Outlook");
                                                                            //SPUtility.HideSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                            //SPUtility.GetSPField("Marketing ID").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Marketing ID").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Promotion Type").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Promotion Type").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Device OEM").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Device OEM").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Marketing ID");
                                                                            //SPUtility.HideSPField("Promotion Type");
                                                                            //SPUtility.HideSPField("Device OEM");
                                                                        }

                                                                        function hideRows(startRow, endRow) {
                                                                            if (isNewForm && isHQSuperAdmin && isAgenda)
                                                                                return false;
                                                                            var innerHTML = "";
                                                                            $('.ms-formtable tr').each(function(index) {
                                                                                rowIndex = this.rowIndex;
                                                                                //if (($(this).context.rowIndex > startRow) && ($(this).context.rowIndex < endRow))
                                                                                innerHTML = $(this)[0].innerHTML;
                                                                                if (rowIndex > startRow && rowIndex < endRow && innerHTML.indexOf("Support_x0020_Team") == -1) // do not remove Support Team Values
                                                                                {
                                                                                    $(this).addClass("noShow");
                                                                                }
                                                                                if (rowIndex >= endRow)
                                                                                    return false;
                                                                            });
                                                                        }

                                                                        String.prototype.replaceAll = function(str1, str2, ignore) {
                                                                            return this.replace(new RegExp(str1.replace(/([\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g, function(c) {
                                                                                return "\\" + c;
                                                                            }),"g" + (ignore ? "i" : "")), str2);
                                                                        }
                                                                        ;

                                                                        function showApplicationLaunchType() {
                                                                            //if (isGTM)
                                                                            {
                                                                                SPUtility.GetSPField("Application, Product or Service Launch Type").ControlsRow.className = SPUtility.GetSPField("Application, Product or Service Launch Type").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("Application, Product or Service Launch Type").Label.attr("Hiding", false);
                                                                                SPUtility.ShowSPField("Application, Product or Service Launch Type");

                                                                                SPUtility.GetSPField("Pricing").ControlsRow.className = SPUtility.GetSPField("Pricing").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("Pricing").Label.attr("Hiding", false);
                                                                                SPUtility.ShowSPField("Pricing");

                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("SKU");
                                                                                fnApplicationLaunchType();
                                                                                fnPromoDetail();
                                                                            }
                                                                        }

                                                                        function showCampaignLaunchType() {
                                                                            //if (isGTM)
                                                                            {
                                                                                SPUtility.ShowSPField("Pricing");
                                                                                SPUtility.GetSPField("Pricing").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Pricing").ControlsRow.className = SPUtility.GetSPField("Pricing").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("SKU");
                                                                                fnCampaignEnhancements();
                                                                            }
                                                                        }

                                                                        function showDeviceLaunchType() {
                                                                            if (isGTM) {
                                                                                //SPUtility.ShowSPField("Payment Options");
                                                                                SPUtility.ShowSPField("SKU");
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = SPUtility.GetSPField("SKU").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Device Type");
                                                                                SPUtility.GetSPField("Device Type").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Device Type").ControlsRow.className = SPUtility.GetSPField("Device Type").ControlsRow.className.replace("noShow", "");

                                                                                //SPUtility.ShowSPField("Inventory Outlook");
                                                                            }
                                                                        }

                                                                        function showGeneralInformationFields() {
                                                                            SPUtility.ShowSPField("Project Name");
                                                                            SPUtility.GetSPField("Project Name").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Project Name").ControlsRow.className = SPUtility.GetSPField("Project Name").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Project Description/Top 5 Selling Features");
                                                                            SPUtility.GetSPField("Project Description/Top 5 Selling Features").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Project Description/Top 5 Selling Features").ControlsRow.className = SPUtility.GetSPField("Project Description/Top 5 Selling Features").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.GetSPField("Project Submission Date").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Project Submission Date").Label.attr("Hiding", true);
                                                                            //SPUtility.HideSPField("Project Submission Date");
                                                                            SPUtility.ShowSPField("Launch Date");
                                                                            SPUtility.GetSPField("Launch Date").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Launch Date").ControlsRow.className = SPUtility.GetSPField("Launch Date").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Is this a dark launch?");
                                                                            SPUtility.GetSPField("Is this a dark launch?").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className = SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Project Lead");
                                                                            SPUtility.GetSPField("Project Lead").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Project Lead").ControlsRow.className = SPUtility.GetSPField("Project Lead").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Approving Executive Sponsor");
                                                                            SPUtility.GetSPField("Approving Executive Sponsor").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Approving Executive Sponsor").ControlsRow.className = SPUtility.GetSPField("Approving Executive Sponsor").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Approving Legal Contacts");
                                                                            SPUtility.GetSPField("Approving Legal Contacts").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Approving Legal Contacts").ControlsRow.className = SPUtility.GetSPField("Approving Legal Contacts").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Launch Type");
                                                                            SPUtility.GetSPField("Laumch Type").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Launch Type").ControlsRow.className = SPUtility.GetSPField("Launch Type").ControlsRow.className.replace("noShow", "");
                                                                            //SPUtility.ShowSPField('Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types');

                                                                            fnProjectDetail();
                                                                            fnLaunchType();
                                                                        }

                                                                        function showPricePlanLaunchType() {
                                                                            //if (isGTM)
                                                                            {
                                                                                SPUtility.ShowSPField("Price Plan Launch Type");
                                                                                SPUtility.GetSPField("Price Plan Launch Type").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Price Plan Launch Type").ControlsRow.className = SPUtility.GetSPField("Price Plan Launch Type").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Pricing");
                                                                                SPUtility.GetSPField("Pricing").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Pricing").ControlsRow.className = SPUtility.GetSPField("Launch Type").ControlsRow.className.replace("noShow", "");

                                                                                //SPUtility.GetSPField("Verizon Exclusive?").ControlsRow.className = "noShow";
                                                                                //SPUtility.GetSPField("Verizon Exclusive?").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                                //SPUtility.HideSPField("Verizon Exclusive?");
                                                                                //SPUtility.HideSPField("SKU");
                                                                                fnPricePlan();
                                                                            }
                                                                        }

                                                                        function showPromotionLaunchType() {
                                                                            //if (isGTM)
                                                                            {
                                                                                //SPUtility.ShowSPField("Promotion Launch Type");
                                                                                SPUtility.ShowSPField("Pricing");
                                                                                SPUtility.GetSPField("Pricing").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Pricing").ControlsRow.className = SPUtility.GetSPField("Pricing").ControlsRow.className.replace("noShow", "");

                                                                                //SPUtility.ShowSPField('Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types');
                                                                                //SPUtility.ShowSPField("Eligible Agreement Type");
                                                                                //SPUtility.ShowSPField("Inventory Outlook");
                                                                                //SPUtility.ShowSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");
                                                                                //SPUtility.ShowSPField("Marketing ID");
                                                                                //SPUtility.GetSPField("Marketing ID").Label.attr("Hiding", false);
                                                                                //SPUtility.GetSPField("Marketing ID").ControlsRow.className = SPUtility.GetSPField("Marketing ID").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Promotion Type");
                                                                                SPUtility.GetSPField("Promotion Type").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Promotion Type").ControlsRow.className = SPUtility.GetSPField("Promotion Type").ControlsRow.className.replace("noShow", "");

                                                                                console.log("device oem show promo launch");
                                                                                SPUtility.ShowSPField("Device OEM");
                                                                                SPUtility.GetSPField("Device OEM").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Device OEM").ControlsRow.className = SPUtility.GetSPField("Device OEM").ControlsRow.className.replace("noShow", "");

                                                                                //if (SPUtility.GetSPField("Promotion Type").GetValue() == "Accessory Promo")
                                                                                //SPUtility.HideSPField("Accessory Sale Price");
                                                                                //else
                                                                                //SPUtility.HideSPField("Accessory Sale Price");
                                                                                SPUtility.GetSPField("SKU").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("SKU").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("SKU");
                                                                                fnPromoType();
                                                                            }
                                                                        }

                                                                        function showRows(startRow, endRow) {
                                                                            var isShowing = true;
                                                                            $('.ms-formtable').find("tr").each(function(index) {
                                                                                if ($(this).prevAll("tr").length > startRow && $(this).prevAll("tr").length < endRow) {
                                                                                    //console.log('Row index is ' + $(this).prevAll("tr").length + ',' + $(this).context.innerText);
                                                                                    isShowing = true;
                                                                                    $(this).children("td").each(function() {
                                                                                        var $td = $(this);
                                                                                        //if ($td.context.style.display == "none") {  // no longer working
                                                                                        if ($td[0].getAttribute('hiding') == "true") {
                                                                                            isShowing = false;
                                                                                            return false;
                                                                                            // Breaks `each` loop
                                                                                        }
                                                                                    });
                                                                                    if (isShowing) {
                                                                                        $(this).removeClass("noShow");
                                                                                    }
                                                                                }
                                                                            });
                                                                        }
                                                                        //======================override sharePoint form submit
                                                                        function PreSaveAction() {
                                                                            // rehide admin fields just in case we're in newform mode
                                                                            if (isNewForm) {
                                                                                console.log("running presave admin field hide");
                                                                                hideAdmin();
                                                                                hideRows(adminRowIndex - 1, saveAsDraftRowIndex);
                                                                                SPUtility.GetSPField("Project Submission Date").SetValue(null);
                                                                            }
                                                                            $("#Error").html("").append("");
                                                                            var requiredFields = [];
                                                                            SPUtility.GetSPField("Title").SetValue(SPUtility.GetSPField("Project Name").GetValue());
                                                                            var formattedDate = new Date().format('MM/dd/yyyy');
                                                                            //expand all sections just in case we have any required fields that were hidden
                                                                            preSave = true;
                                                                            if (isMarketLaunch == '')
                                                                                $(".general-img-swap").click();

                                                                            /*if (SPUtility.GetSPField("Support Team(s)").GetValue().length == 0)
		{
			$("input[id^='Support_x0020_Team']").focus();			
			alert ("Support Team(s) is required");
			return false;
		}

		if (SPUtility.GetSPField("Project Submission Date").GetValue().Year == null)
		{
			if (SPUtility.GetSPField("Launch Date").GetValue().Year == null)
			{
				$("input[id^='Launch_x0020_Date']").focus();			
				alert ("Launch Date is required");
				return false;
			}
		}*/

                                                                            // if save as draft, we can ignore all requirement fields for now.
                                                                            spfSaveAsDraft = SPUtility.GetSPField("Save as draft?");
                                                                            if (SPUtility.GetSPField("Channel Availability").GetValue().length == 0) {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Channel Availability");
                                                                            } else {
                                                                                if (SPUtility.GetSPField("Channel Availability").GetValue().indexOf("Indirect National Retail") != -1) {
                                                                                    if (SPUtility.GetSPField("National Retailers").GetValue().length == 0) {
                                                                                        $("input[id^='National_x0020_Retailers']").focus();
                                                                                        alert("National Retailers is required for Indirect National Retail");
                                                                                        return false;
                                                                                    }
                                                                                }
                                                                            }

                                                                            if (spfSaveAsDraft.GetValue() == "Yes") {
                                                                                //populate all blank input fields with "DRAFT"
                                                                                $('.ms-formtable input').each(function(index) {
                                                                                    //title = $(this).context.title;
                                                                                    title = $(this)[0].outerHTML;
                                                                                    if (title.indexOf("Required Field") !== -1) {
                                                                                        if ($(this)[0].value == "") {
                                                                                            if (title.indexOf("Launch Date") != -1)
                                                                                                $(this)[0].value = formattedDate;
                                                                                            else if (title.indexOf("Project Lead") != 0)
                                                                                                $(this)[0].value = "DRAFT";
                                                                                        }
                                                                                    }
                                                                                });

                                                                                $('.ms-formtable textarea').each(function(index) {
                                                                                    //title = $(this).context.title;
                                                                                    title = $(this)[0].outerHTML;
                                                                                    if (title.indexOf("Required Field") !== -1) {
                                                                                        if ($(this)[0].value == "") {
                                                                                            $(this)[0].value = "DRAFT";
                                                                                        }
                                                                                    }
                                                                                });

                                                                                SPUtility.GetSPField("Project Submission Date").SetValue(null);
                                                                                clearHeaderLabels();
                                                                                return true;
                                                                            }
                                                                            //else ___ REMOVED ON 5/12/20 - TURNING THIS OFF won't allow users to correct mistakes
                                                                            //	SPUtility.HideSPField("Save as draft?");	// #707 - hide Save as draft after initial submission

                                                                            //display Admin section only if the brief is not submitted for the first time.
                                                                            if (SPUtility.GetSPField("Project Submission Date").GetValue().Year != null) {
                                                                                if (isAdmin)
                                                                                    $(".admin-img-swap").click();
                                                                            }

                                                                            var isRequiredFieldEntered = true;
                                                                            $('.ms-formtable input').each(function(index) {
                                                                                //title = $(this).context.title;
                                                                                title = $(this)[0].outerHTML;
                                                                                if (title.indexOf("Required Field") !== -1) {
                                                                                    if (title.indexOf("Project Lead") != 0) // Project Lead is a people column, can't test for .value here
                                                                                    {
                                                                                        if ($(this)[0].value == "DRAFT" || $(this)[0].value == "") {
                                                                                            isRequiredFieldEntered = false;
                                                                                            //requiredFields.push(title);
                                                                                            //return false; // Breaks `each` loop
                                                                                        }
                                                                                    }
                                                                                }
                                                                            });
                                                                            if (SPUtility.GetSPField("Support Team(s)").GetValue().length == 0) {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Support Team(s)");
                                                                            }

                                                                            if (SPUtility.GetSPField("Project Name").GetValue().length == 0) {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Project Name");
                                                                            }

                                                                            if (SPUtility.GetSPField("Project Description/Top 5 Selling Features").GetValue() == "") {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Project Description/Top 5 Selling Features");
                                                                            }

                                                                            if (SPUtility.GetSPField("Customer Primary Use Case").GetValue() == null) {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Customer Primary Use Case");
                                                                            }

                                                                            if (SPUtility.GetSPField("Launch Date").GetValue().Year == null) {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Launch Date");
                                                                            }

                                                                            if (SPUtility.GetSPField("Area Availability").GetValue().length == 0) {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Area Availability");
                                                                            }

                                                                            // IM CHANGES - Eligible Transactions is no longer a required field
                                                                            /*if (SPUtility.GetSPField("Eligible Transactions").GetValue().length == 0)
		{
			isRequiredFieldEntered = false;
			requiredFields.push("Eligible Transactions");
		}*/
                                                                            if (SPUtility.GetSPField("Save as draft?").GetValue() == null) {
                                                                                isRequiredFieldEntered = false;
                                                                                requiredFields.push("Save as draft");
                                                                            }
                                                                            /*if (spfLaunchTypeValue == 'Fios TV Channel Changes')
		{
			var businessObjective = SPUtility.GetSPField("Business Objectives / KPIs").GetValue();
			if (businessObjective == ""  || businessObjective == "<p>&#8203;</p>")
			{
				isRequiredFieldEntered = false;
				requiredFields.push("Business Objectives / KPIs");
			}	
		}*/

                                                                            if (!isRequiredFieldEntered) {
                                                                                //if (!isAdministrator) - LL 08/22.  Hide admin rows if we're submitting the brief for the first time
                                                                                if (SPUtility.GetSPField("Project Submission Date").GetValue().Year == null || isNewForm) {
                                                                                    console.log("submit brief admin row hide");
                                                                                    hideRows((adminRowIndex - 1), saveAsDraftRowIndex);
                                                                                }
                                                                                //$("#Error").html("").append("Mandatory fields not completed  check document" + "<br>" + requiredFields.toString() );
                                                                                $("#Error").html("").append("Brief was not saved!<br>Mandatory fields not completed  please check document for missing fields:" + "<br>" + requiredFields.toString());
                                                                                //alert ("Brief was not saved, mandatory fields not completed  please check document."); do not use alert, it will break the flow of presave action
                                                                                return false;
                                                                            } else {
                                                                                $("#Error").html("").append("");
                                                                            }

                                                                            // make sure all required fields are there
                                                                            if (!validateRequiredFields())
                                                                                return false;

                                                                            //compare launch date and Promo End Date	  
                                                                            var launchDate = new Date(SPUtility.GetSPField("Launch Date").GetValue());
                                                                            var promoEndDate = new Date(SPUtility.GetSPField("Promo End Date").GetValue());
                                                                            if (SPUtility.GetSPField("Project Submission Date").GetValue().Year == null) {
                                                                                var currentdate = new Date();
                                                                                var month = currentdate.getMonth() + 1;
                                                                                //months from 1-12
                                                                                var day = currentdate.getDate();
                                                                                var year = currentdate.getFullYear();
                                                                                SPUtility.GetSPField("Project Submission Date").SetValue(year, month, day);
                                                                            }

                                                                            var thisItemId = GetUrlKeyValue("ID", false, location.href)

                                                                            if (promoEndDate < launchDate) {
                                                                                $("input[id^='Promotional_x0020_Timeframe_x0030_4a84327e-bf28-4db6-9e75-d22fcb099c4f_']").focus();
                                                                                alert("Promo End Date must be later than Launch Date");
                                                                                return false;
                                                                            }
                                                                            // replace empty paragraph in keypoint

                                                                            var spfKeyPoint = SPUtility.GetSPField("Key Points");
                                                                            var regex1 = new RegExp("<p> </p>",'g');
                                                                            var regex2 = new RegExp("<p>&#160;</p>",'g');

                                                                            var regex3 = new RegExp("\\cK",'g');
                                                                            // this is an invliad character copied by Dan Murphy

                                                                            spfKeyPoint.SetValue(spfKeyPoint.GetValue().replace(regex1, ''));
                                                                            spfKeyPoint.SetValue(spfKeyPoint.GetValue().replace(regex2, ''));
                                                                            spfKeyPoint.SetValue(spfKeyPoint.GetValue().replace(regex3, ''));

                                                                            //check valid number in child sequence number

                                                                            if (SPUtility.GetSPField("Child Sequence No").GetValue() != "" && parseInt(SPUtility.GetSPField("Child Sequence No").GetValue()) == "NaN") {
                                                                                $("input[id^='Child_x0020_Sequence_']").focus();
                                                                                alert("Please enter a numeric value in Child Sequence No");
                                                                                return false;
                                                                            } else {
                                                                                seqno = SPUtility.GetSPField("Child Sequence No").GetValue();
                                                                                seqno = (seqno < 10 ? '0' : '') + seqno;
                                                                                //SPUtility.GetSPField("Child Sequence No").SetValue(seqno); this does not help, number is still stored with 1 digit
                                                                            }

                                                                            //var listname = "GTM 2016 Project Briefs";
                                                                            //var url = "https://esites.vzbi.com/sites/HQ_GTM";
                                                                            //var item="?$filter=ID eq " + thisItemId;

                                                                            //SPGetListItems(url, listname,item);
                                                                            // update Parent field if launch date and or project name is modified
                                                                            if (SPUtility.GetSPField("Launch Date").GetValue().Year != null && SPUtility.GetSPField("Launch Date (Hidden)").GetValue().Year != null) {
                                                                                var launchDate = new Date(SPUtility.GetSPField("Launch Date").GetValue()).format('MM/dd/yyyy');
                                                                                var hiddenLaunchDate = new Date(SPUtility.GetSPField("Launch Date (Hidden)").GetValue()).format('MM/dd/yyyy');
                                                                                // the following logic does not work in subsite since look up columns points to GTM Dynamic brief.  Need to test launch date change in real site when deploy
                                                                                //var projectName = SPUtility.GetSPField("Project Name").GetValue()

                                                                                /*if ((launchDate != hiddenLaunchDate || projectName != prevProjectName) && (!isIntegratedMarketing))
		{
			updateChildBrief();  //turm this on for production --- 08.20.19 - remove
		}*/

                                                                            }

                                                                            //05/18/2020 - remove sales ops only if it was turned on by mistake
                                                                            /*if (isPMO || isGTM || isCRM || isDigitalOps || isIMC || isBrand ||isPromo)
	{
		$(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").prop('checked', false);
		console.log("turn off Sales Operations Only in preSave");
	}*/
                                                                            // generate deliverables for Field comm
                                                                            // COMMENT THIS OUT when we're ready for production
                                                                            //generateDeliverables(ID);

                                                                            var launchType = SPUtility.GetSPField("Launch Type").GetValue();
                                                                            var managingChannel = SPUtility.GetSPField("Managing Channel").GetValue();
                                                                            calendarOnly = SPUtility.GetSPField("Calendar Only").GetValue();
                                                                            if (launchType != 'AGENDA' && launchType.indexOf('Market') == -1 && managingChannel == 'GTM') // no longer needed && calendarOnly != 'Calendar Only')
                                                                            {
                                                                                var priorityLevel = SPUtility.GetSPField("Priority Level").GetValue();
                                                                                //if (prevPriority != priorityLevel && prevPriority == 'unassigned')   //priority is assigned the first time, go ahead and generate deliverables
                                                                                //	generateDeliverables(ID);
                                                                            }
                                                                            //create project library for HQ super Admin - not needed any longer
                                                                            /*if (origCreateProjectLibrary.length > 0 && isHQSuperAdmin)
	{
		createProjectLibrary();
	}*/
                                                                            preSave = false;
                                                                            clearHeaderLabels();
                                                                            // 02/23/2021 - clear out indirect title and keypoints
                                                                            if (!isIndirect) {
                                                                                SPUtility.GetSPField("Indirect Title").SetValue("");
                                                                                SPUtility.GetSPField("Indirect Key Points").SetValue("");

                                                                            }
                                                                            return true;

                                                                        }

                                                                        function clearHeaderLabels() {
                                                                            // set all values of labels to blank
                                                                            SPUtility.GetSPField("GENERAL INFORMATION").SetValue("");
                                                                            /*SPUtility.GetSPField("Project Details").SetValue("");
	    SPUtility.GetSPField("Dates").SetValue("");
	    SPUtility.GetSPField("Customer &amp; Channel Eligibility").SetValue("");	
	    SPUtility.GetSPField("Sponsors &amp; Approvals").SetValue("");*/
                                                                            SPUtility.GetSPField("GTM").SetValue("");
                                                                            SPUtility.GetSPField("INTEGRATED MARKETING").SetValue("");
                                                                            SPUtility.GetSPField("DIGITAL OPERATIONS").SetValue("");
                                                                            SPUtility.GetSPField("PMO").SetValue("");
                                                                            SPUtility.GetSPField("SALES OPS").SetValue("");

                                                                        }

                                                                        function saveAsDraft() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            var spfSaveAsDraft = SPUtility.GetSPField("Save as draft?");
                                                                            var title = "";
                                                                            if (spfSaveAsDraft.GetValue() == "No") {
                                                                                $('[name*="SaveItem"]')[1].value = "Submit";
                                                                                //reverse all "DRAFT" populated input fields 
                                                                                $('.ms-formtable input').each(function(index) {
                                                                                    //title = $(this).context.title;
                                                                                    title = $(this)[0].outerHTML;
                                                                                    if (title.indexOf("Required Field") !== -1) {
                                                                                        if ($(this)[0].value == "DRAFT") {
                                                                                            $(this)[0].value = "";
                                                                                        }
                                                                                    }
                                                                                });
                                                                                $('.ms-formtable textarea').each(function(index) {
                                                                                    //title = $(this).context.title;
                                                                                    title = $(this)[0].outerHTML;
                                                                                    if (title.indexOf("Required Field") !== -1) {
                                                                                        if ($(this)[0].value == "DRAFT") {
                                                                                            $(this)[0].value = "";
                                                                                        }
                                                                                    }
                                                                                });

                                                                            } else {
                                                                                $('[name*="SaveItem"]')[1].value = "Save";
                                                                            }
                                                                        }

                                                                        function validateRequiredFields() {
                                                                            var spfLaunchType = SPUtility.GetSPField("Launch Type");

                                                                            if (spfLaunchType.GetValue() == "Promotion") {
                                                                                if (SPUtility.GetSPField("Promo End Date").GetValue().Year == null) {
                                                                                    $("input[id^='Promotional_x0020_Timeframe_x003']").focus();
                                                                                    alert("End Date is required for Promotion Launch Type");
                                                                                    return false;
                                                                                }
                                                                                if (SPUtility.GetSPField("Promotion Type").GetValue() == "" && isGTM) {
                                                                                    $("input[id^='Promotion_x0020_Type']").focus();
                                                                                    alert("Promotion Type is required for Promotion Launch Type");
                                                                                    return false;
                                                                                }
                                                                            }

                                                                            var spfMarketAvailability = SPUtility.GetSPField("Area Availability");
                                                                            var spfMarketAvailabilityValue = spfMarketAvailability.GetValue();

                                                                            /* Local Market is no longer a required field
		for (i = 0; i < spfMarketAvailabilityValue.length; i++)
		{
		  if ( spfMarketAvailability.GetValue()[i] == 'Local Market Only')
		  {
		  	if (SPUtility.GetSPField('Local Market').GetValue().length == 0 || SPUtility.GetSPField("Local Market").GetValue() == '<p>&#8203;</p>')
			{
				$("input[id^='Region_x0020_Availability']").focus();
				alert ("Local Market is required if Local Market Only is selected");
				return false;
			}
		  } 
		}
		*/

                                                                            //if (!isNewForm && isAdministrator && isSuperAdmin && 
                                                                            if (!isNewForm && (isGTMAdmin || isSuperAdmin) && SPUtility.GetSPField("Project Submission Date").GetValue().Year != null) {
                                                                                if (isGTM) {
                                                                                    if (SPUtility.GetSPField("Managing Channel").GetValue().trim() == "") {
                                                                                        $("select[id^='isB2B_6c5d4d6a-']").focus();
                                                                                        alert('Managing Channel is required');
                                                                                        return false;
                                                                                    }
                                                                                }
                                                                            }

                                                                            if (isNewForm) {
                                                                                var spfSupportTeamsValue = SPUtility.GetSPField("Support Team(s)").GetValue();
                                                                                if (spfSupportTeamsValue.length == 1) {
                                                                                    if (spfSupportTeamsValue == 'Go To Market')
                                                                                        spfSupportTeamsValue = 'GTM';
                                                                                    else if (spfSupportTeamsValue == 'Marketing PMO Request' || spfSupportTeamsValue == 'Marketing FWA PMO Request')
                                                                                        spfSupportTeamsValue = 'PMO';
                                                                                    else if (spfSupportTeamsValue == 'Integrated Marketing Communications' || spfSupportTeamsValue == 'Brand Development')
                                                                                        spfSupportTeamsValue = 'Integrated Marketing';
                                                                                    else if (spfSupportTeamsValue == 'Sales Operations (ONLY)')
                                                                                        spfSupportTeamsValue = 'Sales Operations';
                                                                                    else if (spfSupportTeamsValue == 'Unapproved Promo Calendar')
                                                                                        spfSupportTeamsValue = 'Promo Team';
                                                                                    else if (spfSupportTeamsValue == 'Digital Resource Request')
                                                                                        spfSupportTeamsValue = 'Digital Operations';

                                                                                    else
                                                                                        spfSupportTeamsValue = '';
                                                                                    SPUtility.GetSPField("Managing Channel").SetValue(spfSupportTeamsValue);
                                                                                }
                                                                                SPUtility.GetSPField("Priority Level").SetValue("unassigned");
                                                                            }
                                                                            return true;
                                                                        }

                                                                        function fnParentChild() {
                                                                            // only let Super Admin set up parent-child relationship - allow isNCAdmin  - allow all market adminnow
                                                                            if (isSuperAdmin || isMarketAdmin || isIMCAdmin || isBrandAdmin || isSalesOpsAdmin) {
                                                                                var spfParentItemID = SPUtility.GetSPField("Parent Project ID").GetValue();
                                                                                if (spfParentItemID == "(None)") {
                                                                                    SPUtility.GetSPField("Child Sequence No").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("Child Sequence No").Label.attr("Hiding", true);
                                                                                    //SPUtility.HideSPField("Child Sequence No");
                                                                                    SPUtility.GetSPField("Child Sequence No").SetValue(0);
                                                                                    //SPUtility.GetSPField("Parent Project ID").SetValue(0);
                                                                                } else {
                                                                                    SPUtility.ShowSPField("Child Sequence No");
                                                                                    SPUtility.GetSPField("Child Sequence No").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Child Sequence No").ControlsRow.className = SPUtility.GetSPField("Child Sequence No").ControlsRow.className.replace("noShow", "");

                                                                                }

                                                                            } else {
                                                                                SPUtility.GetSPField("Parent Project ID").MakeReadOnly();
                                                                                SPUtility.GetSPField("Priority Level").MakeReadOnly();
                                                                                SPUtility.GetSPField("Child Sequence No").MakeReadOnly();
                                                                            }
                                                                        }

                                                                        function updateChildBrief() {

                                                                            //listname = "DEV Super Brief";
                                                                            listname = "GTM Dynamic Brief";
                                                                            //userId = _spPageContextInfo.userId;
                                                                            //alert("userID is" + userId);
                                                                            briefID = $.urlParam('ID');
                                                                            //url = "https://esites.vzbi.com/sites/HQ_GTM";
                                                                            url = "https://onesite.verizon.com/sites/HQ_GTM";
                                                                            query = "?$filter=startswith(Parent_x0020_ID_x0020_Sort,";
                                                                            idquery = "'" + briefID + "'";
                                                                            idparam = encodeURIComponent(idquery);
                                                                            query = query + idparam + ")&$select=ID,Launch_x0020_Date,Child_x0020_Sequence_x0020_No";
                                                                            launchDate = new Date(SPUtility.GetSPField("Launch Date").GetValue());
                                                                            SPGetListItems(url, listname, query, launchDate);
                                                                        }

                                                                        function SPGetListItems(url, listname, query, launchDate) {
                                                                            var ID = "<FieldRef Name='ID' />";

                                                                            //var viewFields = "<ViewFields>" + ID + "</ViewFields>";
                                                                            // Executing our items via an ajax request
                                                                            $.ajax({
                                                                                async: false,
                                                                                url: url + "/_api/web/lists/getbytitle('" + listname + "')/items" + query,
                                                                                //CAMLViewFields: viewFields,
                                                                                method: "GET",
                                                                                async: false,
                                                                                headers: {
                                                                                    "Accept": "application/json; odata=verbose"
                                                                                },
                                                                                success: function(data) {
                                                                                    //complete(data); // Returns JSON collection of the results
                                                                                    var stringData = JSON.stringify(data);
                                                                                    var jsonObject = JSON.parse(stringData);
                                                                                    var results = jsonObject.d.results;
                                                                                    for (i = 0; i < results.length; i++) {

                                                                                        if (results[i]["ID"] != briefID)
                                                                                            // only need to update child brief, not parent brief itself!
                                                                                            SPUpdateItem(url, listname, launchDate, results[i])
                                                                                    }
                                                                                },
                                                                                error: function(err) {
                                                                                    //failure(data);
                                                                                    alert("SPGetListItems failed with error" + JSON.stringify(err));
                                                                                }
                                                                            });
                                                                        }

                                                                        function SPPostListItems(url, listname, query, param_result) {
                                                                            var formDigest;
                                                                            //Declare the variable
                                                                            result = param_result;
                                                                            hostweburl = decodeURIComponent(getQueryStringParameter('SPHostUrl'));
                                                                            appweburl = decodeURIComponent(getQueryStringParameter('SPAppWebUrl'));
                                                                            scriptbase = hostweburl + '/_layouts/15/';
                                                                            //CharacterAnimation();
                                                                            $.getScript(scriptbase + 'SP.Runtime.js', function() {
                                                                                $.getScript(scriptbase + 'SP.js', function() {
                                                                                    $.getScript(scriptbase + 'SP.RequestExecutor.js', getFormDigest);
                                                                                });
                                                                            });
                                                                        }

                                                                        //Get  Form Digest Value
                                                                        function getFormDigest() {
                                                                            var appweburl = decodeURIComponent(getQueryStringParameter('SPAppWebUrl'));
                                                                            $.ajax({
                                                                                async: false,
                                                                                url: appweburl + "/_api/contextinfo",
                                                                                type: "POST",
                                                                                headers: {
                                                                                    "accept": "application/json;odata=verbose",
                                                                                    "contentType": "text/xml"
                                                                                },
                                                                                success: function(data) {
                                                                                    requestdigest = data;
                                                                                    var formDigest = data.d.GetContextWebInformation.FormDigestValue;
                                                                                    SPAddItem(formDigest, posturl, postlistname, result);
                                                                                },
                                                                                error: function(err) {
                                                                                    alert(JSON.stringify(err));
                                                                                }
                                                                            });
                                                                        }

                                                                        function SPUpdateItem(url, listname, launchDate, result) {
                                                                            // fetch item to make sure it's fresh]
                                                                            query = "?$filter=Id eq " + result.Id;
                                                                            //SPGetChildItem(url, listname,query); - don't need this
                                                                            var sendItem = {
                                                                                "__metadata": {
                                                                                    "type": "SP.Data.GTM_x0020_Dynamic_x0020_BriefListItem"
                                                                                }
                                                                            };

                                                                            var formatLaunchDate = GetFormattedDate(launchDate);
                                                                            var launchDateText = ID + ";#" + formatLaunchDate;
                                                                            var sendItem = {
                                                                                "__metadata": {
                                                                                    "type": "SP.Data.GTM_x0020_Dynamic_x0020_BriefListItem"
                                                                                }
                                                                            };
                                                                            sendItem['Parent_x0020_Launch_x0020_Date_x0'] = launchDateText;
                                                                            $.ajax({
                                                                                async: false,
                                                                                url: url + "/_api/web/lists/getbytitle('" + listname + "')/items(" + result.Id + ")",
                                                                                type: "POST",
                                                                                //data: JSON.stringify(sendItem),
                                                                                data: JSON.stringify({
                                                                                    '__metadata': {
                                                                                        "type": "SP.Data.GTM_x0020_Dynamic_x0020_BriefListItem"
                                                                                    },
                                                                                    //'Parent_x0020_Launch_x0020_Date_x0': launchDateText,
                                                                                    //'Parent_x0020_Launch_x0020_Date': launchDate,
                                                                                    //'Parent_x0020_Launch_x0020_Date_x': launchDate
                                                                                    'Launch_x0020_Date': result.Launch_x0020_Date,
                                                                                    'Child_x0020_Sequence_x0020_No': result.Child_x0020_Sequence_x0020_No
                                                                                }),
                                                                                headers: {
                                                                                    "Accept": "application/json;odata=verbose",
                                                                                    "content-type": "application/json; odata=verbose",
                                                                                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                                                                    "X-HTTP-Method": "MERGE",
                                                                                    "If-Match": "*"
                                                                                },
                                                                                success: function(data) {
                                                                                    console.log("SPUpdateItem ran successfully for " + result.Id);
                                                                                    //alert ("SPUpdateItem ran successfully!");
                                                                                },
                                                                                error: function(err) {
                                                                                    console.log("Error while updating parent launch date (text): " + JSON.stringify(err));
                                                                                    errormessage = "Error while updating parent launch date (text): " + JSON.stringify(err);
                                                                                    alert("Error while updating parent launch date (text)" + launchDateText + JSON.stringify(err));

                                                                                }

                                                                            });
                                                                        }

                                                                        function SPAddItem(url, listname, result) {
                                                                            $.ajax({
                                                                                url: _spPageContextInfo.webAbsoluteUrl + "/_api/contextinfo",
                                                                                method: "POST",
                                                                                headers: {
                                                                                    "Accept": "application/json; odata=verbose"
                                                                                },
                                                                                success: function(data) {
                                                                                    $('#__REQUESTDIGEST').val(data.d.GetContextWebInformation.FormDigestValue)
                                                                                },
                                                                                error: function(data, errorCode, errorMessage) {
                                                                                    alert(errorMessage)
                                                                                }
                                                                            });

                                                                            $.ajax({
                                                                                url: url + "/_api/web/lists/getbytitle('" + listname + "')/items",
                                                                                type: "POST",
                                                                                data: JSON.stringify({
                                                                                    '__metadata': {
                                                                                        'type': 'SP.List'
                                                                                    },
                                                                                    'AllowContentTypes': true,
                                                                                    'BaseTemplate': 100,
                                                                                    'ContentTypesEnabled': true,
                                                                                    'Launch_x0020_Date': result["Launch_x0020_Date"],
                                                                                    'GTM_x0020_LeadId': result["GTM_x0020_LeadId"]
                                                                                }),
                                                                                headers: {
                                                                                    "accept": "application/json;odata=verbose",
                                                                                    "content-type": "application/json;odata=verbose",
                                                                                    "X-RequestDigest": $("#__REQUESTDIGEST").val()
                                                                                },
                                                                                success: function(data) {
                                                                                    var i = 0;
                                                                                },
                                                                                error: function(data) {
                                                                                    //failure(data);
                                                                                    var i = 1;
                                                                                }
                                                                            });
                                                                        }

                                                                        function SPGetChildItem(url, listname, query) {
                                                                            //var postlistname = "GTM User Profile";
                                                                            //var posturl = "https://esites.vzbi.com/sites/HQ_GTM";
                                                                            $.ajax({
                                                                                async: false,
                                                                                url: url + "/_api/web/lists/getbytitle('" + listname + "')/items" + query,
                                                                                method: "GET",
                                                                                headers: {
                                                                                    "Accept": "application/json; odata=verbose"
                                                                                },
                                                                                success: function(data) {
                                                                                    var stringData = JSON.stringify(data);
                                                                                    var jsonObject = JSON.parse(stringData);
                                                                                    var results = jsonObject.d.results;
                                                                                },
                                                                                error: function(err) {
                                                                                    //failure(data);
                                                                                    //var i = 1;
                                                                                    console.log("SPGetChildItem failure, data is " + JSON.stringify(err));
                                                                                    alert("SPGetChildItem failure, data is " + JSON.stringify(err));
                                                                                }
                                                                            });
                                                                        }

                                                                        function GetFormattedDate(todayTime) {

                                                                            var month = format(todayTime.getMonth() + 1);
                                                                            month = (month < 10 ? '0' : '') + month;
                                                                            var day = format(todayTime.getDate());
                                                                            day = (day < 10 ? '0' : '') + day;
                                                                            var year = format(todayTime.getFullYear());
                                                                            return year + "-" + month + "-" + day + " 00:00:00";
                                                                        }

                                                                        fnB2BChannel = function(event) {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            // the following logic is to clear out the "ALL" checkbox if any of its related checkbox is unchecked
                                                                            var id = $(".ms-RadioText[title='B2B (ALL)'] :checkbox")[0].id;
                                                                            var otherids = (id).substring(0, (id).length - 1);
                                                                            var idno = (id).substring((id).length - 1, (id).length);
                                                                            var totalcount = $("input[id^='" + otherids + "']").length - 1;
                                                                            idno = parseInt(idno);

                                                                            for (i = 0; i < totalcount; i++) {
                                                                                idno = idno + 1;
                                                                                newid = otherids + idno;
                                                                                if (!$("input[id^='" + newid + "']").prop("checked")) {
                                                                                    $(".ms-RadioText[title='B2B (ALL)'] :checkbox").prop("checked", "");
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (i == totalcount)
                                                                                // all chidlren checkboxes were checked, add the ALL back
                                                                                $(".ms-RadioText[title='B2B (ALL)'] :checkbox").prop("checked", "checked");

                                                                        }
                                                                        ;

                                                                        function hideNonGTMAdmin() {
                                                                            SPUtility.GetSPField("Key Points").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Key Points").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("GTM Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Status").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Priority Level").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Priority Level").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Parent Project ID").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Parent Project ID").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("GTM Lead").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Lead").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Mtg: Pri Rvw").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Mtg: Pro Rvw").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Child Sequence No").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Child Sequence No").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Key Points");
                                                                            //SPUtility.HideSPField("GTM Status");
                                                                            //SPUtility.HideSPField("Priority Level");
                                                                            //SPUtility.HideSPField("Parent Project ID");
                                                                            //SPUtility.HideSPField("GTM Lead");
                                                                            //SPUtility.HideSPField("Mtg: Pri Rvw");
                                                                            //SPUtility.HideSPField("Mtg: Consumer Staff");
                                                                            //SPUtility.HideSPField("Mtg: Executive GTM");
                                                                            //hide all calculated fields which show up for wshat ever reason!
                                                                            //SPUtility.HideSPField("Child Sequence No");
                                                                        }

                                                                        function showAdmin() {

                                                                            //if (isGTM && (isGTMAdmin || isHQSuperAdmin))
                                                                            if (isDraft) {
                                                                                if (isMarketAdmin)
                                                                                    hideRows((adminRowIndex - 1), adminRowIndex);
                                                                                return;
                                                                            }
                                                                            if (isAdmin) {
                                                                                showRows((adminRowIndex), saveAsDraftRowIndex);
                                                                                console.log("showing marquee rows for gtm admins")
                                                                                //changed here else clause
                                                                                if (isGTM)
                                                                                    showRows((lastRowIndex + 5), lastRowIndex + 22);
                                                                                //else 
                                                                                //	hideRows(lastRowIndex+5, lastRowIndex+6);

                                                                                showLeads();
                                                                                fnForTheHome();
                                                                            } else {
                                                                                console.log("show admin hide adminrow");
                                                                                hideRows(adminRowIndex, saveAsDraftRowIndex);
                                                                                hideRows(saveAsDraftRowIndex, lastRowIndex + 1);
                                                                            }
                                                                            // This enables ost/nca for unapproved promo. If we are edit form + we are isPromo lets show OST/NCA
                                                                            if (isEditForm && isPromo) {
                                                                                SPUtility.GetSPField("OST/NCA").ControlsRow.className = SPUtility.GetSPField("OST/NCA").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("OST/NCA").Label.attr("Hiding", false);
                                                                                SPUtility.ShowSPField("OST/NCA");
                                                                            }

                                                                            SPUtility.GetSPField("Save as draft?").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Save as draft?").Label.attr("Hiding", true);
                                                                            //SPUtility.HideSPField("Save as draft?");	// #707 - hide Save as draft after initial submission
                                                                        }

                                                                        function hideAdmin() {
                                                                            SPUtility.GetSPField("Key Points").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Key Points").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("GTM Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Status").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Priority Level").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Priority Level").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Parent Project ID").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Parent Project ID").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("GTM Lead").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Lead").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Mtg: Pri Rvw").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Mtg: Pri Rvw").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Key Points");
                                                                            //SPUtility.HideSPField("GTM Status");
                                                                            //SPUtility.HideSPField("Priority Level");
                                                                            //SPUtility.HideSPField("Parent Project ID");
                                                                            //SPUtility.HideSPField("GTM Lead");
                                                                            //SPUtility.HideSPField("Mtg: Pri Rvw");

                                                                            //SPUtility.HideSPField("Mtg: Consumer Staff");
                                                                            //SPUtility.HideSPField("Mtg: Executive GTM");
                                                                        }

                                                                        function hideDisplayFormAdmin() {
                                                                            //if (isAdministrator)
                                                                            {
                                                                                SPUtility.GetSPField("Parent Project ID:ID").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID:ID").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Parent Project ID:Week Of").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID:Week OF").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Parent Project ID:Launch Date").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID:Launch Date").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Parent Project ID:ID").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID:ID").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("GTM Last Column").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("GTM Last Column").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Parent Project ID:ID");
                                                                                //SPUtility.HideSPField("Parent Project ID:Week Of");
                                                                                //SPUtility.HideSPField("Parent Project ID:Launch Date");
                                                                                //SPUtility.HideSPField("Parent Project ID:ID");
                                                                                //SPUtility.HideSPField("Launch Date (text)");
                                                                                //SPUtility.HideSPField("GTM Last Column");
                                                                                //SPUtility.HideSPField("Week Of");

                                                                            }
                                                                            //hideRows(adminRowIndex, saveAsDraftRowIndex);
                                                                            //hideRows(saveAsDraftRowIndex, lastRowIndex + 1);
                                                                            //        03/03/2020 - remove the display of ALL support teams data
                                                                            console.log("hide admin row from pmo");
                                                                            hideRows(pmoRowIndex - 1, adminRowIndex);
                                                                            hideRows(saveAsDraftRowIndex, lastRowIndex + 1);
                                                                            showLeadsforDisplay();
                                                                        }

                                                                        function createProjectLibrary() {
                                                                            var url = "https://onesite.verizon.com/sites/HQ_GTM/GTM_Decks";

                                                                            var projectTitle = SPUtility.GetSPField("Project Name").GetValue();
                                                                            projectName = projectTitle.replace(/[`~!@#$%^&*()_|+\-=?;:'\/",.<>\{\}\[\]\\\/]/gi, '');
                                                                            var sendItem = "{ '__metadata': { 'type': 'SP.List' }, 'AllowContentTypes': true, 'BaseTemplate': 101, 'ContentTypesEnabled': true, 'Description': '" + projectName + "', 'Title':'" + projectTitle + "'}";
                                                                            jQuery.ajax({
                                                                                async: false,
                                                                                url: url + "/_api/web/lists",
                                                                                type: "POST",
                                                                                data: sendItem,
                                                                                //JSON.stringify({ '__metadata': { 'type': 'SP.List' }, 'AllowContentTypes': true,
                                                                                // 'BaseTemplate': 100, 'ContentTypesEnabled': true, 'Description': 'My list description', 'Title': 'Test 2' }),
                                                                                headers: {
                                                                                    "accept": "application/json;odata=verbose",
                                                                                    "content-type": "application/json;odata=verbose",
                                                                                    "content-length": 500,
                                                                                    "X-RequestDigest": $("#__REQUESTDIGEST").val()
                                                                                },
                                                                                success: function(data) {
                                                                                    console.log("Create list ran successfully!");
                                                                                    //alert ("Create list ran successfully!");
                                                                                },
                                                                                error: function(err) {
                                                                                    console.log("Error while creating list: " + JSON.stringify(err));
                                                                                    //JSON.stringify(err));
                                                                                    errormessage = "Error while creating list: " + JSON.stringify(err);
                                                                                    //JSON.stringify(err);
                                                                                    //alert (errormessage);
                                                                                }
                                                                            });
                                                                            // break role inheritance for the list
                                                                            var endpointUri = url + "/_api/web/lists/getbytitle('";
                                                                            endpointUri += projectName + "')/breakroleinheritance(copyRoleAssignments=true, clearSubscopes=true)";
                                                                            var headers = {
                                                                                "Accept": "application/json;odata=verbose",
                                                                                "content-Type": "application/json;odata=verbose",
                                                                                "X-RequestDigest": jQuery("#__REQUESTDIGEST").val()
                                                                            }

                                                                            jQuery.ajax({
                                                                                async: false,
                                                                                url: endpointUri,
                                                                                method: 'POST',
                                                                                //headers: { 'X-RequestDigest':$('#__REQUESTDIGEST').val() },
                                                                                headers: headers,
                                                                                dataType: 'json',
                                                                                //success: deleteCurrentRoleForGroup,
                                                                                success: function(data) {
                                                                                    console.log("Break inheritance ran successfully!");
                                                                                },
                                                                                error: function(err) {
                                                                                    console.log("Error while breaking inheritance: " + JSON.stringify(err));
                                                                                    errormessage = "Error while breaking inheritance: " + JSON.stringify(err);
                                                                                }
                                                                            });
                                                                            // assign new role permission ==DO NOT DO THIS YET until we know which role
                                                                            var headers = {
                                                                                "Accept": "application/json;odata=verbose",
                                                                                "content-Type": "application/json;odata=verbose",
                                                                                "X-RequestDigest": jQuery("#__REQUESTDIGEST").val()
                                                                            }
                                                                            var endpointUri = url + "/_api/web/lists/getbytitle('";
                                                                            endpointUri += projectName + "')/roleassignments/addroleassignment(principalid=214,roleDefId=1073741829)";
                                                                            var call = jQuery.ajax({
                                                                                async: false,
                                                                                url: endpointUri,
                                                                                type: "POST",
                                                                                headers: headers,
                                                                                dataType: 'json',
                                                                                success: function(data) {//alert('Role Permission Added successfully!');  
                                                                                },
                                                                                error: function(error) {
                                                                                    //alert(JSON.stringify(error));  
                                                                                    console.log("Error while breaking inheritance: " + JSON.stringify(error));
                                                                                }
                                                                            });
                                                                            var projectDescription = SPUtility.GetSPField("Project Name").GetValue();
                                                                            var projectName = projectDescription.replace(/[`~!@#$%^&*()_|+\-=?;:'\/",.<>\{\}\[\]\\\/]/gi, '');
                                                                            //limit projectName to 69 characters, this seems to be the max for file name (not including start.aspx... below)	
                                                                            projectName = projectName.substring(0, 50);
                                                                            var url = "https://onesite.verizon.com/sites/HQ_GTM";
                                                                            var listName = "GTM Project Libraries";
                                                                            var projectURL = "https://onesite.verizon.com/sites/HQ_GTM/GTM_Decks/_layouts/15/start.aspx#/" + projectName + "/Forms/AllItems.aspx";
                                                                            //test purposes only - use Test brief from Dan G
                                                                            //ID = 805;
                                                                            SPAddProjectLibraryItem(url, listName, projectName, projectDescription, ID, projectURL);
                                                                        }
                                                                        function SPAddProjectLibraryItem(url, listName, projectName, projectDescription, parentID, projectURL) {

                                                                            var senditem = {
                                                                                '__metadata': {
                                                                                    'type': 'SP.Data.GTM_x0020_Project_x0020_LibrariesListItem'
                                                                                },
                                                                                'Project_x0020_Library_x0020_Link': {
                                                                                    '__metadata': {
                                                                                        'type': 'SP.FieldUrlValue'
                                                                                    },
                                                                                    'Description': projectDescription,
                                                                                    'Url': projectURL
                                                                                },
                                                                                'Parent_x0020_Project_x0020_IDId': parentID
                                                                            };
                                                                            var headers = {
                                                                                "Accept": "application/json;odata=verbose",
                                                                                "content-Type": "application/json;odata=verbose",
                                                                                "X-RequestDigest": jQuery("#__REQUESTDIGEST").val()
                                                                            }
                                                                            $.ajax({
                                                                                async: false,
                                                                                url: url + "/_api/web/lists/getbytitle('" + listName + "')/items",
                                                                                type: "POST",
                                                                                data: JSON.stringify(senditem),
                                                                                headers: headers,
                                                                                success: function(data) {//var i = 0;
                                                                                },
                                                                                error: function(error) {
                                                                                    //alert(JSON.stringify(error));
                                                                                    console.log(JSON.stringify(error));
                                                                                }
                                                                            });
                                                                        }

                                                                        //=========== Super Brief logics =======================================
                                                                        /*
fnPopulateSupportTeams = function () {
	var primarySupport = SPUtility.GetSPField("What is the Primary type of support are you requesting?").GetValue();
	SPUtility.HideSPField("What is the Primary type of support are you requesting?");
	if (primarySupport == "Consumer  multi-channel")
	{
		$(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked" ,"check");
		SPUtility.GetSPField("GTM Launch Team").SetValue("Consumer Multi-Channel");
	}
	else if (primarySupport == "B2B - as primary")
	{
		$(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked" ,"check");
		SPUtility.GetSPField("GTM Launch Team").SetValue("B2B");
		//fnLockSupportTeams();  Do ot take any action until we talk to B2B
	}
	else if (primarySupport == "PNB  as primary")	
	{
		$(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked" ,"check");
		//SPUtility.GetSPField("GTM Launch Team").SetValue("Media Co.");
	}
	else if (primarySupport == "Channel Operations - as primary")
	{
		$(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked" ,"check");
		SPUtility.GetSPField("GTM Launch Team").SetValue("Channel Ops (Operations support only)");
	}
	else  // for very old breifs that do not have "primary" type, set it to Consumer
	{
		$(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked" ,"check");
		SPUtility.GetSPField("GTM Launch Team").SetValue("Consumer Multi-Channel");
	}
	
	SPUtility.ShowSPField("GTM Launch Team");
	isGTM = true;
}*/

                                                                        fnLockSupportTeams = function() {
                                                                            //lock out Support Teams if user login is not the submitter, not HQSuper admin and cgtmleads
                                                                            // we need these lengthy codes, makereadonly will not show the proper checkbox and radiobutton, it will just show comma separated values.  not good!
                                                                            //unlock as per Danielle's request
                                                                            if (!isHQSuperAdmin && !isCGTMLeads) {
                                                                                $("input[id^='Support_x0020_Team']").prop("disabled", "true");
                                                                                //$(".ms-RadioText[title='Consumer Multi-Channel'] :radio").prop("disabled" ,"true");
                                                                                //$(".ms-RadioText[title='B2B'] :radio").prop("disabled" ,"true");
                                                                                //$(".ms-RadioText[title='Media Co.'] :radio").prop("disabled" ,"true");
                                                                                //$(".ms-RadioText[title='Channel Ops (Operations support only)'] :radio").prop("disabled" ,"true");
                                                                            }
                                                                        }
                                                                        // the following function is no longer needed
                                                                        fnUnLockSupportTeams = function() {
                                                                            if (!isIMCAssigned) {
                                                                                $(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").prop("disabled", "false");
                                                                                if (isIMC && !isAssigned)
                                                                                    unlockRows(imRowIndex, gtmRowIndex);
                                                                            }

                                                                            if (!isGTMAssigned) {
                                                                                $(".ms-RadioText[title='Go To Market'] :checkbox").prop("disabled", "false");
                                                                                $("input[id^='GTM_x0020_Support']").prop("disabled", "");
                                                                                if (isGTM && !isAssigned)
                                                                                    unlockRows(gtmRowIndex, salesOpsRowIndex);
                                                                            }
                                                                            if (!isDOAssigned) {
                                                                                $(".ms-RadioText[title='Digital Resource Request'] :checkbox").prop("disabled", "false");
                                                                                if (isDigitalOps)
                                                                                    unlockRows(digitalOpsRowIndex, adminRowIndex);
                                                                            }
                                                                            if (!isSalesOpsAssigned) {
                                                                                $(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").prop("disabled", "false");
                                                                                if (isSalesOps)
                                                                                    unlockRows(salesOpsRowIndex, digitalOpsRowIndex);
                                                                            }

                                                                            if (isAssigned) {
                                                                                $('input[value=Submit]').prop("disabled", false);
                                                                                if (typeof document.getElementById('Ribbon.ListForm.Edit.Commit.Publish-Large') != 'undefined')
                                                                                    document.getElementById('Ribbon.ListForm.Edit.Commit.Publish-Large').style.display = 'inline-block';
                                                                                if (typeof document.getElementById('Ribbon.ListForm.Edit.Actions.AttachFile-Large') != 'undefined')
                                                                                    document.getElementById('Ribbon.ListForm.Edit.Actions.AttachFile-Large').style.display = 'inline-block';
                                                                            }
                                                                        }

                                                                        fnSupportTeams = function() {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            var spfSupportTeamsValue = SPUtility.GetSPField("Support Team(s)").GetValue();
                                                                            if (spfSupportTeamsValue.length == 0) {
                                                                                //fnUnLockSupportTeams();
                                                                                $("input[id^='GTM_x0020_Support']").prop("checked", "");
                                                                            }
                                                                        }

                                                                        function fnPrimaryGTMSupport() {
                                                                            var spfSupportTeamsValue = SPUtility.GetSPField("Support Team(s)").GetValue();
                                                                            var primarySupport = "";
                                                                            //SPUtility.GetSPField("GTM Launch Team").GetValue();
                                                                            isConsumer = false;
                                                                            isB2B = false;
                                                                            isOps = false;
                                                                            isPNB = false;
                                                                            isGTM = false;
                                                                            isIMC = false;
                                                                            isDigitalOps = false;
                                                                            isSalesOps = false;

                                                                            if (isDisplayForm) {
                                                                                if (spfSupportTeamsValue.indexOf('Go To Market') > -1)
                                                                                    isGTM = true;
                                                                                if (spfSupportTeamsValue.indexOf('Marketing PMO Request') > -1)
                                                                                    isPMO = true;
                                                                                if (spfSupportTeamsValue.indexOf('Marketing FWA PMO Request') > -1)
                                                                                    isFWAPMO = true;
                                                                                if (spfSupportTeamsValue.indexOf('Digital Resource Request') > -1)
                                                                                    isDigitalOps = true;
                                                                                if (spfSupportTeamsValue.indexOf('Integrated Marketing Communications') > -1)
                                                                                    isIMC = true;
                                                                                if (spfSupportTeamsValue.indexOf('Sales Operations (ONLY)') > -1)
                                                                                    isSalesOps = true;
                                                                                if (spfSupportTeamsValue.indexOf('Unapproved Promo Calendar') > -1)
                                                                                    isPromo = true;
                                                                            } else {
                                                                                for (i = 0; i < spfSupportTeamsValue.length; i++) {
                                                                                    if (spfSupportTeamsValue[i] == 'Go To Market')
                                                                                        isGTM = true;
                                                                                    if (spfSupportTeamsValue[i] == 'Marketing PMO Request')
                                                                                        isPMO = true;
                                                                                    if (spfSupportTeamsValue[i] == 'Marketing FWA PMO Request')
                                                                                        isFWAPMO = true;
                                                                                    if (spfSupportTeamsValue[i] == 'Digital Resource Request')
                                                                                        isDigitalOps = true;
                                                                                    if (spfSupportTeamsValue[i] == 'Integrated Marketing Communications')
                                                                                        isIMC = true;
                                                                                    if (spfSupportTeamsValue[i] == 'Brand Development')
                                                                                        isBrand = true;
                                                                                    if (spfSupportTeamsValue[i] == 'Sales Operations (ONLY)')
                                                                                        isSalesOps = true;
                                                                                    if (spfSupportTeamsValue.indexOf('Unapproved Promo Calendar') > -1)
                                                                                        isPromo = true;
                                                                                    if (spfSupportTeamsValue.indexOf('NBx Proposition') > -1)
                                                                                        isNBx = true;
                                                                                }
                                                                            }

                                                                            if (isPMO && spfSupportTeamsValue.length == 1) {
                                                                                isPMOOnly = true;
                                                                                isIMC = false;
                                                                                isBrand = false;
                                                                                isGTM = false;
                                                                                isSalesOps = false;
                                                                                isPromo = false;

                                                                            }
                                                                            if (isFWAPMO && spfSupportTeamsValue.length == 1) {
                                                                                isPMOOnly = true;
                                                                                isIMC = false;
                                                                                isBrand = false;
                                                                                isGTM = false;
                                                                                isSalesOps = false;
                                                                                isPromo = false;

                                                                            }
                                                                            /*
	if (isPMO && isFWAPMO && spfSupportTeamsValue.length == 2)
	{
		isPMOOnly = true;
		isIMC = false;
		isBrand = false;
		isGTM = false;
		isSalesOps = false;
		isPromo = false;

	}*/

                                                                            //04/15/19 - block PMO if brief was created prior to 04/15/2019
                                                                            if (!isPMO && isEditForm) {
                                                                                var submissionDate = new Date(SPUtility.GetSPField("Project Submission Date").GetValue());
                                                                                var cutoffDate = new Date("04/15/2019");
                                                                                if (submissionDate <= cutoffDate)
                                                                                    $(".ms-RadioText[title='Marketing PMO Request'] :checkbox").prop("disabled", "true");
                                                                            }

                                                                            if (isSalesOps && isEditForm) {
                                                                                $(".ms-RadioText[title='Marketing PMO Request'] :checkbox").prop("disabled", "true");
                                                                                $(".ms-RadioText[title='Marketing FWA PMO Request'] :checkbox").prop("disabled", "true");
                                                                                $(".ms-RadioText[title='Go To Market'] :checkbox").prop("disabled", "true");
                                                                                $(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").prop("disabled", "true");
                                                                                $(".ms-RadioText[title='Brand Development'] :checkbox").prop("disabled", "true");
                                                                                $(".ms-RadioText[title='Digital Resource Request'] :checkbox").prop("disabled", "true");
                                                                                $(".ms-RadioText[title='Unapproved Promo Calendar'] :checkbox").prop("disabled", "true");
                                                                                // Sales ops removal
                                                                                //$(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").prop("disabled" ,"true");
                                                                                //SPUtility.ShowSPField("Sales Ops Support Type");
                                                                            }

                                                                            // Sales ops removal
                                                                            //if (!isSalesOps)
                                                                            //SPUtility.HideSPField("Sales Ops Support Type");

                                                                            if (!isPromo) {
                                                                                SPUtility.GetSPField("Finance Status").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Finance Status").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Finance Status");
                                                                            }

                                                                            // 11/28/18 - only show Digital Support Launch for consumber briefs
                                                                            /*if (isGTM && !isDraft)
	{
		SPUtility.ShowSPField("Digital Support Launch");
		//SPUtility.ShowSPField("Special Call Outs");
	}
	else
	{
		$("input[id^='Digital_x0020_Launch']").prop( "checked", "" );
		SPUtility.HideSPField("Digital Support Launch");
		SPUtility.HideSPField("Special Call Outs");
	}*/
                                                                            console.log("primary supprot gtm hide admin row");
                                                                            hideRows(pmoRowIndex - 1, adminRowIndex);
                                                                            var status = "";
                                                                            var priorityLevel = SPUtility.GetSPField("Priority Level").GetValue();
                                                                            if (isGTM) {

                                                                                if (isMarketLaunch == '') {
                                                                                    console.log("gtm sales ops show");
                                                                                    showRows((gtmRowIndex - 1), salesOpsRowIndex);
                                                                                    var status = SPUtility.GetSPField("GTM Status").GetValue();

                                                                                    if (status == "Assigned" && (priorityLevel == "1" || priorityLevel == "2" || priorityLevel == "3" || priorityLevel == "4") && !isHQSuperAdmin) {
                                                                                        $(".ms-RadioText[title='Go To Market'] :checkbox").prop("disabled", "true");
                                                                                        $("input[id^='GTM_x0020_Support']").prop("disabled", "true");
                                                                                    } else
                                                                                        unlockRows(gtmRowIndex, salesOpsRowIndex);
                                                                                } else {
                                                                                    fnHideNonMarketActivity();
                                                                                }
                                                                            }
                                                                            if (isPMO) {//showRows((pmoRowIndex-1), imRowIndex);
                                                                            //status = SPUtility.GetSPField("PMO Brief Status").GetValue();
                                                                            //if ((status == "In Progress" || status == "Complete") && !isHQSuperAdmin)
                                                                            //	$(".ms-RadioText[title='Marketing PMO Request'] :checkbox").prop("disabled" ,"true");
                                                                            //else
                                                                            //	unlockRows(pmoRowIndex, imRowIndex);
                                                                            }
                                                                            if (isFWAPMO) {//showRows((pmoRowIndex-1), imRowIndex);
                                                                            //status = SPUtility.GetSPField("FWA PMO Brief Status").GetValue();
                                                                            //if ((status == "In Progress" || status == "Complete") && !isHQSuperAdmin)
                                                                            //	$(".ms-RadioText[title='Marketing FWA PMO Request'] :checkbox").prop("disabled" ,"true");
                                                                            //else
                                                                            //	unlockRows(pmoRowIndex, imRowIndex);
                                                                            }

                                                                            if (isIMC) {
                                                                                showRows((imRowIndex - 1), gtmRowIndex);
                                                                                status = SPUtility.GetSPField("IMC Brief Status").GetValue();
                                                                                if ((status == "In Progress" || status == "Complete") && !isHQSuperAdmin)
                                                                                    $(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").prop("disabled", "true");
                                                                                else
                                                                                    unlockRows(imRowIndex, gtmRowIndex);
                                                                            }
                                                                            if (isBrand) {
                                                                                showRows((imRowIndex - 1), gtmRowIndex);
                                                                                status = SPUtility.GetSPField("Branding Brief Status").GetValue();
                                                                                if ((status == "In Progress" || status == "Complete") && !isHQSuperAdmin)
                                                                                    $(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").prop("disabled", "true");
                                                                                else
                                                                                    unlockRows(imRowIndex, gtmRowIndex);
                                                                            }

                                                                            if (isDigitalOps) {
                                                                                console.log("digiops show to admin");
                                                                                if (isEditForm) {
                                                                                    showRows((digitalOpsRowIndex - 1), adminRowIndex);

                                                                                } else {
                                                                                    showRows((digitalOpsRowIndex - 2), adminRowIndex);
                                                                                }
                                                                                status = SPUtility.GetSPField("DO Project Status").GetValue();
                                                                                if ((status == "In Progress" || status == "Complete") && !isHQSuperAdmin)
                                                                                    $(".ms-RadioText[title='Digital Resource Request'] :checkbox").prop("disabled", "true");
                                                                                else
                                                                                    unlockRows(digitalOpsRowIndex, adminRowIndex);
                                                                            }
                                                                            //if (isSalesOps)
                                                                            //{
                                                                            //	showRows((salesOpsRowIndex-1), digitalOpsRowIndex);
                                                                            //	status = SPUtility.GetSPField("Sales Ops Status").GetValue();
                                                                            //	if ((status == "Assigned") && !isHQSuperAdmin)
                                                                            //		$(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").prop("disabled" ,"true");
                                                                            //	else
                                                                            //		unlockRows(salesOpsRowIndex, digitalOpsRowIndex);
                                                                            //}

                                                                            if (isPromo) {
                                                                                SPUtility.ShowSPField("Finance Status");
                                                                                SPUtility.GetSPField("Finance Status").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Finance Status").ControlsRow.className = SPUtility.GetSPField("Finance Status").ControlsRow.className.replace("noShow", "");

                                                                            }
                                                                            //refresh admin section if applicable
                                                                            if (isEditForm && isAdmin)
                                                                                showAdmin();
                                                                        }

                                                                        function fnSupportTeamsClick(event) {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            var id = event.target.id;
                                                                            var fields = id.split('_');
                                                                            var idno = parseInt(fields[fields.length - 1]);
                                                                            //isPMOOnly = false;
                                                                            //isPMO  = false;
                                                                            //isFWAPMO = false;
                                                                            isPromoOnly = false;
                                                                            if (event.target.nextElementSibling.innerHTML == "Marketing PMO Request" || event.target.nextElementSibling.innerHTML == "Marketing FWA PMO Request") {
                                                                                if (event.target.nextElementSibling.innerHTML == "Marketing PMO Request")
                                                                                    isPMO = true;
                                                                                if (event.target.nextElementSibling.innerHTML == "Marketing FWA PMO Request")
                                                                                    isFWAPMO = true;

                                                                                if ($("input[id^='" + id + "']").prop("checked") && (SPUtility.GetSPField("Support Team(s)").GetValue().length == 1)) {
                                                                                    /*$(".ms-RadioText[title='Go To Market'] :checkbox").prop('checked', false);
			$(".ms-RadioText[title='Go To Market'] :checkbox").attr('disabled', true);
			$(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").prop('checked', false);
			$(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").attr('disabled', true);
			$(".ms-RadioText[title='Consumer CRM'] :checkbox").prop('checked', false);
			$(".ms-RadioText[title='Consumer CRM'] :checkbox").attr('disabled', true);
			$(".ms-RadioText[title='Digital Resource Request'] :checkbox").prop('checked', false);
			$(".ms-RadioText[title='Digital Resource Request'] :checkbox").attr('disabled', true);*/
                                                                                    isPMOOnly = true;
                                                                                    isIMC = false;
                                                                                    isBrand = false;
                                                                                    isGTM = false;
                                                                                    isSalesOps = false;
                                                                                    isPromo = false;
                                                                                    isNBx = false;
                                                                                }
                                                                                /*else if (!$("input[id^='"+id+"']").prop( "checked"))
		{
			//if (isNewForm)  10/16/19 - why?
			{
				isPMOOnly = false;
			}
		}*/
                                                                            }

                                                                            if (event.target.nextElementSibling.innerHTML == "Marketing PMO Request") {
                                                                                if ($("input[id^='" + id + "']").prop("checked")) {
                                                                                    isPMO = true;
                                                                                    showRows((pmoRowIndex - 3), imRowIndex - 2);
                                                                                    // reopen sections for user input after brief's assignment, and reopen Submit button
                                                                                    if (!isPMOAssigned) {
                                                                                        unlockRows(pmoRowIndex, imRowIndex);
                                                                                    }
                                                                                } else {
                                                                                    isPMO = false;
                                                                                }
                                                                            }
                                                                            if (event.target.nextElementSibling.innerHTML == "Marketing FWA PMO Request") {
                                                                                if ($("input[id^='" + id + "']").prop("checked")) {
                                                                                    isFWAPMO = true;

                                                                                    showRows(pmoRowIndex - 3, imRowIndex);
                                                                                    // reopen sections for user input after brief's assignment, and reopen Submit button
                                                                                    if (!isPMOAssigned) {
                                                                                        unlockRows(pmoRowIndex, imRowIndex);
                                                                                    }
                                                                                } else {
                                                                                    isFWAPMO = false;
                                                                                }
                                                                            }

                                                                            if (isPMO || isFWAPMO) {//isPMOOnly = true;
                                                                            //isIMC = false;
                                                                            //isBrand = false;
                                                                            //isGTM = false;
                                                                            //isSalesOps = false;
                                                                            //isPromo = false;
                                                                            } else {
                                                                                hideRows((pmoRowIndex - 3), imRowIndex - 2);
                                                                            }

                                                                            if (event.target.nextElementSibling.innerHTML == "Integrated Marketing Communications") {
                                                                                if ($("input[id^='" + id + "']").prop("checked")) {
                                                                                    isIMC = true;
                                                                                    isPMOOnly = false;
                                                                                    console.log("here work");
                                                                                    showRows((imRowIndex - 3), gtmRowIndex - 2);
                                                                                    // reopen sections for user input after brief's assignment, and reopen Submit button
                                                                                    if (!isIMCAssigned) {
                                                                                        unlockRows(imRowIndex, gtmRowIndex);
                                                                                    }
                                                                                } else {
                                                                                    hideRows((imRowIndex - 3), gtmRowIndex - 2);
                                                                                    isIMC = false;
                                                                                }
                                                                            }

                                                                            if (event.target.nextElementSibling.innerHTML == "Brand Development") {
                                                                                if ($("input[id^='" + id + "']").prop("checked")) {
                                                                                    isBrand = true;
                                                                                    isPMOOnly = false;
                                                                                    showRows((imRowIndex - 3), gtmRowIndex - 2);
                                                                                    // reopen sections for user input after brief's assignment, and reopen Submit button
                                                                                    if (!isBrandAssigned) {
                                                                                        unlockRows(imRowIndex, gtmRowIndex);
                                                                                    }
                                                                                    fnBrandDevelopment();
                                                                                } else {
                                                                                    hideRows((imRowIndex - 3), gtmRowIndex - 2);
                                                                                    isBrand = false;
                                                                                }
                                                                            }

                                                                            if (event.target.nextElementSibling.innerHTML == "Go To Market") {
                                                                                if ($("input[id^='" + id + "']").prop("checked")) {
                                                                                    isGTM = true;
                                                                                    isPMOOnly = false;
                                                                                    //fnLaunchType();
                                                                                    console.log("gtm go to market selection");
                                                                                    showRows((gtmRowIndex - 3), salesOpsRowIndex - 4);
                                                                                    // reopen sections for user input after brief's assignment, and reopen Submit button
                                                                                    if (!isGTMAssigned) {
                                                                                        unlockRows(gtmRowIndex, salesOpsRowIndex);
                                                                                    }
                                                                                } else {
                                                                                    hideRows((gtmRowIndex - 3), salesOpsRowIndex - 2);
                                                                                    isGTM = false;
                                                                                }
                                                                            }

                                                                            if (event.target.nextElementSibling.innerHTML == "Digital Resource Request") {
                                                                                if ($("input[id^='" + id + "']").prop("checked")) {
                                                                                    isDigitalOps = true;
                                                                                    isPMOOnly = false;
                                                                                    console.log("showing digitalops");
                                                                                    showRows((digitalOpsRowIndex - 3), adminRowIndex - 2);
                                                                                    if (!isDOAssigned) {
                                                                                        isDigitalOps = true;
                                                                                        unlockRows(digitalOpsRowIndex, adminRowIndex);
                                                                                    }
                                                                                } else {
                                                                                    hideRows((digitalOpsRowIndex - 3), adminRowIndex);
                                                                                    isDigitalOps = false;
                                                                                }
                                                                            }

                                                                            if (event.target.nextElementSibling.innerHTML == "Unapproved Promo Calendar") {
                                                                                if ($("input[id^='" + id + "']").prop("checked")) {
                                                                                    isPromo = true;
                                                                                    isPMOOnly = false;
                                                                                    SPUtility.ShowSPField("Finance Status");
                                                                                    SPUtility.GetSPField("Finance Status").Label.attr("Hiding", true);
                                                                                    SPUtility.GetSPField("Finance Status").ControlsRow.className = SPUtility.GetSPField("Finance Status").ControlsRow.className.replace("noShow", "");
                                                                                } else {
                                                                                    isPromo = false;
                                                                                    SPUtility.GetSPField("Finance Status").ControlsRow.className = "noShow";
                                                                                    SPUtility.GetSPField("Finance Status").Label.attr("Hiding", true);

                                                                                    //SPUtility.HideSPField("Finance Status");
                                                                                }
                                                                                if ($("input[id^='" + id + "']").prop("checked") && (isNewForm || (isEditForm && SPUtility.GetSPField("Support Team(s)").GetValue().length == 1))) {
                                                                                    isPromoOnly = true;
                                                                                    isPMOOnly = false;
                                                                                    //SPUtility.GetSPField("Launch Type").SetValue("Promotion"); - does not work
                                                                                    //SPUtility.GetSPField("Is this a dark launch?").SetValue("Yes");
                                                                                    hideRows((gtmRowIndex - 1), salesOpsRowIndex)

                                                                                    $("input[id^='Should_x0020_this_x0020_be_x0020_b375eecc-47e1-41c4-afce-80d01b04824c_$RadioButtonChoiceField0']").prop("checked", "checked");

                                                                                    var launchTypeId = "Launch_x0020_Type_91bdbf0a-fc57-41a7-a338-06584fd6a2e7_$DropDownChoice";
                                                                                    $("select[id^='" + launchTypeId + "'] option").each(function() {
                                                                                        if ($(this).val() == 'Promotion') {
                                                                                            $(this).prop("selected", true);
                                                                                        }
                                                                                    });
                                                                                } else
                                                                                    isPromoOnly = false;
                                                                            }

                                                                            // Sales Ops changes
                                                                            if (event.target.nextElementSibling.innerHTML == "Sales Operations (ONLY)") {
                                                                                if ($("input[id^='" + id + "']").prop("checked") && (isNewForm || (isEditForm && SPUtility.GetSPField("Support Team(s)").GetValue().length == 1))) {
                                                                                    $(".ms-RadioText[title='Marketing PMO Request'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Marketing FWA PMO Request'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Go To Market'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Brand Development'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Digital Operations'] :checkbox").prop('checked', false);
                                                                                    $(".ms-RadioText[title='Unapproved Promo Calendar'] :checkbox").prop('checked', false);

                                                                                    isSalesOps = true;
                                                                                    isPMOOnly = false;
                                                                                    isPMO = false;
                                                                                    isFWAPMO = false;
                                                                                    isIMC = false;
                                                                                    isBrand = false;
                                                                                    isGTM = false;
                                                                                    isDigitalOps = false;
                                                                                    isPromo = false;
                                                                                    //SPUtility.ShowSPField("Sales Ops Support Type");
                                                                                    console.log("sales ops show to digital ops");
                                                                                    showRows((salesOpsRowIndex - 1), digitalOpsRowIndex);
                                                                                    if (!isSalesOpsAssigned) {
                                                                                        isSalesOps = true;
                                                                                        unlockRows(salesOpsRowIndex, digitalOpsRowIndex);
                                                                                    }

                                                                                } else if (!$("input[id^='" + id + "']").prop("checked")) {
                                                                                    //if (isNewForm)  10/16/19 - why?
                                                                                    {
                                                                                        isSalesOps = false;
                                                                                        SPUtility.GetSPField("Sales Ops Support Type").ControlsRow.className = "noShow";
                                                                                        SPUtility.GetSPField("Sales Ops Support Type").Label.attr("Hiding", true);

                                                                                        //SPUtility.HideSPField("Sales Ops Support Type");
                                                                                        hideRows((salesOpsRowIndex - 1), digitalOpsRowIndex);
                                                                                    }
                                                                                }
                                                                            }
                                                                            if (isPMO || isFWAPMO || isGTM || isCRM || isDigitalOps || isIMC || isBrand || isPromo) {
                                                                                $(".ms-RadioText[title='Sales Operations (ONLY)'] :checkbox").prop('checked', false);
                                                                                isSalesOps = false;
                                                                                //SPUtility.HideSPField("Sales Ops Support Type");		
                                                                            }
                                                                            //refresh admin section if applicable
                                                                            if (isEditForm && isAdmin) {
                                                                                showAdmin();
                                                                                if (isPMOOnly) {
                                                                                    hideRows((imRowIndex - 1), gtmRowIndex);
                                                                                    hideRows((gtmRowIndex - 1), salesOpsRowIndex);
                                                                                    hideRows((digitalOpsRowIndex - 1), adminRowIndex);
                                                                                    //SPUtility.ShowSPField("5G");  //06/15/21
                                                                                    //SPUtility.ShowSPField("Will this project require Digital PMO support?");
                                                                                    //SPUtility.GetSPField("Will this project require Digital PMO support?").Label.attr("Hiding", false);
                                                                                    //SPUtility.GetSPField("Will this project require Digital PMO support?").ControlsRow.className = SPUtility.GetSPField("Will this project require Digital PMO support?").ControlsRow.className.replace("noShow", "");

                                                                                }
                                                                                /*if (isGTM && !isDraft)
		{
			SPUtility.ShowSPField("Digital Support Launch");
			//SPUtility.ShowSPField("Special Call Outs");
		}*/
                                                                                //showLeads(); showAdmin already does this
                                                                            }
                                                                            if (isNewForm && isPMOOnly) {
                                                                                hideRows((imRowIndex - 1), adminRowIndex);
                                                                            }

                                                                            if (isNewForm && isSalesOps) {
                                                                                hideRows((pmoRowIndex - 1), adminRowIndex);
                                                                            }

                                                                            fnSetLaunchType();
                                                                            fnLaunchType();
                                                                            /*if ((isGTM || isSalesOps || isPromo) && SPUtility.GetSPField("Area Availability").GetValue() == "Local Only")
		SPUtility.ShowSPField('Local State');
	else
	{
		//SPUtility.GetSPField("Local State").SetValue(""); - THIS DOES NOTHING
		SPUtility.HideSPField('Local State');
	}*/
                                                                            fnPopulateManagingChannel();

                                                                        }

                                                                        fnSetLaunchType = function() {
                                                                            var supportTeam = SPUtility.GetSPField("Support Team(s)").GetValue();
                                                                            var launchTypeId = "Launch_x0020_Type_91bdbf0a-fc57-41a7-a338-06584fd6a2e7_$DropDownChoice";
                                                                            var launchType = SPUtility.GetSPField("Launch Type").GetValue();

                                                                            //SPUtility.HideSPField("Field Activation Pillar");	
                                                                            //SPUtility.GetSPField("Local Marketing PMO Approval Code").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("Local Marketing PMO Approval Code").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("IT or CAM Contacts").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("IT or CAM Contacts").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Local Marketing PMO Approval Code");
                                                                            //SPUtility.ShowSPField("Clarity/Jira/Ref ID or URL link to project");
                                                                            //SPUtility.ShowSPField("IT or CAM Contacts");
                                                                            //SPUtility.HideSPField("Product or Service Offerings");
                                                                            //SPUtility.HideSPField("Marketplace Insights");
                                                                            //SPUtility.HideSPField("Target Consumer");
                                                                            //SPUtility.HideSPField("Opportunity");
                                                                            //SPUtility.HideSPField("Barrier");
                                                                            //SPUtility.HideSPField("IMC Deliverables");

                                                                            // 01/24/22 - remove the isPMOOnly logic below
                                                                            /*if (isPMOOnly)
	{
		$("select[id^='" + launchTypeId + "']").children('option').remove();	
		$("select[id^='" + launchTypeId + "']").append('<option>Application, Product or Service</option>');
		$("select[id^='" + launchTypeId + "']").append('<option>Device</option>');
		$("select[id^='" + launchTypeId + "']").append('<option>Price Plan</option>');
		$("select[id^='" + launchTypeId + "']").append('<option>System or Process Enhancement</option>');
	}
	else */
                                                                            if (isIMC) {
                                                                                $("select[id^='" + launchTypeId + "']").children('option').remove();
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Accessory</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Application, Product or Service</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Campaign or Contest</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Device</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Local Marketing</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Price Plan</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Promotion</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>System or Process Enhancement</option>');
                                                                                //if (isGTM)
                                                                                //	$("select[id^='" + launchTypeId + "']").append('<option>Fios TV Channel Changes</option>');
                                                                                SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Is this a dark launch?").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Is this a dark launch?");
                                                                                //SPUtility.ShowSPField("Field Activation Pillar");
                                                                                //SPUtility.GetSPField("Local Marketing PMO Approval Code").ControlsRow.className = SPUtility.GetSPField("Local Marketing PMO Approval Code").ControlsRow.className.replace("noShow", "");
                                                                                //SPUtility.GetSPField("Local Marketing PMO Approval Code").Label.attr("Hiding", false);
                                                                                //SPUtility.ShowSPField("Local Marketing PMO Approval Code");

                                                                                SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Clarity/Jira/Ref ID or URL link to project").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("IT or CAM Contacts").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("IT or CAM Contacts").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Clarity/Jira/Ref ID or URL link to project");
                                                                                //SPUtility.HideSPField("IT or CAM Contacts");
                                                                            } else if (isGTM) {
                                                                                $("select[id^='" + launchTypeId + "']").children('option').remove();
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Accessory</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Application, Product or Service</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Campaign or Contest</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Device</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Local Marketing</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Price Plan</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Promotion</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>System or Process Enhancement</option>');
                                                                                //$("select[id^='" + launchTypeId + "']").append('<option>Fios TV Channel Changes</option>');
                                                                            } else if (isSalesOps) {
                                                                                $("select[id^='" + launchTypeId + "']").children('option').remove();
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Operations</option>');
                                                                            } else {
                                                                                $("select[id^='" + launchTypeId + "']").children('option').remove();
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Accessory</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Application, Product or Service</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Campaign or Contest</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Device</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Price Plan</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>Promotion</option>');
                                                                                $("select[id^='" + launchTypeId + "']").append('<option>System or Process Enhancement</option>');
                                                                            }
                                                                            $("select[id^='" + launchTypeId + "'] option").each(function() {
                                                                                if ($(this).val() == launchType) {
                                                                                    $(this).prop("selected", true);
                                                                                }
                                                                            });
                                                                        }

                                                                        function lockRows(startRow, endRow) {
                                                                            $('.ms-formtable tr').each(function(index) {
                                                                                rowIndex = this.rowIndex;
                                                                                if (rowIndex > startRow && rowIndex < endRow) {
                                                                                    $(this).find('input, select').attr('disabled', true);
                                                                                    $(this).find("div[role='textbox']").attr("contenteditable", "false");
                                                                                }
                                                                                if (rowIndex >= endRow)
                                                                                    return false;
                                                                            });
                                                                        }

                                                                        function unlockRows(startRow, endRow) {
                                                                            if (isDisplayForm)
                                                                                return;
                                                                            $('.ms-formtable tr').each(function(index) {
                                                                                rowIndex = this.rowIndex;
                                                                                //if (($(this).context.rowIndex > startRow) && ($(this).context.rowIndex < endRow))
                                                                                if (rowIndex > startRow && rowIndex < endRow) {
                                                                                    $(this).find('input, select, textarea').attr('disabled', false);
                                                                                    $(this).find("div[role='textbox']").attr("contenteditable", "true");
                                                                                }
                                                                                if (rowIndex >= endRow)
                                                                                    return false;
                                                                            });
                                                                        }

                                                                        function DisablePeopleColumns() {
                                                                            $(".sp-peoplepicker-topLevel").each(function() {
                                                                                $(this).children().attr('disabled', 'disabled');
                                                                            });
                                                                            $(".sp-peoplepicker-delImage").hide();
                                                                        }

                                                                        function EnablePeopleColumns() {
                                                                            $(".sp-peoplepicker-topLevel").each(function() {
                                                                                $(this).children().attr('disabled', false);
                                                                            });
                                                                            $(".sp-peoplepicker-delImage").show();
                                                                        }
                                                                        function EnableLead(dispTitle) {
                                                                            var pickerDiv = $("[id$='ClientPeoplePicker'][title='" + dispTitle + "']");
                                                                            var peoplePicker = SPClientPeoplePicker.SPClientPeoplePickerDict[pickerDiv[0].id];
                                                                            //enable the field
                                                                            peoplePicker.SetEnabledState(true);
                                                                            // attempt to add the x
                                                                            var href = pickerDiv.find(".sp-peoplepicker-delImage");
                                                                            //href[0].innerHTML = "X";
                                                                            href.show();
                                                                        }

                                                                        function DisableLead(dispTitle) {
                                                                            var pickerDiv = $("[id$='ClientPeoplePicker'][title='" + dispTitle + "']");
                                                                            var peoplePicker = SPClientPeoplePicker.SPClientPeoplePickerDict[pickerDiv[0].id];
                                                                            //disable the field
                                                                            peoplePicker.SetEnabledState(false);
                                                                            // attempt to remove the x
                                                                            var href = pickerDiv.find(".sp-peoplepicker-delImage");
                                                                            if (href.length > 0)
                                                                                href[0].innerHTML = "";
                                                                        }

                                                                        function showLeadsforDisplay() {

                                                                            SPUtility.ShowSPField("Key Points");
                                                                            SPUtility.GetSPField("Key Points").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Key Points").ControlsRow.className = SPUtility.GetSPField("Key Points").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Priority Level");
                                                                            SPUtility.GetSPField("Priority Level").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Priority Level").ControlsRow.className = SPUtility.GetSPField("Priority Level").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("PMO Lead(s)");
                                                                            SPUtility.GetSPField("PMO Leads(s)").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("PMO Lead(s)").ControlsRow.className = SPUtility.GetSPField("PMO Lead(s)").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("PMO Support Level");
                                                                            SPUtility.GetSPField("PMO Support Level").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("PMO Support Level").ControlsRow.className = SPUtility.GetSPField("PMO Support Level").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("PMO Brief Status");
                                                                            //SPUtility.GetSPField("PMO Brief Status").Label.attr("Hiding", false);
                                                                            //SPUtility.GetSPField("PMO Brief Status").ControlsRow.className = SPUtility.GetSPField("PMO Brief Status").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("FWA PMO Lead(s)");
                                                                            SPUtility.GetSPField("FW PMO Lead(s)").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("FWA PMO Lead(s)").ControlsRow.className = SPUtility.GetSPField("FWA PMO Lead(s)").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("FWA PMO Support Level");
                                                                            SPUtility.GetSPField("FWA PMO Support Level").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("FWA PMO Support Level").ControlsRow.className = SPUtility.GetSPField("FWA PMO Support Level").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("FWA PMO Brief Status");
                                                                            //SPUtility.GetSPField("FWA PMO Brief Status").Label.attr("Hiding", false);
                                                                            //SPUtility.GetSPField("FWA PMO Brief Status").ControlsRow.className = SPUtility.GetSPField("FWA PMO Brief Status").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("IMC Leads");
                                                                            SPUtility.GetSPField("IMC Leads").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("IMC Leads").ControlsRow.className = SPUtility.GetSPField("IMC Leads").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("IMC Brief Status");
                                                                            SPUtility.GetSPField("IMC Brief Status").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("IMC Brief Status").ControlsRow.className = SPUtility.GetSPField("IMC Brief Status").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("IMC Overview");
                                                                            SPUtility.ShowSPField("GTM Lead");
                                                                            SPUtility.GetSPField("GTM Lead").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("GTM Lead").ControlsRow.className = SPUtility.GetSPField("GTM Lead").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("GTM Status");
                                                                            SPUtility.GetSPField("GTM Status").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("GTM Status").ControlsRow.className = SPUtility.GetSPField("GTM Status").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Lead Sr. Mgr");
                                                                            SPUtility.GetSPField("Lead Sr. Mgr").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Lead Sr. Mgr").ControlsRow.className = SPUtility.GetSPField("Lead Sr. Mgr").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("DO Lead");
                                                                            SPUtility.GetSPField("DO Lead").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("DO Lead").ControlsRow.className = SPUtility.GetSPField("DO Lead").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("DO Project Status");
                                                                            SPUtility.GetSPField("DO Project Status").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("DO Project Status").ControlsRow.className = SPUtility.GetSPField("DO Project Status").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Branding Leads");
                                                                            SPUtility.GetSPField("Branding Leads").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Branding Leads").ControlsRow.className = SPUtility.GetSPField("Branding Lead").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Branding Brief Status");
                                                                            SPUtility.GetSPField("Branding Brief Status").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Branding Brief Status").ControlsRow.className = SPUtility.GetSPField("Branding Brief Status").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("ADMIN");

                                                                        }
                                                                        function showLeads() {
                                                                            //SPUtility.GetSPField("PMO Lead(s)").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("PMO Lead(s)").Label.attr("Hiding", true);

                                                                            // SPUtility.GetSPField("PMO Support Level").ControlsRow.className = "noShow";
                                                                            // SPUtility.GetSPField("PMO Support Level").Label.attr("Hiding", true);

                                                                            // SPUtility.GetSPField("PMO Brief Status").ControlsRow.className = "noShow";
                                                                            // SPUtility.GetSPField("PMO Brief Status").Label.attr("Hiding", true);

                                                                            // SPUtility.GetSPField("FWA PMO Lead(s)").ControlsRow.className = "noShow";
                                                                            // SPUtility.GetSPField("FWA PMO Lead(s)").Label.attr("Hiding", true);

                                                                            // SPUtility.GetSPField("FWA PMO Support Level").ControlsRow.className = "noShow";
                                                                            // SPUtility.GetSPField("FWA PMO Support Level").Label.attr("Hiding", true);

                                                                            // SPUtility.GetSPField("FWA PMO Brief Status").ControlsRow.className = "noShow";
                                                                            // SPUtility.GetSPField("FWA PMO Brief Status").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("PMO Lead(s)");
                                                                            //SPUtility.HideSPField("PMO Support Level");
                                                                            //SPUtility.HideSPField("PMO Brief Status");
                                                                            //SPUtility.HideSPField("FWA PMO Lead(s)");
                                                                            //SPUtility.HideSPField("FWA PMO Support Level");
                                                                            //SPUtility.HideSPField("FWA PMO Brief Status");

                                                                            SPUtility.GetSPField("IMC Leads").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("IMC Leads").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("IMC Brief Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("IMC Brief Status").Label.attr("Hiding", true);

                                                                            // SPUtility.GetSPField("IMC Overview").ControlsRow.className = "noShow";
                                                                            // SPUtility.GetSPField("IMC Overview").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("IMC Project Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("IMC Project Status").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Message Strategy").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Message Strategy").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Project Objective / KPIs").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Project Objective / KPIs").Label.attr("Hiding", true);

                                                                            //SPUtility.GetSPField("IMC Overview").ControlsRow.className = "noShow";
                                                                            //SPUtility.GetSPField("IMC Overview").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("IMC Leads");
                                                                            //SPUtility.HideSPField("IMC Brief Status");
                                                                            //SPUtility.HideSPField("IMC Overview");
                                                                            //SPUtility.HideSPField("Message Strategy");
                                                                            //SPUtility.HideSPField("Project Objective / KPIs");
                                                                            //SPUtility.HideSPField("IMC Overview");

                                                                            SPUtility.GetSPField("GTM Lead").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Lead").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("GTM Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Status").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("DO Lead").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("DO Lead").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("DO Project Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("DO Project Status").Label.attr("Hiding", true);

                                                                            if (!isBrand)
                                                                                SPUtility.GetSPField("Branding Leads").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Branding Leads").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Branding Brief Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Branding Brief Status").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("GTM Lead");
                                                                            //SPUtility.HideSPField("GTM Status");
                                                                            //SPUtility.HideSPField("Lead Sr. Mgr");
                                                                            //SPUtility.HideSPField("DO Lead");
                                                                            //SPUtility.HideSPField("DO Project Status");	
                                                                            //SPUtility.HideSPField("Branding Leads");
                                                                            //SPUtility.HideSPField("Branding Brief Status");
                                                                            //SPUtility.HideSPField("Sales Ops Lead(s)");
                                                                            //SPUtility.HideSPField("Sales Ops Status");	
                                                                            console.log("show leads hide adminrow");
                                                                            hideRows(adminRowIndex, saveAsDraftRowIndex);

                                                                            //if (isGTM || isPMO || isIMC || isBrand || isCRM || isDigitalOps || isSalesOps) -- commented out 6/22/2020
                                                                            {
                                                                                if (!isMarketAdmin) {
                                                                                    showRows((adminRowIndex), saveAsDraftRowIndex);
                                                                                } else {
                                                                                    showRows((adminRowIndex), saveAsDraftRowIndex);
                                                                                    //hideRows((internalCommRowIndex - 1), saveAsDraftRowIndex);
                                                                                }
                                                                                if (isAdmin)
                                                                                    //(isHQSuperAdmin || isGTMAdmin || isPMOAdmin || isCRMAdmin || isDOAdmin)	
                                                                                    unlockRows(adminRowIndex, saveAsDraftRowIndex);
                                                                                else {
                                                                                    lockRows(adminRowIndex + 5, saveAsDraftRowIndex);
                                                                                    //+6 because we don't want to lock out CRM/DO/IM
                                                                                    var title = "Key Points";
                                                                                    $("textarea[title='" + title + "']").attr('disabled', true);
                                                                                }
                                                                            }

                                                                            if (isPMOAdmin && isPMO) {
                                                                                // SPUtility.GetSPField("PMO Lead(s)").ControlsRow.className = SPUtility.GetSPField("PMO Lead(s)").ControlsRow.className.replace("noShow", "");
                                                                                // SPUtility.GetSPField("PMO Lead(s)").Label.attr("Hiding", false);
                                                                                // SPUtility.ShowSPField("PMO Lead(s)");

                                                                                // SPUtility.GetSPField("PMO Support Level").ControlsRow.className = SPUtility.GetSPField("PMO Support Level").ControlsRow.className.replace("noShow", "");
                                                                                // SPUtility.GetSPField("PMO Support Level").Label.attr("Hiding", false);
                                                                                // SPUtility.ShowSPField("PMO Support Level");

                                                                                // SPUtility.GetSPField("PMO Brief Status").ControlsRow.className = SPUtility.GetSPField("PMO Brief Status").ControlsRow.className.replace("noShow", "");
                                                                                // SPUtility.GetSPField("PMO Brief Status").Label.attr("Hiding", false);
                                                                                // SPUtility.ShowSPField("PMO Brief Status");	

                                                                                if (isHQSuperAdmin || isGTMAdmin || isPMOAdmin) {
                                                                                    //unlockRows(adminRowIndex+4, adminRowIndex+6);
                                                                                    // $("input[title='PMO Lead(s)']").attr('disabled', false);
                                                                                    // $("select[title='PMO Brief Status']").attr('disabled', false);
                                                                                    // SPUtility.GetSPField("PMO Brief Status").MakeEditable();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {//EnableLead("PMO Lead(s)");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');
                                                                                } else {
                                                                                    //SPUtility.GetSPField("PMO Brief Status").MakeReadOnly();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {//DisableLead("PMO Lead(s)");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');

                                                                                }
                                                                            }

                                                                            if (isFWAPMOAdmin && isFWAPMO) {
                                                                                // SPUtility.ShowSPField("FWA PMO Lead(s)");
                                                                                // SPUtility.GetSPField("FWA PMO Lead(s)").Label.attr("Hiding", false);
                                                                                // SPUtility.GetSPField("FWA PMO Lead(s)").ControlsRow.className = SPUtility.GetSPField("FWA PMO Lead(s)").ControlsRow.className.replace("noShow", "");

                                                                                // SPUtility.ShowSPField("FWA PMO Support Level");
                                                                                // SPUtility.GetSPField("FWA PMO Support Level").Label.attr("Hiding", false);
                                                                                // SPUtility.GetSPField("FWA PMO Support Level").ControlsRow.className = SPUtility.GetSPField("FWA PMO Support Level").ControlsRow.className.replace("noShow", "");

                                                                                // SPUtility.ShowSPField("FWA PMO Brief Status");
                                                                                // SPUtility.GetSPField("FWA PMO Brief Status").Label.attr("Hiding", false);
                                                                                // SPUtility.GetSPField("FWA PMO Brief Status").ControlsRow.className = SPUtility.GetSPField("FWA PMO Brief Status").ControlsRow.className.replace("noShow", "");

                                                                                if (isHQSuperAdmin || isGTMAdmin || isFWAPMOAdmin) {//unlockRows(adminRowIndex+4, adminRowIndex+6);
                                                                                // $("input[title='FWA PMO Lead(s)']").attr('disabled', false);
                                                                                // $("select[title='FWA PMO Brief Status']").attr('disabled', false);
                                                                                // SPUtility.GetSPField("FWA PMO Brief Status").MakeEditable();
                                                                                //ExecuteOrDelayUntilScriptLoaded(function () {
                                                                                //setTimeout(function () {
                                                                                // EnableLead("FWA PMO Lead(s)");
                                                                                //}, 100);
                                                                                //}, 'clientpeoplepicker.js');
                                                                                } else {// SPUtility.GetSPField("FWA PMO Brief Status").MakeReadOnly();
                                                                                //ExecuteOrDelayUntilScriptLoaded(function () {
                                                                                //setTimeout(function () {
                                                                                // DisableLead("FWA PMO Lead(s)");
                                                                                //}, 100);
                                                                                //}, 'clientpeoplepicker.js');

                                                                                }
                                                                            }

                                                                            if (isIMCAdmin && isIMC) {
                                                                                SPUtility.ShowSPField("IMC Leads");
                                                                                SPUtility.GetSPField("IMC Leads").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("IMC Leads").ControlsRow.className = SPUtility.GetSPField("IMC Leads").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("IMC Brief Status");
                                                                                SPUtility.GetSPField("IMC Brief Status").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("IMC Brief Status").ControlsRow.className = SPUtility.GetSPField("IMC Brief Status").ControlsRow.className.replace("noShow", "");

                                                                                // SPUtility.ShowSPField("IMC Overview");
                                                                                // SPUtility.GetSPField("IMC Overview").Label.attr("Hiding", false);
                                                                                // SPUtility.GetSPField("IMC Overview").ControlsRow.className = SPUtility.GetSPField("IMC Overview").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("IMC Project Status").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("IMC Project Status").ControlsRow.className = SPUtility.GetSPField("IMC Project Status").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Message Strategy");
                                                                                SPUtility.GetSPField("Message Strategy").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Message Strategy").ControlsRow.className = SPUtility.GetSPField("Message Strategy").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("Project Objective / KPIs");
                                                                                SPUtility.GetSPField("Project Objective / KPIs").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("Project Objective / KPIs").ControlsRow.className = SPUtility.GetSPField("Project Objective / KPIs").ControlsRow.className.replace("noShow", "");

                                                                                if (isHQSuperAdmin || isGTMAdmin || isIMCAdmin) {
                                                                                    //unlockRows(adminRowIndex+4, adminRowIndex+6);
                                                                                    $("input[title='IMC Leads']").attr('disabled', false);
                                                                                    $("select[title='IMC Brief Status']").attr('disabled', false);
                                                                                    // $("input[title='IMC Overview']").attr('disabled', false);
                                                                                    SPUtility.GetSPField("IMC Brief Status").MakeEditable();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {
                                                                                            EnableLead("IMC Leads");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');
                                                                                } else {
                                                                                    SPUtility.GetSPField("IMC Brief Status").MakeReadOnly();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {
                                                                                            DisableLead("IMC Leads");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');

                                                                                }
                                                                            }

                                                                            if (isBrandAdmin && isBrand) {
                                                                                SPUtility.GetSPField("Branding Leads").ControlsRow.className = SPUtility.GetSPField("Branding Leads").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("Branding Leads").Label.attr("Hiding", false);
                                                                                SPUtility.ShowSPField("Branding Leads");

                                                                                SPUtility.GetSPField("Branding Brief Status").ControlsRow.className = SPUtility.GetSPField("Branding Brief Status").ControlsRow.className.replace("noShow", "");
                                                                                SPUtility.GetSPField("Branding Brief Status").Label.attr("Hiding", false);
                                                                                SPUtility.ShowSPField("Branding Brief Status");

                                                                                if (isHQSuperAdmin || isGTMAdmin || isIMCAdmin || isBrandAdmin) {
                                                                                    //unlockRows(adminRowIndex+4, adminRowIndex+6);
                                                                                    $("input[title='Branding Leads']").attr('disabled', false);
                                                                                    $("select[title='Branding Brief Status']").attr('disabled', false);
                                                                                    SPUtility.GetSPField("Branding Brief Status").MakeEditable();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {
                                                                                            EnableLead("Branding Leads");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');
                                                                                } else {
                                                                                    SPUtility.GetSPField("Branding Brief Status").MakeReadOnly();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {
                                                                                            DisableLead("Branding Leads");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');

                                                                                }
                                                                            }

                                                                            if (isDOAdmin && isDigitalOps) {
                                                                                SPUtility.ShowSPField("DO Lead");
                                                                                SPUtility.GetSPField("DO Lead").Label.attr("Hiding", false);

                                                                                SPUtility.GetSPField("DO Lead").ControlsRow.className = SPUtility.GetSPField("DO Lead").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("DO Project Status");
                                                                                SPUtility.GetSPField("DO Project Status").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("DO Project Status").ControlsRow.className = SPUtility.GetSPField("DO Project Status").ControlsRow.className.replace("noShow", "");

                                                                                //var title = "Key Points";  02./27/2020 - show Key points to DO Amin
                                                                                //	$("textarea[title='"+ title +"']").attr('disabled', true);

                                                                                //SPUtility.HideSPField("Priority Level"); 02/27/2020 - allow ALL admin to edit priority level
                                                                                //SPUtility.HideSPField("Lead Sr. Mgr");			

                                                                                if (isHQSuperAdmin || isGTMAdmin || isDOAdmin) {
                                                                                    //unlockRows(adminRowIndex+4, adminRowIndex+6);
                                                                                    $("input[title='DO Lead']").attr('disabled', false);
                                                                                    $("select[title='DO Project Status']").attr('disabled', false);

                                                                                    SPUtility.GetSPField("DO Project Status").MakeEditable();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {
                                                                                            EnableLead("DO Lead");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');
                                                                                } else {
                                                                                    SPUtility.GetSPField("DO Project Status").MakeReadOnly();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {
                                                                                            DisableLead("DO Lead");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');

                                                                                }
                                                                                showCRMAdmin();
                                                                            }

                                                                            /* No longer needed in Jan 12 2020 release ???*/
                                                                            //if (!isGTMAdmin)
                                                                            console.log("show leads adminrow index hide");
                                                                            hideRows((gtmAdminRowIndex - 1), saveAsDraftRowIndex);

                                                                            unlockRows(adminRowIndex, adminRowIndex + 3);
                                                                            // show Project Submission date, Supporting Documents and Notes	
                                                                            if (isGTMAdmin && isGTM) {
                                                                                console.log("gtm save as draft show");
                                                                                if (isEditForm) {
                                                                                    showRows((gtmAdminRowIndex - 1), saveAsDraftRowIndex);
                                                                                } else {
                                                                                    showRows((gtmAdminRowIndex - 1), saveAsDraftRowIndex);

                                                                                }
                                                                                SPUtility.ShowSPField("GTM Lead");
                                                                                SPUtility.GetSPField("GTM Lead").Label.attr("Hiding", false);

                                                                                SPUtility.GetSPField("GTM Lead").ControlsRow.className = SPUtility.GetSPField("GTM Lead").ControlsRow.className.replace("noShow", "");

                                                                                SPUtility.ShowSPField("GTM Status");
                                                                                SPUtility.GetSPField("GTM Status").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("GTM Status").ControlsRow.className = SPUtility.GetSPField("GTM Status").ControlsRow.className.replace("noShow", "");

                                                                                //SPUtility.ShowSPField("Lead Sr. Mgr");
                                                                            }

                                                                            if (isSalesOps && (isHQSuperAdmin || isSalesOpsAdmin)) {
                                                                                //SPUtility.ShowSPField("Sales Ops Support Type");
                                                                                //SPUtility.ShowSPField("Sales Ops Lead(s)");
                                                                                //SPUtility.ShowSPField("Sales Ops Status");
                                                                                //SPUtility.ShowSPField("Soundbytes"); //- removed 06/16/20 then added back 6/22 then removed 8/13
                                                                                showRows((gtmAdminRowIndex - 1), saveAsDraftRowIndex);
                                                                                // hide some non-applicable fields
                                                                                SPUtility.GetSPField("Mtg: Pri Rvw").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Mtg: Pri Rvew").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Calendar Only").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Calendar Only").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Parent Project ID").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Homescreen Takeover").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Homescreen Takeover").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Mtg: Pri Rvw");
                                                                                //SPUtility.HideSPField("Calendar Only");
                                                                                //SPUtility.HideSPField("Training Launch Date"); - field had been removed
                                                                                //SPUtility.HideSPField("Parent Project ID");
                                                                                //SPUtility.HideSPField("Launch Bundle Images"); field had been removed
                                                                                //SPUtility.HideSPField("Homescreen Takeover");
                                                                                //SPUtility.HideSPField("Entertainment");
                                                                                //SPUtility.HideSPField("5G");
                                                                                //SPUtility.HideSPField("5G City");
                                                                                if (isHQSuperAdmin || isGTMAdmin || isSalesOpsAdmin) {
                                                                                    //$("input[title='Sales Ops Lead(s)']").attr('disabled', false);
                                                                                    //$("select[title='Sales Ops Status']").attr('disabled', false);

                                                                                    //SPUtility.GetSPField("Sales Ops Status").MakeEditable();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {//EnableLead("Sales Ops Lead(s)");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');
                                                                                } else {
                                                                                    //SPUtility.GetSPField("Sales Ops Status").MakeReadOnly();
                                                                                    ExecuteOrDelayUntilScriptLoaded(function() {
                                                                                        setTimeout(function() {//DisableLead("Sales Ops Lead(s)");
                                                                                        }, 100);
                                                                                    }, 'clientpeoplepicker.js');

                                                                                }
                                                                            }
                                                                            // Only open up Image links for HQ Super Admin for now
                                                                            /* no longer need images if (isSalesOps)
	{
		if (isHQSuperAdmin)
		{
			SPUtility.ShowSPField("Image");
			SPUtility.ShowSPField("Launch Bundle Images");
		}
		else
		{
			SPUtility.HideSPField("Image");
			SPUtility.HideSPField("Launch Bundle Images");
		}
		
	}*/
                                                                            // 06/15/21 - turn on 5G for PMO only

                                                                            //if (isPMOAdmin && isPMOOnly)
                                                                            //{
                                                                            //	SPUtility.ShowSPField("5G");
                                                                            //}

                                                                            if (SPUtility.GetSPField("Managing Channel").GetValue() == 'GTM') // no one but HQ Super Admin can update priority level //&& (isCGTMLeads || isIMCLead || isBrandLead || isSalesOpsLead))
                                                                            {
                                                                                if (!isHQSuperAdmin)
                                                                                    SPUtility.GetSPField("Priority Level").MakeReadOnly();
                                                                            }
                                                                            SPUtility.GetSPField("Save as draft?").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Save as draft?").Label.attr("Hiding", true);
                                                                            SPUtility.HideSPField("Save as draft?");
                                                                            // #707 - hide Save as draft after initial submission	
                                                                            //03/08/21 - show gtm lead for UNAPPROVED  promo
                                                                            if (isEditForm && isAdmin && isPromo) {

                                                                                SPUtility.ShowSPField("GTM Lead");
                                                                                SPUtility.GetSPField("GTM Lead").Label.attr("Hiding", false);
                                                                                SPUtility.GetSPField("GTM Lead").ControlsRow.className = SPUtility.GetSPField("GTM Lead").ControlsRow.className.replace("noShow", "");

                                                                            }

                                                                        }

                                                                        function showCRMAdmin() {

                                                                            SPUtility.ShowSPField("Key Points");
                                                                            SPUtility.GetSPField("Key Points").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Key Points").ControlsRow.className = SPUtility.GetSPField("Key Points").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Managing Channel");
                                                                            SPUtility.GetSPField("Managing Channel").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Managing Channel").ControlsRow.className = SPUtility.GetSPField("Managing Channel").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.GetSPField("GTM Status").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("GTM Status").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("GTM Status");
                                                                            SPUtility.ShowSPField("Priority Level");
                                                                            if (!isHQSuperAdmin && !isGTMAdmin && !isIMCAdmin && !isDOAdmin && !isBrandAdmin && !isNBxAdmin) {

                                                                                SPUtility.GetSPField("Key Points").MakeReadOnly();
                                                                                SPUtility.GetSPField("Managing Channel").MakeReadOnly();
                                                                                SPUtility.GetSPField("GTM Status").MakeReadOnly();
                                                                                SPUtility.GetSPField("Priority Level").MakeReadOnly();
                                                                                //SPUtility.GetSPField("Mtg: Pri Rvw").MakeReadOnly();
                                                                            } else {

                                                                                $("input[id^='What_x0020_is_x0020_it']").prop("disabled", "");
                                                                                $("textarea[id^='What_x0020_are_x0020_the_x0020_T']").prop("disabled", "");
                                                                                $("select[id^='isB2B']").prop("disabled", "");
                                                                                $("select[id^='GTM_x0020_Status']").prop("disabled", "");
                                                                                $("select[id^='Priority_x0020_Level']").prop("disabled", "");
                                                                                $("input[id^='Mtg_x003A__x0020_Pri_x0020_Rvw']").prop("disabled", "");
                                                                                $("input[id^='Mtg_x003A__x0020_Mkt']").prop("disabled", "");
                                                                                $("input[id^='GTM_x0020_Deck_x0020_Availabilit']").prop("disabled", "");
                                                                                /*ExecuteOrDelayUntilScriptLoaded(function () {
			setTimeout(function () {
		    	EnableLead("CRM Lead");
			}, 100);
	    }, 'clientpeoplepicker.js');	*/
                                                                            }
                                                                        }

                                                                        function fnSaveLeadValues() {
                                                                            if (SPUtility.GetSPFieldByInternalName('DO_x0020_Lead').GetValue().length > 0)
                                                                                DOLead = SPUtility.GetSPFieldByInternalName('DO_x0020_Lead').GetValue()[0].DisplayText;
                                                                            if (SPUtility.GetSPFieldByInternalName('GTM_x0020_Lead').GetValue().length > 0)
                                                                                GTMLead = SPUtility.GetSPFieldByInternalName('GTM_x0020_Lead').GetValue()[0].DisplayText;
                                                                            //if (SPUtility.GetSPFieldByInternalName('PMO_x0020_Lead_x0028_s_x0029_').GetValue().length > 0)
                                                                            //PMOLead = SPUtility.GetSPFieldByInternalName('PMO_x0020_Lead_x0028_s_x0029_').GetValue()[0].DisplayText;
                                                                            if (SPUtility.GetSPFieldByInternalName('IM_x0020_Lead').GetValue().length > 0)
                                                                                IMLead = SPUtility.GetSPFieldByInternalName('IM_x0020_Lead').GetValue()[0].DisplayText;
                                                                        }

                                                                        function GetLoginUser(userid) {
                                                                            var requestUri = _spPageContextInfo.webAbsoluteUrl + "/_api/web/getuserbyid(" + userid + ")";

                                                                            var requestHeaders = {
                                                                                "accept": "application/json;odata=verbose"
                                                                            };

                                                                            $.ajax({
                                                                                async: false,
                                                                                url: requestUri,
                                                                                contentType: "application/json;odata=verbose",
                                                                                headers: requestHeaders,
                                                                                success: onSuccess1,
                                                                                error: onError1
                                                                            });
                                                                        }

                                                                        function onSuccess1(data, request) {
                                                                            loginName = data.d.Title;
                                                                        }

                                                                        function onError1(error) {
                                                                            alert(error);
                                                                        }

                                                                        /* NO LONGER NEEDED
function fnPopulateAgenda()
{
	if (isHQSuperAdmin)
	{
		SPUtility.GetSPField("Project Name").SetValue("Agenda Topic Only - ");
		SPUtility.GetSPField("Priority Level").SetValue("SU");
		SPUtility.GetSPField("Managing Channel").SetValue("GTM");
		SPUtility.GetSPField("GTM Status").SetValue("Assigned");

		var $checkbox = $("#Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_0");
		$checkbox.click();
		$checkbox = $("#Customer_x0020_Eligibility_95742e26-df9f-4ec0-8b9f-6839a4b8a049_MultiChoiceOption_0");
		$checkbox.click();
		$checkbox = $("#Market_x0020_Availability_b871875c-c1bc-4367-9850-80f496496d90_MultiChoiceOption_0");
		$checkbox.click();
		$checkbox = $("#Customer_x0020_Segment_77af2801-44de-4147-bfef-65b45011adf9_MultiChoiceOption_0");
		$checkbox.click();

		$(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked" ,"checked");
		SPUtility.GetSPField("Save as draft?").SetValue("No");
		
		SPUtility.GetSPField("Pricing").SetValue("N/A");
		var projectSponsor = SPUtility.GetSPField("Project Lead").GetValue();
		if (projectSponsor == "")
		{
			peoplecolumn = "Project Lead Required Field";
			GetCurrentUser(2);
			$("input[id^='Project_x0020_Name']").focus();
		}
		fnHideNonMarketActivity();
		showRows(adminRowIndex-1, saveAsDraftRowIndex);
		SPUtility.HideSPField("GTM");
		SPUtility.HideSPField("Title");
		SPUtility.HideSPField("GTM Last Column");
		
	}	
}*/

                                                                        /*function setupCalendarOnly()
{
	if (!isAdmin)
	{
		SPUtility.HideSPField("Calendar Only");
		return;
	}
	if(SPUtility.GetSPField("Calendar Only").GetValue().length == 0)
	{
		hideRows(adminRowIndex-1, saveAsDraftRowIndex);
		return;
	}
	SPUtility.GetSPField("Managing Channel").SetValue("Consumer");
	SPUtility.GetSPField("GTM Status").SetValue("Assigned");
	SPUtility.GetSPField("Managing Channel").SetValue("Consumer");
	SPUtility.GetSPField("GTM Status").SetValue("Assigned");

	var $checkbox = $("#Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_0");
	$checkbox.click();
	$checkbox = $("#Customer_x0020_Eligibility_95742e26-df9f-4ec0-8b9f-6839a4b8a049_MultiChoiceOption_0");
	$checkbox.click();
	$checkbox = $("#Market_x0020_Availability_b871875c-c1bc-4367-9850-80f496496d90_MultiChoiceOption_0");
	$checkbox.click();
	$checkbox = $("#Customer_x0020_Segment_77af2801-44de-4147-bfef-65b45011adf9_MultiChoiceOption_0");
	$checkbox.click();

	$(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked" ,"checked");
	SPUtility.GetSPField("Save as draft?").SetValue("No");
	SPUtility.GetSPField("Pricing").SetValue("N/A");
	var projectSponsor = SPUtility.GetSPField("Project Lead").GetValue();
	if (projectSponsor == "")
	{
		peoplecolumn = "Project Lead Required Field";
		GetCurrentUser(2);
		$("input[id^='Project_x0020_Name']").focus();
	}
	fnHideNonMarketActivity();
	showRows(adminRowIndex-1, saveAsDraftRowIndex);
	SPUtility.HideSPField("SKU");
	SPUtility.HideSPField("Verizon Exclusive?");
	SPUtility.HideSPField("GTM");
	SPUtility.HideSPField("Title");
	SPUtility.HideSPField("GTM Last Column");
}*/

                                                                        function fnPopulateLaunchType() {
                                                                            if (!isHQSuperAdmin) {
                                                                                $("select[id^='Launch_x0020_Type'] option[value='AGENDA']").remove();
                                                                                if (isNewForm)
                                                                                    hideAdmin();
                                                                            }
                                                                        }
                                                                        function fnPopulateManagingChannel() {
                                                                            var managingChannelId = "isB2B_6c5d4d6a-205a-43ab-9953-3f1f0813bd7b_$DropDownChoice";
                                                                            if (isGTM || isSalesOps) {// do nothing
                                                                            } else {
                                                                                $("select[id^='" + managingChannelId + "']").find('option[value="Jarvis Only"]').remove();
                                                                            }

                                                                            // select existing managing channel
                                                                            $("select[id^='" + managingChannelId + "'] option").each(function() {
                                                                                if ($(this).val() == origManagingChannel) {
                                                                                    $(this).prop("selected", true);
                                                                                }
                                                                            });

                                                                        }
                                                                        function fnPopulateIMFields() {
                                                                            SPUtility.GetSPField("Product or Service Offerings").SetValue('Clearly state the promotional offer along with any legal copy');
                                                                            SPUtility.GetSPField("Marketplace Insights").SetValue('Provide relevant information as to what need this product or service is addressing');
                                                                            SPUtility.GetSPField("Target Consumer").SetValue('Provide Information about the target consumer: General Market, Verizon Persona, demographic & psychographic details, etc.');
                                                                            SPUtility.GetSPField("Barrier").SetValue('What stands in the way? Detail any competetive insight.');
                                                                            SPUtility.GetSPField("Value Proposition").SetValue('Why would consumers select Verizon over competitors?');
                                                                            SPUtility.GetSPField("Mandatories").SetValue('ie. Call to action, logo, disclaimer, imagery, hashtags, etc.');
                                                                            SPUtility.GetSPField("Message Strategy").SetValue("Positioning statement that addresses your audiences most pressing problem accompanied by the benefit youre offering to solve it");
                                                                            // SPUtility.GetSPField("IMC Overview").SetValue("In a narrative, present the product offering or services that are being promoted. Along with top-line information such as the start date, length of campaign, value proposition, primary target audience, core message, campaign tone and expected outcome.\nCampaign History / Past Performance.");
                                                                            SPUtility.GetSPField("IMC Deliverables").SetValue("Describe any pre-campaign deliverables needed, along with their due date. (i.e. MCOW, Tool Kit, Storyboards , Others)");
                                                                            SPUtility.GetSPField("Partner Participation Details").SetValue("Please list out, or attach, any relevant Partner Participation, such as:\npartner sponsorship or cost-sharing details,\n required partner supplied Imagery or logos to be used (link),\nrequired partner brand message inclusion, etc.");
                                                                            //SPUtility.GetSPField("Local Marketing PMO Approval Code").SetValue("Enter (or link) the budget details including Total Requested Budget, Activation Budget, Media Budget, Creative Budget and the full Bill-To String (Market / Account / Product / Location)");
                                                                            SPUtility.GetSPField("Opportunity").SetValue('Communicate the benefit Verizon could have as a result of the new campaign/initiative.');
                                                                            SPUtility.GetSPFieldByInternalName('Product_x002F_Device_x0020_Name_').SetValue('Provide product/device name with the model # and indicate if this is approved naming or a code name.');
                                                                            SPUtility.GetSPField("Portfolio").SetValue('Does this have product/device any related products. If yes, please provide the product portfolio.');
                                                                            SPUtility.GetSPField("User Experience").SetValue('What is the user experience and how the customer will access the offer? Describe the user experience i.e. is this a device, app, feature, software, promo, etc.');
                                                                        }

                                                                        function fnMarketActivity(market) {
                                                                            // prepopulate required fields and hide non Market Activity fields
                                                                            //onload put it checked
                                                                            //$(".ms-RadioText[title='All Channels'] :checkbox").prop("checked" ,"checked");
                                                                            isMarketLaunch = market;
                                                                            if (isNewForm) {
                                                                                var $checkbox = $("#Channel_x0020_Availability_cc45458f-87b4-42d6-b451-116b82ef3ba9_MultiChoiceOption_0");
                                                                                $checkbox.click();
                                                                                $checkbox = $("#Customer_x0020_Eligibility_95742e26-df9f-4ec0-8b9f-6839a4b8a049_MultiChoiceOption_0");
                                                                                $checkbox.click();
                                                                                $(".ms-RadioText[title='Go To Market'] :checkbox").prop("checked", "checked");
                                                                                $(".ms-RadioText[title='Integrated Marketing Communications'] :checkbox").prop("checked", "");
                                                                                $(".ms-RadioText[title='Digital Operations'] :checkbox").prop("checked", "");
                                                                                SPUtility.GetSPField("Is this a dark launch?").SetValue('No');
                                                                                SPUtility.GetSPField("Save as draft?").SetValue('No');
                                                                                console.log("market activity admin row hide");
                                                                                hideRows(adminRowIndex - 1, saveAsDraftRowIndex);
                                                                            }
                                                                            // now hide all unused fields
                                                                            fnHideNonMarketActivity();
                                                                        }
                                                                        function fnHideNonMarketActivity() {
                                                                            SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Is this a dark launch?").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Approving Executive Sponsor").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Approving Executive Sponsor").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Approving Legal Contacts").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Approving Legal Contacts").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Approving Finance Contact").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Approving Finance Contact").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Business Objectives / KPIs").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Business Objective / KPIs").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Is this a dark launch?");
                                                                            //SPUtility.HideSPField("If Project requires IT release (ER or CR) enter date");
                                                                            //SPUtility.HideSPField("Approving Executive Sponsor");
                                                                            //SPUtility.HideSPField("Approving Legal Contacts");
                                                                            //SPUtility.HideSPField("Approving Finance Contact");
                                                                            //SPUtility.HideSPField("Business Objectives / KPIs");
                                                                            hideRows(gtmRowIndex - 1, salesOpsRowIndex);
                                                                            if (isEditForm && isMarketAdmin && !isHQSuperAdmin) {
                                                                                SPUtility.GetSPField("Parent Project ID").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Parent Project ID").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Child Sequence No").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Child Sequence No").Label.attr("Hiding", true);

                                                                                SPUtility.GetSPField("Mtg: Pri Rvw").ControlsRow.className = "noShow";
                                                                                SPUtility.GetSPField("Mtg: Pri Rvew").Label.attr("Hiding", true);

                                                                                //SPUtility.HideSPField("Parent Project ID");
                                                                                //SPUtility.HideSPField("Child Sequence No");
                                                                                //SPUtility.HideSPField("Mtg: Pri Rvw");
                                                                                //if (SPUtility.GetSPField("Managing Channel").GetValue().trim() == "")
                                                                                //SPUtility.GetSPField("Managing Channel").SetValue('GTM');
                                                                                if (SPUtility.GetSPField("GTM Status").GetValue().trim() == "")
                                                                                    SPUtility.GetSPField("GTM Status").SetValue('Assigned');
                                                                                if (isDraft) {
                                                                                    console.log("nonmarket activity hide admin row");
                                                                                    hideRows(adminRowIndex - 1, adminRowIndex);
                                                                                    hideRows(saveAsDraftRowIndex, lastRowIndex + 1);
                                                                                }
                                                                                //if (isNCAdmin)
                                                                                if (isMarketAdmin) {
                                                                                    SPUtility.ShowSPField("Parent Project ID");
                                                                                    SPUtility.GetSPField("Parent Project ID").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Parent Project ID").ControlsRow.className = SPUtility.GetSPField("Parent Project ID").ControlsRow.className.replace("noShow", "");

                                                                                }
                                                                            }
                                                                        }

                                                                        function fnUnHideNonMarketActivity() {
                                                                            SPUtility.ShowSPField("Is this a dark launch?");
                                                                            SPUtility.GetSPField("Is this a dark launch?").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className = SPUtility.GetSPField("Is this a dark launch?").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("If Project requires IT release (ER or CR) enter date");
                                                                            SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").ControlsRow.className = SPUtility.GetSPField("If Project requires IT release (ER or CR) enter date").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Approving Executive Sponsor");
                                                                            SPUtility.GetSPField("Approving Executive Sponsor").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Approving Executive Sponsor").ControlsRow.className = SPUtility.GetSPField("Approving Executive Sponsor").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Approving Legal Contacts");
                                                                            SPUtility.GetSPField("Approving Legal Contacts").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Approving Legal Contacts").ControlsRow.className = SPUtility.GetSPField("Approving Legal Contacts").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Approving Finance Contact");
                                                                            SPUtility.GetSPField("Approving Finance Contact").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Approving Finance Contact").ControlsRow.className = SPUtility.GetSPField("Approving Finance Contact").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Business Objectives / KPIs");
                                                                            SPUtility.GetSPField("Business Objectives / KPIs").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Business Objectives / KPIs").ControlsRow.className = SPUtility.GetSPField("Business Objectives / KPIs").ControlsRow.className.replace("noShow", "");

                                                                            SPUtility.ShowSPField("Pricing");
                                                                            SPUtility.GetSPField("Pricing").Label.attr("Hiding", false);
                                                                            SPUtility.GetSPField("Pricing").ControlsRow.className = SPUtility.GetSPField("Pricing").ControlsRow.className.replace("noShow", "");

                                                                            //SPUtility.ShowSPField("Eligible and Ineligible Price Plans, Payment Options and/or required Agreement types");	
                                                                            SPUtility.ShowSPField("SKU");
                                                                            SPUtility.GetSPField("SKU").Label.attr("Hiding", true);
                                                                            SPUtility.GetSPField("SKU").ControlsRow.className = SPUtility.GetSPField("SKU").ControlsRow.className.replace("noShow", "");

                                                                            if (isGTM) {
                                                                                console.log("gtm sales ops -3 show");
                                                                                if (isEditForm) {
                                                                                    console.log("gtm sales ops -3 show if");
                                                                                    showRows(gtmRowIndex - 1, salesOpsRowIndex - 4);

                                                                                } else {
                                                                                    console.log("gtm sales ops -3 show else");
                                                                                    showRows(gtmRowIndex - 3, salesOpsRowIndex - 4);
                                                                                }
                                                                            }

                                                                            //SPUtility.HideSPField("");
                                                                        }

                                                                        function showNuances() {
                                                                            // 02/23/2021 - add indirect title and key points
                                                                            SPUtility.GetSPField("Indirect Training").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Indirect Training").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Indirect Title").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Indirect Title").Label.attr("Hiding", true);

                                                                            SPUtility.GetSPField("Indirect Key Points").ControlsRow.className = "noShow";
                                                                            SPUtility.GetSPField("Indirect Key Points").Label.attr("Hiding", true);

                                                                            //SPUtility.HideSPField("Indirect Training");
                                                                            //SPUtility.HideSPField("Telesales Nuances");
                                                                            //SPUtility.HideSPField("Indirect Title");
                                                                            //SPUtility.HideSPField("Indirect Key Points");

                                                                            if (isGTM || isSalesOps) {
                                                                                if (isIndirect) {
                                                                                    SPUtility.ShowSPField("Indirect Training");
                                                                                    SPUtility.GetSPField("Indirect Training").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Indirect Training").ControlsRow.className = SPUtility.GetSPField("Indirect Training").ControlsRow.className.replace("noShow", "");

                                                                                    SPUtility.ShowSPField("Indirect Title");
                                                                                    SPUtility.GetSPField("Indirect Title").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Indirect Title").ControlsRow.className = SPUtility.GetSPField("Indirect Title").ControlsRow.className.replace("noShow", "");

                                                                                    SPUtility.ShowSPField("Indirect Key Points");
                                                                                    SPUtility.GetSPField("Indirect Key Points").Label.attr("Hiding", false);
                                                                                    SPUtility.GetSPField("Indirect Key Points").ControlsRow.className = SPUtility.GetSPField("Indirect Key Points").ControlsRow.className.replace("noShow", "");

                                                                                }
                                                                                //if (SPUtility.GetSPField("Channel Availability").GetValue().indexOf('Telesales') > -1 )		
                                                                                //	SPUtility.ShowSPField("Telesales Nuances");
                                                                            }
                                                                        }

                                                                        function isLead(leads) {
                                                                            index = -1;
                                                                            for (var i = 0; i < leads.length; i++) {
                                                                                if (leads[i].DisplayText == loginName) {
                                                                                    index = i;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            return index;
                                                                        }
                                                                    </script>
                                                                    <!--<div id="deliverable" style="top:70px;left:340px;position:fixed;z-index:100;"><a id="deliverables" nohref target="_blank"><img src="https://esites.vzbi.com/sites/HQ_GTM/SiteAssets/Images/deliverables.png" height="42px" style="padding-left:11px"><br>Deliverables</a></div>-->
                                                                    <div id="SubmissionTip" style="display:none">
                                                                        <a href="https://docs.google.com/presentation/d/1wSQHG8BX0MnqAw3Yvm0q1H7RXk_3n394BWqARbhVp5k/" target="_blank">Brief Submission Tips</a>
                                                                    </div>
                                                                    <div id="Error" class="error"></div>
                                                                    <div id="WSOutput1" style="display:none"></div>
                                                                    <head>
                                                                        <title></title>
                                                                        <html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
                                                                        <!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">Fonseca, Daniel</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">Liu, Loan</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:_dlc_DocId msdt:dt="string">N55XCTJCHNCM-2127162964-1599</mso:_dlc_DocId>
<mso:_dlc_DocIdItemGuid msdt:dt="string">1a9d37dd-be34-47ed-91e0-f0daf2c5b526</mso:_dlc_DocIdItemGuid>
<mso:_dlc_DocIdUrl msdt:dt="string">https://onesite.verizon.com/sites/HQ_GTM/_layouts/15/DocIdRedir.aspx?ID=N55XCTJCHNCM-2127162964-1599, N55XCTJCHNCM-2127162964-1599</mso:_dlc_DocIdUrl>
</mso:CustomDocumentProperties>
</xml><![endif]-->
                                                                    </head>
                                                                </div>
                                                                <div class="ms-clear"></div>
                                                            </div>
                                                        </div>
                                                        <div class="ms-PartSpacingVertical"></div>
                                                    </div>
                                                    <div id="MSOZoneCell_WebPartWPQ3" class="s4-wpcell-plain ms-webpartzone-cell ms-webpart-cell-vertical-inline-table ms-webpart-cell-vertical ms-fullWidth ">
                                                        <div class="ms-webpart-chrome ms-webpart-chrome-vertical ms-webpart-chrome-fullWidth ">
                                                            <div WebPartID="d8610390-c5f2-4f55-947a-8a2d8ebf1243" HasPers="false" id="WebPartWPQ3" width="100%" class="noindex " allowDelete="false" style="">
                                                                <table>
                                                                    <tr>
                                                                        <td>
                                                                            <span id='part1'>
                                                                                <div id="listFormToolBarTop">
                                                                                    <table class="ms-formtoolbar" cellpadding="2" cellspacing="0" border="0" id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_toolBarTbltop" width="100%" role="presentation">
                                                                                        <tr>
                                                                                            <td width="99%" class="ms-toolbar" nowrap="nowrap">
                                                                                                <img src="/_layouts/15/images/blank.gif?rev=44" width='1' height='18' alt="" data-accessibility-nocheck="true"/>
                                                                                            </td>
                                                                                            <td class="ms-toolbar" nowrap="nowrap">
                                                                                                <table cellpadding="0" cellspacing="0" width="100%">
                                                                                                    <tr>
                                                                                                        <td align="right" width="100%" nowrap="nowrap">
                                                                                                            <input type="button" name="ctl00$ctl45$g_d8610390_c5f2_4f55_947a_8a2d8ebf1243$ctl00$toolBarTbltop$RightRptControls$ctl01$ctl00$diidIOSaveItem" value="Save" onclick="if (!PreSaveItem()) return false;if (SPClientForms.ClientFormManager.SubmitClientForm(&#39;WPQ3&#39;)) return false;WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;ctl00$ctl45$g_d8610390_c5f2_4f55_947a_8a2d8ebf1243$ctl00$toolBarTbltop$RightRptControls$ctl01$ctl00$diidIOSaveItem&quot;, &quot;&quot;, true, &quot;&quot;, &quot;&quot;, false, true))" id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_toolBarTbltop_RightRptControls_ctl01_ctl00_diidIOSaveItem" accesskey="O" class="ms-ButtonHeightWidth" target="_self"/>
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                </table>
                                                                                            </td>
                                                                                            <td class='ms-separator'>&#160;</td>
                                                                                            <td class="ms-toolbar" nowrap="nowrap">
                                                                                                <table cellpadding="0" cellspacing="0" width="100%">
                                                                                                    <tr>
                                                                                                        <td align="right" width="100%" nowrap="nowrap">
                                                                                                            <input type="button" name="ctl00$ctl45$g_d8610390_c5f2_4f55_947a_8a2d8ebf1243$ctl00$toolBarTbltop$RightRptControls$ctl02$ctl00$diidIOGoBack" value="Cancel" onclick="STSNavigate(&#39;https:\u002f\u002fonesite.verizon.com\u002fsites\u002fHQ_GTM\u002fSitePages\u002fGTM Thank You.aspx&#39;);return false;WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;ctl00$ctl45$g_d8610390_c5f2_4f55_947a_8a2d8ebf1243$ctl00$toolBarTbltop$RightRptControls$ctl02$ctl00$diidIOGoBack&quot;, &quot;&quot;, true, &quot;&quot;, &quot;&quot;, false, true))" id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_toolBarTbltop_RightRptControls_ctl02_ctl00_diidIOGoBack" accesskey="C" class="ms-ButtonHeightWidth" target="_self"/>
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </table>
                                                                                </div>
                                                                                <span style="display:none">
                                                                                    <table class="ms-toolbar" cellpadding="2" cellspacing="0" border="0" id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_FormToolBar4_ctl00_toolBarTbl" width="100%" role="presentation">
                                                                                        <tr>
                                                                                            <td class="ms-toolbar" nowrap="nowrap">
                                                                                                <table cellpadding='1' cellspacing='0'>
                                                                                                    <tr>
                                                                                                        <td class='ms-toolbar' nowrap='nowrap'>
                                                                                                            <img align='absmiddle' alt="Attach File" src="/_layouts/15/images/attachtb.gif" style='border-width:0px;' width='16' height='16'/>
                                                                                                        </td>
                                                                                                        <td class='ms-toolbar' nowrap='nowrap'>
                                                                                                            <a id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_FormToolBar4_ctl00_toolBarTbl_RptControls_diidIOAttach" style="visibility:hidden;" href="javascript:UploadAttachment()" onclick="javascript:UploadAttachment();"></a>
                                                                                                            <a href="javascript:UploadAttachment()" onclick="javascript:UploadAttachment();" accesskey="I" id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_FormToolBar4_ctl00_toolBarTbl_RptControls_diidIOAttach_LinkText" class='ms-toolbar'>Attach File</a>
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                </table>
                                                                                            </td>
                                                                                            <td class="ms-separator">|</td>
                                                                                            <td class="ms-toolbar" nowrap="nowrap">
                                                                                                <table cellpadding='1' cellspacing='0'>
                                                                                                    <tr>
                                                                                                        <td class='ms-toolbar' nowrap='nowrap'>
                                                                                                            <img align='absmiddle' alt="Spelling..." src="/_layouts/1033/images/rte2spchk.gif" style='border-width:0px;' width='16' height='16'/>
                                                                                                        </td>
                                                                                                        <td class='ms-toolbar' nowrap='nowrap'>
                                                                                                            <a id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_FormToolBar4_ctl00_toolBarTbl_RptControls_ctl01" style="visibility:hidden;" href="javascript:SpellCheckEntirePageWithExplicitLanguage(&#39;https:\u002f\u002fonesite.verizon.com\u002fsites\u002fHQ_GTM\u002f_vti_bin\u002fSpellCheck.asmx&#39;, &#39;https:\u002f\u002fonesite.verizon.com\u002fsites\u002fHQ_GTM\u002f_layouts\u002f15\u002fSpellChecker.aspx&#39;, false, 1033);"></a>
                                                                                                            <a href="javascript:SpellCheckEntirePageWithExplicitLanguage(&#39;https:\u002f\u002fonesite.verizon.com\u002fsites\u002fHQ_GTM\u002f_vti_bin\u002fSpellCheck.asmx&#39;, &#39;https:\u002f\u002fonesite.verizon.com\u002fsites\u002fHQ_GTM\u002f_layouts\u002f15\u002fSpellChecker.aspx&#39;, false, 1033);" id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_FormToolBar4_ctl00_toolBarTbl_RptControls_ctl01_LinkText" class='ms-toolbar'>Spelling...</a>
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                </table>
                                                                                            </td>
                                                                                            <td width="99%" class="ms-toolbar" nowrap="nowrap">
                                                                                                <img src="/_layouts/15/images/blank.gif?rev=44" width='1' height='18' alt="" data-accessibility-nocheck="true"/>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </table>
                                                                                </span>
                                                                                <span></span>
                                                                                <table cellpadding="0" cellspacing="0" width="100%" style="padding-top: 7px">
                                                                                    <tr>
                                                                                        <td>
                                                                                            <div id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_PrevNextBar">
                                                                                                <div style="position:relative;height:100%;">
                                                                                                    <div id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_updatePanel"></div>
                                                                                                    <div id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_ctl02" style="display:none;">
                                                                                                        <div id='progressDivupdatePanel' style='position:absolute; left:0px; top:0px; height:100%; width:100%; text-align:center; filter:alpha(opacity=70); BACKGROUND-COLOR: #ffffff;opacity:0.7'>
                                                                                                            <img alt='loading' border='0' style='margin-top:80px' src='/_layouts/15/KWizCom_SLFE/loading.gif'/>
                                                                                                        </div>
                                                                                                        <script>
                                                                                                            function moveToParentTd() {
                                                                                                                try {
                                                                                                                    var progElm = document.getElementById('progressDivupdatePanel');
                                                                                                                    var elm = progElm.parentElement;
                                                                                                                    var parentTd = elm.parentElement;
                                                                                                                    var moved = false;
                                                                                                                    while ((parentTd.tagName != 'DIV' || !parentTd.id.startsWith('WebPartWPQ')) && parentTd.tagName != 'BODY') {
                                                                                                                        parentTd = parentTd.parentElement;
                                                                                                                        moved = true;
                                                                                                                    }

                                                                                                                    if (parentTd != null) {
                                                                                                                        if (moved)
                                                                                                                            parentTd.appendChild(elm);

                                                                                                                        // reposition and resize
                                                                                                                        var jqparentTd = $kw(parentTd);
                                                                                                                        //2010 position
                                                                                                                        progElm.style.top = '0px';
                                                                                                                        progElm.style.left = '0px';

                                                                                                                        progElm.style.height = '100%';
                                                                                                                        //(jqparentTd.height() + 5) + 'px';
                                                                                                                        progElm.style.width = '100%';
                                                                                                                        //(jqparentTd.width() + 5) + 'px';
                                                                                                                    }
                                                                                                                } catch (x) {}
                                                                                                            }

                                                                                                            Sys.Application.add_load(function() {
                                                                                                                moveToParentTd();
                                                                                                            });
                                                                                                            //Change by Mauricio: cascading does partial page refresh.$kw(document).ready(function(){moveToParentTd();});
                                                                                                        </script>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </td>
                                                                                    </tr>
                                                                                </table>
                                                                                <table class="ms-formtable" style="margin-top: 8px;" border="0" cellpadding="0" cellspacing="0" width="100%">
                                                                                    <script>
                                                                                        SLFE_MasterTableCssClass = '';
                                                                                        var SLFE_GroupInfo = {};
                                                                                        var key = SLFE_DecodeTabName("dummy");
                                                                                        SLFE_GroupInfo[key] = {};
                                                                                        SLFE_GroupInfo[key].ElementID = 'kwiztabdummy';
                                                                                        SLFE_GroupInfo[key].Columns = 1;
                                                                                        SLFE_GroupInfo[key].StartCollapsed = false;
                                                                                        SLFE_GroupInfo[key].FieldsOrder = new Array();
                                                                                        SLFE_GroupInfo[key].FieldColspan = {};
                                                                                        SLFE_GroupInfo[key].FieldWidth = {};
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Support_x0020_Team_x0028_s_x0029';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Support_x0020_Team_x0028_s_x0029'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Support_x0020_Team_x0028_s_x0029'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'GENERAL_x0020_INFORMATION';
                                                                                        SLFE_GroupInfo[key].FieldColspan['GENERAL_x0020_INFORMATION'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['GENERAL_x0020_INFORMATION'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Project_x0020_Name';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Project_x0020_Name'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Project_x0020_Name'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Project_x0020_Description';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Project_x0020_Description'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Project_x0020_Description'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Document_x0020_Links';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Document_x0020_Links'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Document_x0020_Links'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Customer_x0020_Primary_x0020_Use';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Customer_x0020_Primary_x0020_Use'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Customer_x0020_Primary_x0020_Use'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Launch_x0020_Type';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Launch_x0020_Type'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Launch_x0020_Type'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Should_x0020_this_x0020_be_x0020';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Should_x0020_this_x0020_be_x0020'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Should_x0020_this_x0020_be_x0020'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Launch_x0020_Date';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Launch_x0020_Date'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Launch_x0020_Date'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Promotional_x0020_Timeframe_x003';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Promotional_x0020_Timeframe_x003'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Promotional_x0020_Timeframe_x003'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'If_x0020_Project_x0020_requires_';
                                                                                        SLFE_GroupInfo[key].FieldColspan['If_x0020_Project_x0020_requires_'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['If_x0020_Project_x0020_requires_'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Market_x0020_Regions';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Market_x0020_Regions'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Market_x0020_Regions'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Market_x0020_Availability';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Market_x0020_Availability'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Market_x0020_Availability'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Local_x0020_Market';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Local_x0020_Market'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Local_x0020_Market'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Customer_x0020_Eligibility';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Customer_x0020_Eligibility'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Customer_x0020_Eligibility'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Eligible_x0020_Customers';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Eligible_x0020_Customers'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Eligible_x0020_Customers'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Channel_x0020_Availability';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Channel_x0020_Availability'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Channel_x0020_Availability'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'National_x0020_Retailers';
                                                                                        SLFE_GroupInfo[key].FieldColspan['National_x0020_Retailers'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['National_x0020_Retailers'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Strategic_x0020_Sales';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Strategic_x0020_Sales'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Strategic_x0020_Sales'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Project_x0020_Leads';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Project_x0020_Leads'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Project_x0020_Leads'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Executive_x0020_Sponsor';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Executive_x0020_Sponsor'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Executive_x0020_Sponsor'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Approving_x0020_Legal_x0020_Cont';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Approving_x0020_Legal_x0020_Cont'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Approving_x0020_Legal_x0020_Cont'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Finance_x0020_Contact';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Finance_x0020_Contact'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Finance_x0020_Contact'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Finance_x0020_Status';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Finance_x0020_Status'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Finance_x0020_Status'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Provide_x0020_the_x0020_business';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Provide_x0020_the_x0020_business'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Provide_x0020_the_x0020_business'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Gross_x0020_Adds_x0020_Forecast';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Gross_x0020_Adds_x0020_Forecast'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Gross_x0020_Adds_x0020_Forecast'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Revenue_x0020_Forecast';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Revenue_x0020_Forecast'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Revenue_x0020_Forecast'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Clarity_x0020_ID';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Clarity_x0020_ID'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Clarity_x0020_ID'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'IT_x0020_or_x0020_CAM_x0020_Cont';
                                                                                        SLFE_GroupInfo[key].FieldColspan['IT_x0020_or_x0020_CAM_x0020_Cont'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['IT_x0020_or_x0020_CAM_x0020_Cont'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'PMO';
                                                                                        SLFE_GroupInfo[key].FieldColspan['PMO'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['PMO'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'INTEGRATED_x0020_MARKETING';
                                                                                        SLFE_GroupInfo[key].FieldColspan['INTEGRATED_x0020_MARKETING'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['INTEGRATED_x0020_MARKETING'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Brand_x0020_Development_x0020_Su';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Brand_x0020_Development_x0020_Su'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Brand_x0020_Development_x0020_Su'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Product_x002F_Device_x0020_Name_';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Product_x002F_Device_x0020_Name_'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Product_x002F_Device_x0020_Name_'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Portfolio';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Portfolio'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Portfolio'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Identify_x0020_Offer_x0020_Categ';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Identify_x0020_Offer_x0020_Categ'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Identify_x0020_Offer_x0020_Categ'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'User_x0020_Experience';
                                                                                        SLFE_GroupInfo[key].FieldColspan['User_x0020_Experience'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['User_x0020_Experience'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Partner';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Partner'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Partner'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Partner_x0020_Participation_x002';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Partner_x0020_Participation_x002'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Partner_x0020_Participation_x002'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Message_x0020_Strategy';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Message_x0020_Strategy'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Message_x0020_Strategy'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Communications_x0020_Objectives';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Communications_x0020_Objectives'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Communications_x0020_Objectives'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Corporate_x0020_Social_x0020_Res';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Corporate_x0020_Social_x0020_Res'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Corporate_x0020_Social_x0020_Res'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'SWOT_x0020_Opportunity';
                                                                                        SLFE_GroupInfo[key].FieldColspan['SWOT_x0020_Opportunity'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['SWOT_x0020_Opportunity'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'SWOT_x0020_Threat';
                                                                                        SLFE_GroupInfo[key].FieldColspan['SWOT_x0020_Threat'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['SWOT_x0020_Threat'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Value_x0020_Proposition';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Value_x0020_Proposition'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Value_x0020_Proposition'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Pre_x002d_Campaign_x0020_Deliver';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Pre_x002d_Campaign_x0020_Deliver'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Pre_x002d_Campaign_x0020_Deliver'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Mandatories';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Mandatories'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Mandatories'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Program_x0020_History_x0020__x00';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Program_x0020_History_x0020__x00'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Program_x0020_History_x0020__x00'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Media_x0020__x0026__x0020_Engage';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Media_x0020__x0026__x0020_Engage'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Media_x0020__x0026__x0020_Engage'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'GTM';
                                                                                        SLFE_GroupInfo[key].FieldColspan['GTM'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['GTM'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Accessory_x0020_Price';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Accessory_x0020_Price'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Accessory_x0020_Price'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Promotion_x0020_Type';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Promotion_x0020_Type'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Promotion_x0020_Type'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Accessory_x0020_Type';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Accessory_x0020_Type'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Accessory_x0020_Type'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Promotion_x0020_OEM';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Promotion_x0020_OEM'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Promotion_x0020_OEM'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Device_x0020_Type';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Device_x0020_Type'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Device_x0020_Type'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'SKU_x0020_Information';
                                                                                        SLFE_GroupInfo[key].FieldColspan['SKU_x0020_Information'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['SKU_x0020_Information'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Plan_x002F_Payment_x0020_Type';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Plan_x002F_Payment_x0020_Type'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Plan_x002F_Payment_x0020_Type'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'SALES_x0020_OPS';
                                                                                        SLFE_GroupInfo[key].FieldColspan['SALES_x0020_OPS'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['SALES_x0020_OPS'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Currently_x0020_Prioritized_x002';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Currently_x0020_Prioritized_x002'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Currently_x0020_Prioritized_x002'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Digital_x0020_operations';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Digital_x0020_operations'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Digital_x0020_operations'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'What_x0020_are_x0020_the_x0020_r';
                                                                                        SLFE_GroupInfo[key].FieldColspan['What_x0020_are_x0020_the_x0020_r'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['What_x0020_are_x0020_the_x0020_r'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'What_x0020_would_x0020_you_x0020';
                                                                                        SLFE_GroupInfo[key].FieldColspan['What_x0020_would_x0020_you_x0020'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['What_x0020_would_x0020_you_x0020'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Impacted_x0020_Digital_x0020_Ops';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Impacted_x0020_Digital_x0020_Ops'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Impacted_x0020_Digital_x0020_Ops'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Traffic_x0020_Volumes';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Traffic_x0020_Volumes'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Traffic_x0020_Volumes'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Digital_x0020_Start_x0020_Date';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Digital_x0020_Start_x0020_Date'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Digital_x0020_Start_x0020_Date'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Digital_x0020_End_x0020_Date';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Digital_x0020_End_x0020_Date'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Digital_x0020_End_x0020_Date'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'ADMIN';
                                                                                        SLFE_GroupInfo[key].FieldColspan['ADMIN'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['ADMIN'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Project_x0020_Submission_x0020_D';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Project_x0020_Submission_x0020_D'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Project_x0020_Submission_x0020_D'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Supporting_x0020_Documents';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Supporting_x0020_Documents'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Supporting_x0020_Documents'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'ConfigNotes';
                                                                                        SLFE_GroupInfo[key].FieldColspan['ConfigNotes'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['ConfigNotes'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Alternate_x0020_Title_x0020__x00';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Alternate_x0020_Title_x0020__x00'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Alternate_x0020_Title_x0020__x00'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'What_x0020_are_x0020_the_x0020_T';
                                                                                        SLFE_GroupInfo[key].FieldColspan['What_x0020_are_x0020_the_x0020_T'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['What_x0020_are_x0020_the_x0020_T'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Indirect_x0020_Title';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Indirect_x0020_Title'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Indirect_x0020_Title'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Indirect_x0020_Key_x0020_Points';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Indirect_x0020_Key_x0020_Points'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Indirect_x0020_Key_x0020_Points'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'isB2B';
                                                                                        SLFE_GroupInfo[key].FieldColspan['isB2B'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['isB2B'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Priority_x0020_Level';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Priority_x0020_Level'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Priority_x0020_Level'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Lead_x0020_Sr_x002e__x0020_Mgr';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Lead_x0020_Sr_x002e__x0020_Mgr'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Lead_x0020_Sr_x002e__x0020_Mgr'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'FWA_x0020_PMO_x0020_Lead_x0028_s';
                                                                                        SLFE_GroupInfo[key].FieldColspan['FWA_x0020_PMO_x0020_Lead_x0028_s'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['FWA_x0020_PMO_x0020_Lead_x0028_s'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Branding_x0020_Brief_x0020_Statu';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Branding_x0020_Brief_x0020_Statu'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Branding_x0020_Brief_x0020_Statu'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Branding_x0020_Leads';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Branding_x0020_Leads'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Branding_x0020_Leads'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'IM_x0020_Project_x0020_Status';
                                                                                        SLFE_GroupInfo[key].FieldColspan['IM_x0020_Project_x0020_Status'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['IM_x0020_Project_x0020_Status'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'IM_x0020_Lead';
                                                                                        SLFE_GroupInfo[key].FieldColspan['IM_x0020_Lead'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['IM_x0020_Lead'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'IMC_x0020_Project_x0020_Status';
                                                                                        SLFE_GroupInfo[key].FieldColspan['IMC_x0020_Project_x0020_Status'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['IMC_x0020_Project_x0020_Status'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Message_x0020_Strategy1';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Message_x0020_Strategy1'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Message_x0020_Strategy1'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Project_x0020_Objective_x0020__x';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Project_x0020_Objective_x0020__x'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Project_x0020_Objective_x0020__x'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'DO_x0020_Project_x0020_Status';
                                                                                        SLFE_GroupInfo[key].FieldColspan['DO_x0020_Project_x0020_Status'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['DO_x0020_Project_x0020_Status'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'DO_x0020_Lead';
                                                                                        SLFE_GroupInfo[key].FieldColspan['DO_x0020_Lead'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['DO_x0020_Lead'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'GTM_x0020_Status';
                                                                                        SLFE_GroupInfo[key].FieldColspan['GTM_x0020_Status'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['GTM_x0020_Status'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'GTM_x0020_Lead';
                                                                                        SLFE_GroupInfo[key].FieldColspan['GTM_x0020_Lead'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['GTM_x0020_Lead'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Mtg_x003A__x0020_Pri_x0020_Rvw_x';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Mtg_x003A__x0020_Pri_x0020_Rvw_x'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Mtg_x003A__x0020_Pri_x0020_Rvw_x'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Calendar_x0020_Only';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Calendar_x0020_Only'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Calendar_x0020_Only'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Parent_x0020_Project_x0020_ID0';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Parent_x0020_Project_x0020_ID0'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Parent_x0020_Project_x0020_ID0'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Child_x0020_Sequence_x0020_No';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Child_x0020_Sequence_x0020_No'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Child_x0020_Sequence_x0020_No'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Training_x0020_Links';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Training_x0020_Links'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Training_x0020_Links'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Indirect_x0020_Nuances';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Indirect_x0020_Nuances'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Indirect_x0020_Nuances'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Homescreen_x0020_Takeover';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Homescreen_x0020_Takeover'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Homescreen_x0020_Takeover'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Campaign_x0020_Module';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Campaign_x0020_Module'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Campaign_x0020_Module'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Plan_x0020_eligibility';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Plan_x0020_eligibility'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Plan_x0020_eligibility'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = '_x0035_G_x0020_Impact';
                                                                                        SLFE_GroupInfo[key].FieldColspan['_x0035_G_x0020_Impact'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['_x0035_G_x0020_Impact'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'For_x0020_the_x0020_Home';
                                                                                        SLFE_GroupInfo[key].FieldColspan['For_x0020_the_x0020_Home'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['For_x0020_the_x0020_Home'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Save_x0020_as_x0020_draft_x003F_';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Save_x0020_as_x0020_draft_x003F_'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Save_x0020_as_x0020_draft_x003F_'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'GTM_x0020_Last_x0020_Column';
                                                                                        SLFE_GroupInfo[key].FieldColspan['GTM_x0020_Last_x0020_Column'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['GTM_x0020_Last_x0020_Column'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Launch_x0020_Date_x0020__x0028_H';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Launch_x0020_Date_x0020__x0028_H'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Launch_x0020_Date_x0020__x0028_H'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Title';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Title'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Title'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'GTM_x0020_Lead_x0020__x0028_Hidd';
                                                                                        SLFE_GroupInfo[key].FieldColspan['GTM_x0020_Lead_x0020__x0028_Hidd'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['GTM_x0020_Lead_x0020__x0028_Hidd'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'GTM_x0020_Status_x0020__x0028_Hi';
                                                                                        SLFE_GroupInfo[key].FieldColspan['GTM_x0020_Status_x0020__x0028_Hi'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['GTM_x0020_Status_x0020__x0028_Hi'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Launch_x0020_Date_x0020_Modified';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Launch_x0020_Date_x0020_Modified'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Launch_x0020_Date_x0020_Modified'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = '_x0035_G_x002f_LTE_x0020_Home_x0';
                                                                                        SLFE_GroupInfo[key].FieldColspan['_x0035_G_x002f_LTE_x0020_Home_x0'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['_x0035_G_x002f_LTE_x0020_Home_x0'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Fios_x0020_Plan_x0020_Eligibilit';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Fios_x0020_Plan_x0020_Eligibilit'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Fios_x0020_Plan_x0020_Eligibilit'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Home';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Home'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Home'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Home_x0020_Position';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Home_x0020_Position'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Home_x0020_Position'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Home_x0020_Start';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Home_x0020_Start'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Home_x0020_Start'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Home_x0020_End';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Home_x0020_End'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Home_x0020_End'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Mobile';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Mobile'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Mobile'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Mobile_x0020_Position';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Mobile_x0020_Position'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Mobile_x0020_Position'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Mobile_x0020_Start';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Mobile_x0020_Start'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Mobile_x0020_Start'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Top_x0020_Mobile_x0020_End';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Top_x0020_Mobile_x0020_End'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Top_x0020_Mobile_x0020_End'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Featured_x0020_Item';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Featured_x0020_Item'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Featured_x0020_Item'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Featured_x0020_Item_x0020_Positi';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Featured_x0020_Item_x0020_Positi'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Featured_x0020_Item_x0020_Positi'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Featured_x0020_Item_x0020_Start';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Featured_x0020_Item_x0020_Start'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Featured_x0020_Item_x0020_Start'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'Featured_x0020_Item_x0020_End';
                                                                                        SLFE_GroupInfo[key].FieldColspan['Featured_x0020_Item_x0020_End'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['Featured_x0020_Item_x0020_End'] = 0;
                                                                                        SLFE_GroupInfo[key].FieldsOrder[SLFE_GroupInfo[key].FieldsOrder.length] = 'PMO_x0020_Brief_x0020_Status';
                                                                                        SLFE_GroupInfo[key].FieldColspan['PMO_x0020_Brief_x0020_Status'] = 1;
                                                                                        SLFE_GroupInfo[key].FieldWidth['PMO_x0020_Brief_x0020_Status'] = 0;
                                                                                    </script>
                                                                                    <tr style='display:none' id='TabsControl'>
                                                                                        <td style='padding-top: 6px;' colspan=2>
                                                                                            <script>
                                                                                                var SLFE_TabHideEmpty = true;
                                                                                            </script>
                                                                                            <UL class=ms-cui-tts unselectable='on' style='height:45px;overflow:hidden'>
                                                                                                <LI class='ms-cui-cg ms-cui-cg-db ms-cui-cg-s' style='height:25px'>
                                                                                                    <ul class='ms-cui-ct-ul' style='height: 30px; overflow: hidden;'></ul>
                                                                                                </LI>
                                                                                            </UL>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr style="display:none;">
                                                                                        <td>
                                                                                            <div style="position:absolute;width:100%;">
                                                                                                <span id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_ListFieldIterator2_updatePanelIterator">
                                                                                                    <input type="hidden" name="ctl00$ctl45$g_d8610390_c5f2_4f55_947a_8a2d8ebf1243$ctl00$ListFieldIterator2$RequestResultTabsInfoHidden" id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_ListFieldIterator2_RequestResultTabsInfoHidden" value="currenttab=dummy&amp;dummy=Support_x0020_Team_x0028_s_x0029~Show|GENERAL_x0020_INFORMATION~Show|Project_x0020_Name~Show|Project_x0020_Description~Show|Document_x0020_Links~Show|Customer_x0020_Primary_x0020_Use~Show|Launch_x0020_Type~Show|Should_x0020_this_x0020_be_x0020~Show|Launch_x0020_Date~Show|Promotional_x0020_Timeframe_x003~Show|If_x0020_Project_x0020_requires_~Show|Market_x0020_Regions~Show|Market_x0020_Availability~Show|Local_x0020_Market~Show|Customer_x0020_Eligibility~Show|Eligible_x0020_Customers~Show|Channel_x0020_Availability~Show|National_x0020_Retailers~Show|Strategic_x0020_Sales~Show|Project_x0020_Leads~Show|Executive_x0020_Sponsor~Show|Approving_x0020_Legal_x0020_Cont~Show|Finance_x0020_Contact~Show|Finance_x0020_Status~Show|Provide_x0020_the_x0020_business~Show|Gross_x0020_Adds_x0020_Forecast~Show|Revenue_x0020_Forecast~Show|Clarity_x0020_ID~Show|IT_x0020_or_x0020_CAM_x0020_Cont~Show|PMO~Show|INTEGRATED_x0020_MARKETING~Show|Brand_x0020_Development_x0020_Su~Show|Product_x002F_Device_x0020_Name_~Show|Portfolio~Show|Identify_x0020_Offer_x0020_Categ~Show|User_x0020_Experience~Show|Partner~Show|Partner_x0020_Participation_x002~Show|Message_x0020_Strategy~Show|Communications_x0020_Objectives~Show|Corporate_x0020_Social_x0020_Res~Show|SWOT_x0020_Opportunity~Show|SWOT_x0020_Threat~Show|Value_x0020_Proposition~Show|Pre_x002d_Campaign_x0020_Deliver~Show|Mandatories~Show|Program_x0020_History_x0020__x00~Show|Media_x0020__x0026__x0020_Engage~Show|GTM~Show|Accessory_x0020_Price~Show|Promotion_x0020_Type~Show|Accessory_x0020_Type~Show|Promotion_x0020_OEM~Show|Device_x0020_Type~Show|SKU_x0020_Information~Show|Plan_x002F_Payment_x0020_Type~Show|SALES_x0020_OPS~Show|Currently_x0020_Prioritized_x002~Show|Digital_x0020_operations~Show|What_x0020_are_x0020_the_x0020_r~Show|What_x0020_would_x0020_you_x0020~Show|Impacted_x0020_Digital_x0020_Ops~Show|Traffic_x0020_Volumes~Show|Digital_x0020_Start_x0020_Date~Show|Digital_x0020_End_x0020_Date~Show|ADMIN~Show|Project_x0020_Submission_x0020_D~Show|Supporting_x0020_Documents~Show|ConfigNotes~Show|Alternate_x0020_Title_x0020__x00~Show|What_x0020_are_x0020_the_x0020_T~Show|Indirect_x0020_Title~Show|Indirect_x0020_Key_x0020_Points~Show|isB2B~Show|Priority_x0020_Level~Show|Lead_x0020_Sr_x002e__x0020_Mgr~Show|FWA_x0020_PMO_x0020_Lead_x0028_s~Show|Branding_x0020_Brief_x0020_Statu~Show|Branding_x0020_Leads~Show|IM_x0020_Project_x0020_Status~Show|IM_x0020_Lead~Show|IMC_x0020_Project_x0020_Status~Show|Message_x0020_Strategy1~Show|Project_x0020_Objective_x0020__x~Show|DO_x0020_Project_x0020_Status~Show|DO_x0020_Lead~Show|GTM_x0020_Status~Show|GTM_x0020_Lead~Show|Mtg_x003A__x0020_Pri_x0020_Rvw_x~Show|Calendar_x0020_Only~Show|Parent_x0020_Project_x0020_ID0~Show|Child_x0020_Sequence_x0020_No~Show|Training_x0020_Links~Show|Indirect_x0020_Nuances~Show|Homescreen_x0020_Takeover~Show|Campaign_x0020_Module~Show|Plan_x0020_eligibility~Show|_x0035_G_x0020_Impact~Show|For_x0020_the_x0020_Home~Show|Save_x0020_as_x0020_draft_x003F_~Show|GTM_x0020_Last_x0020_Column~Show|Launch_x0020_Date_x0020__x0028_H~Show|Title~Show|GTM_x0020_Lead_x0020__x0028_Hidd~Show|GTM_x0020_Status_x0020__x0028_Hi~Show|Launch_x0020_Date_x0020_Modified~Show|_x0035_G_x002f_LTE_x0020_Home_x0~Show|Fios_x0020_Plan_x0020_Eligibilit~Show|Top_x0020_Home~Show|Top_x0020_Home_x0020_Position~Show|Top_x0020_Home_x0020_Start~Show|Top_x0020_Home_x0020_End~Show|Top_x0020_Mobile~Show|Top_x0020_Mobile_x0020_Position~Show|Top_x0020_Mobile_x0020_Start~Show|Top_x0020_Mobile_x0020_End~Show|Featured_x0020_Item~Show|Featured_x0020_Item_x0020_Positi~Show|Featured_x0020_Item_x0020_Start~Show|Featured_x0020_Item_x0020_End~Show|PMO_x0020_Brief_x0020_Status~Show|&amp;visiblefields=Support_x0020_Team_x0028_s_x0029~Show|GENERAL_x0020_INFORMATION~Show|Project_x0020_Name~Show|Project_x0020_Description~Show|Document_x0020_Links~Show|Customer_x0020_Primary_x0020_Use~Show|Launch_x0020_Type~Show|Should_x0020_this_x0020_be_x0020~Show|Launch_x0020_Date~Show|Promotional_x0020_Timeframe_x003~Show|If_x0020_Project_x0020_requires_~Show|Market_x0020_Regions~Show|Market_x0020_Availability~Show|Local_x0020_Market~Show|Customer_x0020_Eligibility~Show|Eligible_x0020_Customers~Show|Channel_x0020_Availability~Show|National_x0020_Retailers~Show|Strategic_x0020_Sales~Show|Project_x0020_Leads~Show|Executive_x0020_Sponsor~Show|Approving_x0020_Legal_x0020_Cont~Show|Finance_x0020_Contact~Show|Finance_x0020_Status~Show|Provide_x0020_the_x0020_business~Show|Gross_x0020_Adds_x0020_Forecast~Show|Revenue_x0020_Forecast~Show|Clarity_x0020_ID~Show|IT_x0020_or_x0020_CAM_x0020_Cont~Show|PMO~Show|INTEGRATED_x0020_MARKETING~Show|Brand_x0020_Development_x0020_Su~Show|Product_x002F_Device_x0020_Name_~Show|Portfolio~Show|Identify_x0020_Offer_x0020_Categ~Show|User_x0020_Experience~Show|Partner~Show|Partner_x0020_Participation_x002~Show|Message_x0020_Strategy~Show|Communications_x0020_Objectives~Show|Corporate_x0020_Social_x0020_Res~Show|SWOT_x0020_Opportunity~Show|SWOT_x0020_Threat~Show|Value_x0020_Proposition~Show|Pre_x002d_Campaign_x0020_Deliver~Show|Mandatories~Show|Program_x0020_History_x0020__x00~Show|Media_x0020__x0026__x0020_Engage~Show|GTM~Show|Accessory_x0020_Price~Show|Promotion_x0020_Type~Show|Accessory_x0020_Type~Show|Promotion_x0020_OEM~Show|Device_x0020_Type~Show|SKU_x0020_Information~Show|Plan_x002F_Payment_x0020_Type~Show|SALES_x0020_OPS~Show|Currently_x0020_Prioritized_x002~Show|Digital_x0020_operations~Show|What_x0020_are_x0020_the_x0020_r~Show|What_x0020_would_x0020_you_x0020~Show|Impacted_x0020_Digital_x0020_Ops~Show|Traffic_x0020_Volumes~Show|Digital_x0020_Start_x0020_Date~Show|Digital_x0020_End_x0020_Date~Show|ADMIN~Show|Project_x0020_Submission_x0020_D~Show|Supporting_x0020_Documents~Show|ConfigNotes~Show|Alternate_x0020_Title_x0020__x00~Show|What_x0020_are_x0020_the_x0020_T~Show|Indirect_x0020_Title~Show|Indirect_x0020_Key_x0020_Points~Show|isB2B~Show|Priority_x0020_Level~Show|Lead_x0020_Sr_x002e__x0020_Mgr~Show|FWA_x0020_PMO_x0020_Lead_x0028_s~Show|Branding_x0020_Brief_x0020_Statu~Show|Branding_x0020_Leads~Show|IM_x0020_Project_x0020_Status~Show|IM_x0020_Lead~Show|IMC_x0020_Project_x0020_Status~Show|Message_x0020_Strategy1~Show|Project_x0020_Objective_x0020__x~Show|DO_x0020_Project_x0020_Status~Show|DO_x0020_Lead~Show|GTM_x0020_Status~Show|GTM_x0020_Lead~Show|Mtg_x003A__x0020_Pri_x0020_Rvw_x~Show|Calendar_x0020_Only~Show|Parent_x0020_Project_x0020_ID0~Show|Child_x0020_Sequence_x0020_No~Show|Training_x0020_Links~Show|Indirect_x0020_Nuances~Show|Homescreen_x0020_Takeover~Show|Campaign_x0020_Module~Show|Plan_x0020_eligibility~Show|_x0035_G_x0020_Impact~Show|For_x0020_the_x0020_Home~Show|Save_x0020_as_x0020_draft_x003F_~Show|GTM_x0020_Last_x0020_Column~Show|Launch_x0020_Date_x0020__x0028_H~Show|Title~Show|GTM_x0020_Lead_x0020__x0028_Hidd~Show|GTM_x0020_Status_x0020__x0028_Hi~Show|Launch_x0020_Date_x0020_Modified~Show|_x0035_G_x002f_LTE_x0020_Home_x0~Show|Fios_x0020_Plan_x0020_Eligibilit~Show|Top_x0020_Home~Show|Top_x0020_Home_x0020_Position~Show|Top_x0020_Home_x0020_Start~Show|Top_x0020_Home_x0020_End~Show|Top_x0020_Mobile~Show|Top_x0020_Mobile_x0020_Position~Show|Top_x0020_Mobile_x0020_Start~Show|Top_x0020_Mobile_x0020_End~Show|Featured_x0020_Item~Show|Featured_x0020_Item_x0020_Positi~Show|Featured_x0020_Item_x0020_Start~Show|Featured_x0020_Item_x0020_End~Show|PMO_x0020_Brief_x0020_Status~Show|"/>
                                                                                                </span>
                                                                                                <div id="ctl00_ctl45_g_d8610390_c5f2_4f55_947a_8a2d8ebf1243_ctl00_ListFieldIterator2_ctl03" style="display:none;">
                                                                                                    <div id='progressDivupdatePanelIterator' style='position:absolute; left:0px; top:0px; height:100%; width:100%; text-align:center; filter:alpha(opacity=70); BACKGROUND-COLOR: #ffffff;opacity:0.7'>
                                                                                                        <img alt='loading' border='0' style='margin-top:80px' src='/_layouts/15/KWizCom_SLFE/loading.gif'/>
                                                                                                    </div>
                                                                                                    <script>
                                                                                                        function moveToParentTd() {
                                                                                                            try {
                                                                                                                var progElm = document.getElementById('progressDivupdatePanelIterator');
                                                                                                                var elm = progElm.parentElement;
                                                                                                                var parentTd = elm.parentElement;
                                                                                                                var moved = false;
                                                                                                                while ((parentTd.tagName != 'DIV' || !parentTd.id.startsWith('WebPartWPQ')) && parentTd.tagName != 'BODY') {
                                                                                                                    parentTd = parentTd.parentElement;
                                                                                                                    moved = true;
                                                                                                                }

                                                                                                                if (parentTd != null) {
                                                                                                                    if (moved)
                                                                                                                        parentTd.appendChild(elm);

                                                                                                                    // reposition and resize
                                                                                                                    var jqparentTd = $kw(parentTd);
                                                                                                                    //2010 position
                                                                                                                    progElm.style.top = '0px';
                                                                                                                    progElm.style.left = '0px';

                                                                                                                    progElm.style.height = '100%';
                                                                                                                    //(jqparentTd.height() + 5) + 'px';
                                                                                                                    progElm.style.width = '100%';
                                                                                                                    //(jqparentTd.width() + 5) + 'px';
                                                                                                                }
                                                                                                            } catch (x) {}
                                                                                                        }

                                                                                                        Sys.Application.add_load(function() {
                                                                                                            moveToParentTd();
                                                                                                        });
                                                                                                        //Change by Mauricio: cascading does partial page refresh.$kw(document).ready(function(){moveToParentTd();});
                                                                                                    </script>
